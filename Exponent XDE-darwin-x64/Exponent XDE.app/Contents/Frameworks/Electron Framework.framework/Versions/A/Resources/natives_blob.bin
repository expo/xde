debug:™
"use strict";
var kDefaultBacktraceLength=10;
var Debug={};
var sourceLineBeginningSkip=/^(?:\s*(?:\/\*.*?\*\/)*)*/;
Debug.DebugEvent={Break:1,
Exception:2,
NewFunction:3,
BeforeCompile:4,
AfterCompile:5,
CompileError:6,
PromiseEvent:7,
AsyncTaskEvent:8};
Debug.ExceptionBreak={Caught:0,
Uncaught:1};
Debug.StepAction={StepOut:0,
StepNext:1,
StepIn:2,
StepMin:3,
StepInMin:4,
StepFrame:5};
Debug.ScriptType={Native:0,
Extension:1,
Normal:2};
Debug.ScriptCompilationType={Host:0,
Eval:1,
JSON:2};
Debug.ScriptBreakPointType={ScriptId:0,
ScriptName:1,
ScriptRegExp:2};
Debug.BreakPositionAlignment={
Statement:0,
BreakPosition:1
};
function ScriptTypeFlag(a){
return(1<<a);
}
var next_response_seq=0;
var next_break_point_number=1;
var break_points=[];
var script_break_points=[];
var debugger_flags={
breakPointsActive:{
value:true,
getValue:function(){return this.value;},
setValue:function(a){
this.value=!!a;
%SetDisableBreak(!this.value);
}
},
breakOnCaughtException:{
getValue:function(){return Debug.isBreakOnException();},
setValue:function(a){
if(a){
Debug.setBreakOnException();
}else{
Debug.clearBreakOnException();
}
}
},
breakOnUncaughtException:{
getValue:function(){return Debug.isBreakOnUncaughtException();},
setValue:function(a){
if(a){
Debug.setBreakOnUncaughtException();
}else{
Debug.clearBreakOnUncaughtException();
}
}
},
};
function MakeBreakPoint(a,b){
var c=new BreakPoint(a,b);
break_points.push(c);
return c;
}
function BreakPoint(a,b){
this.source_position_=a;
if(b){
this.script_break_point_=b;
}else{
this.number_=next_break_point_number++;
}
this.hit_count_=0;
this.active_=true;
this.condition_=null;
this.ignoreCount_=0;
}
BreakPoint.prototype.number=function(){
return this.number_;
};
BreakPoint.prototype.func=function(){
return this.func_;
};
BreakPoint.prototype.source_position=function(){
return this.source_position_;
};
BreakPoint.prototype.hit_count=function(){
return this.hit_count_;
};
BreakPoint.prototype.active=function(){
if(this.script_break_point()){
return this.script_break_point().active();
}
return this.active_;
};
BreakPoint.prototype.condition=function(){
if(this.script_break_point()&&this.script_break_point().condition()){
return this.script_break_point().condition();
}
return this.condition_;
};
BreakPoint.prototype.ignoreCount=function(){
return this.ignoreCount_;
};
BreakPoint.prototype.script_break_point=function(){
return this.script_break_point_;
};
BreakPoint.prototype.enable=function(){
this.active_=true;
};
BreakPoint.prototype.disable=function(){
this.active_=false;
};
BreakPoint.prototype.setCondition=function(a){
this.condition_=a;
};
BreakPoint.prototype.setIgnoreCount=function(a){
this.ignoreCount_=a;
};
BreakPoint.prototype.isTriggered=function(a){
if(!this.active())return false;
if(this.condition()){
try{
var b=a.frame(0).evaluate(this.condition());
if(!(b instanceof ValueMirror)||
!builtins.$toBoolean(b.value_)){
return false;
}
}catch(e){
return false;
}
}
this.hit_count_++;
if(this.script_break_point_){
this.script_break_point_.hit_count_++;
}
if(this.ignoreCount_>0){
this.ignoreCount_--;
return false;
}
return true;
};
function IsBreakPointTriggered(a,b){
return b.isTriggered(MakeExecutionState(a));
}
function ScriptBreakPoint(type,script_id_or_name,opt_line,opt_column,
opt_groupId,opt_position_alignment){
this.type_=type;
if(type==Debug.ScriptBreakPointType.ScriptId){
this.script_id_=script_id_or_name;
}else if(type==Debug.ScriptBreakPointType.ScriptName){
this.script_name_=script_id_or_name;
}else if(type==Debug.ScriptBreakPointType.ScriptRegExp){
this.script_regexp_object_=new RegExp(script_id_or_name);
}else{
throw new Error("Unexpected breakpoint type "+type);
}
this.line_=opt_line||0;
this.column_=opt_column;
this.groupId_=opt_groupId;
this.position_alignment_=(opt_position_alignment===(void 0))
?Debug.BreakPositionAlignment.Statement:opt_position_alignment;
this.hit_count_=0;
this.active_=true;
this.condition_=null;
this.ignoreCount_=0;
this.break_points_=[];
}
ScriptBreakPoint.prototype.cloneForOtherScript=function(a){
var b=new ScriptBreakPoint(Debug.ScriptBreakPointType.ScriptId,
a.id,this.line_,this.column_,this.groupId_,
this.position_alignment_);
b.number_=next_break_point_number++;
script_break_points.push(b);
b.hit_count_=this.hit_count_;
b.active_=this.active_;
b.condition_=this.condition_;
b.ignoreCount_=this.ignoreCount_;
return b;
};
ScriptBreakPoint.prototype.number=function(){
return this.number_;
};
ScriptBreakPoint.prototype.groupId=function(){
return this.groupId_;
};
ScriptBreakPoint.prototype.type=function(){
return this.type_;
};
ScriptBreakPoint.prototype.script_id=function(){
return this.script_id_;
};
ScriptBreakPoint.prototype.script_name=function(){
return this.script_name_;
};
ScriptBreakPoint.prototype.script_regexp_object=function(){
return this.script_regexp_object_;
};
ScriptBreakPoint.prototype.line=function(){
return this.line_;
};
ScriptBreakPoint.prototype.column=function(){
return this.column_;
};
ScriptBreakPoint.prototype.actual_locations=function(){
var a=[];
for(var b=0;b<this.break_points_.length;b++){
a.push(this.break_points_[b].actual_location);
}
return a;
};
ScriptBreakPoint.prototype.update_positions=function(a,b){
this.line_=a;
this.column_=b;
};
ScriptBreakPoint.prototype.hit_count=function(){
return this.hit_count_;
};
ScriptBreakPoint.prototype.active=function(){
return this.active_;
};
ScriptBreakPoint.prototype.condition=function(){
return this.condition_;
};
ScriptBreakPoint.prototype.ignoreCount=function(){
return this.ignoreCount_;
};
ScriptBreakPoint.prototype.enable=function(){
this.active_=true;
};
ScriptBreakPoint.prototype.disable=function(){
this.active_=false;
};
ScriptBreakPoint.prototype.setCondition=function(a){
this.condition_=a;
};
ScriptBreakPoint.prototype.setIgnoreCount=function(a){
this.ignoreCount_=a;
for(var b=0;b<this.break_points_.length;b++){
this.break_points_[b].setIgnoreCount(a);
}
};
ScriptBreakPoint.prototype.matchesScript=function(a){
if(this.type_==Debug.ScriptBreakPointType.ScriptId){
return this.script_id_==a.id;
}else{
if(!(a.line_offset<=this.line_&&
this.line_<a.line_offset+a.lineCount())){
return false;
}
if(this.type_==Debug.ScriptBreakPointType.ScriptName){
return this.script_name_==a.nameOrSourceURL();
}else if(this.type_==Debug.ScriptBreakPointType.ScriptRegExp){
return this.script_regexp_object_.test(a.nameOrSourceURL());
}else{
throw new Error("Unexpected breakpoint type "+this.type_);
}
}
};
ScriptBreakPoint.prototype.set=function(a){
var b=this.column();
var c=this.line();
if((b===(void 0))){
var d=a.sourceLine(this.line());
if(!a.sourceColumnStart_){
a.sourceColumnStart_=new Array(a.lineCount());
}
if((a.sourceColumnStart_[c]===(void 0))){
a.sourceColumnStart_[c]=
d.match(sourceLineBeginningSkip)[0].length;
}
b=a.sourceColumnStart_[c];
}
var e=Debug.findScriptSourcePosition(a,this.line(),b);
if((e===null))return;
var f=MakeBreakPoint(e,this);
f.setIgnoreCount(this.ignoreCount());
var g=%SetScriptBreakPoint(a,e,
this.position_alignment_,
f);
if((g===(void 0))){
g=e;
}
var h=a.locationFromPosition(g,true);
f.actual_location={line:h.line,
column:h.column,
script_id:a.id};
this.break_points_.push(f);
return f;
};
ScriptBreakPoint.prototype.clear=function(){
var a=[];
for(var b=0;b<break_points.length;b++){
if(break_points[b].script_break_point()&&
break_points[b].script_break_point()===this){
%ClearBreakPoint(break_points[b]);
}else{
a.push(break_points[b]);
}
}
break_points=a;
this.break_points_=[];
};
function UpdateScriptBreakPoints(a){
for(var b=0;b<script_break_points.length;b++){
var c=script_break_points[b];
if((c.type()==Debug.ScriptBreakPointType.ScriptName||
c.type()==Debug.ScriptBreakPointType.ScriptRegExp)&&
c.matchesScript(a)){
c.set(a);
}
}
}
function GetScriptBreakPoints(a){
var b=[];
for(var c=0;c<script_break_points.length;c++){
if(script_break_points[c].matchesScript(a)){
b.push(script_break_points[c]);
}
}
return b;
}
Debug.setListener=function(a,b){
if(!(%_IsFunction(a))&&!(a===(void 0))&&!(a===null)){
throw new Error('Parameters have wrong types.');
}
%SetDebugEventListener(a,b);
};
Debug.breakLocations=function(a,b){
if(!(%_IsFunction(a)))throw new Error('Parameters have wrong types.');
var c=(b===(void 0))
?Debug.BreakPositionAlignment.Statement:b;
return %GetBreakLocations(a,c);
};
Debug.findScript=function(a){
if((%_IsFunction(a))){
return %FunctionGetScript(a);
}else if((%_IsRegExp(a))){
var b=Debug.scripts();
var c=null;
var d=0;
for(var e in b){
var g=b[e];
if(a.test(g.name)){
c=g;
d++;
}
}
if(d==1){
return c;
}else{
return undefined;
}
}else{
return %GetScript(a);
}
};
Debug.scriptSource=function(a){
return this.findScript(a).source;
};
Debug.source=function(a){
if(!(%_IsFunction(a)))throw new Error('Parameters have wrong types.');
return %FunctionGetSourceCode(a);
};
Debug.sourcePosition=function(a){
if(!(%_IsFunction(a)))throw new Error('Parameters have wrong types.');
return %FunctionGetScriptSourcePosition(a);
};
Debug.findFunctionSourceLocation=function(a,b,c){
var d=%FunctionGetScript(a);
var e=%FunctionGetScriptSourcePosition(a);
return d.locationFromLine(b,c,e);
};
Debug.findScriptSourcePosition=function(a,b,c){
var d=a.locationFromLine(b,c);
return d?d.position:null;
};
Debug.findBreakPoint=function(a,b){
var c;
for(var d=0;d<break_points.length;d++){
if(break_points[d].number()==a){
c=break_points[d];
if(b){
break_points.splice(d,1);
}
break;
}
}
if(c){
return c;
}else{
return this.findScriptBreakPoint(a,b);
}
};
Debug.findBreakPointActualLocations=function(a){
for(var b=0;b<script_break_points.length;b++){
if(script_break_points[b].number()==a){
return script_break_points[b].actual_locations();
}
}
for(var b=0;b<break_points.length;b++){
if(break_points[b].number()==a){
return[break_points[b].actual_location];
}
}
return[];
};
Debug.setBreakPoint=function(a,b,c,d){
if(!(%_IsFunction(a)))throw new Error('Parameters have wrong types.');
if(%FunctionIsAPIFunction(a)){
throw new Error('Cannot set break point in native code.');
}
var e=
this.findFunctionSourceLocation(a,b,c).position;
var g=e-this.sourcePosition(a);
var h=%FunctionGetScript(a);
if(h.type==Debug.ScriptType.Native){
throw new Error('Cannot set break point in native code.');
}
if(h&&h.id){
g+=%FunctionGetScriptSourcePosition(a);
var i=h.locationFromPosition(g,false);
return this.setScriptBreakPointById(h.id,
i.line,i.column,
d);
}else{
var j=MakeBreakPoint(g);
var k=
%SetFunctionBreakPoint(a,g,j);
k+=this.sourcePosition(a);
var l=h.locationFromPosition(k,true);
j.actual_location={line:l.line,
column:l.column,
script_id:h.id};
j.setCondition(d);
return j.number();
}
};
Debug.setBreakPointByScriptIdAndPosition=function(script_id,position,
condition,enabled,
opt_position_alignment)
{
var a=MakeBreakPoint(position);
a.setCondition(condition);
if(!enabled){
a.disable();
}
var b=this.scripts();
var c=(opt_position_alignment===(void 0))
?Debug.BreakPositionAlignment.Statement:opt_position_alignment;
for(var d=0;d<b.length;d++){
if(script_id==b[d].id){
a.actual_position=%SetScriptBreakPoint(b[d],position,
c,a);
break;
}
}
return a;
};
Debug.enableBreakPoint=function(a){
var b=this.findBreakPoint(a,false);
if(b){
b.enable();
}
};
Debug.disableBreakPoint=function(a){
var b=this.findBreakPoint(a,false);
if(b){
b.disable();
}
};
Debug.changeBreakPointCondition=function(a,b){
var c=this.findBreakPoint(a,false);
c.setCondition(b);
};
Debug.changeBreakPointIgnoreCount=function(a,b){
if(b<0){
throw new Error('Invalid argument');
}
var c=this.findBreakPoint(a,false);
c.setIgnoreCount(b);
};
Debug.clearBreakPoint=function(a){
var b=this.findBreakPoint(a,true);
if(b){
return %ClearBreakPoint(b);
}else{
b=this.findScriptBreakPoint(a,true);
if(!b){
throw new Error('Invalid breakpoint');
}
}
};
Debug.clearAllBreakPoints=function(){
for(var a=0;a<break_points.length;a++){
var b=break_points[a];
%ClearBreakPoint(b);
}
break_points=[];
};
Debug.disableAllBreakPoints=function(){
for(var a=1;a<next_break_point_number;a++){
Debug.disableBreakPoint(a);
}
%ChangeBreakOnException(Debug.ExceptionBreak.Caught,false);
%ChangeBreakOnException(Debug.ExceptionBreak.Uncaught,false);
};
Debug.findScriptBreakPoint=function(a,b){
var c;
for(var d=0;d<script_break_points.length;d++){
if(script_break_points[d].number()==a){
c=script_break_points[d];
if(b){
c.clear();
script_break_points.splice(d,1);
}
break;
}
}
return c;
};
Debug.setScriptBreakPoint=function(type,script_id_or_name,
opt_line,opt_column,opt_condition,
opt_groupId,opt_position_alignment){
var a=
new ScriptBreakPoint(type,script_id_or_name,opt_line,opt_column,
opt_groupId,opt_position_alignment);
a.number_=next_break_point_number++;
a.setCondition(opt_condition);
script_break_points.push(a);
var b=this.scripts();
for(var c=0;c<b.length;c++){
if(a.matchesScript(b[c])){
a.set(b[c]);
}
}
return a.number();
};
Debug.setScriptBreakPointById=function(script_id,
opt_line,opt_column,
opt_condition,opt_groupId,
opt_position_alignment){
return this.setScriptBreakPoint(Debug.ScriptBreakPointType.ScriptId,
script_id,opt_line,opt_column,
opt_condition,opt_groupId,
opt_position_alignment);
};
Debug.setScriptBreakPointByName=function(script_name,
opt_line,opt_column,
opt_condition,opt_groupId){
return this.setScriptBreakPoint(Debug.ScriptBreakPointType.ScriptName,
script_name,opt_line,opt_column,
opt_condition,opt_groupId);
};
Debug.setScriptBreakPointByRegExp=function(script_regexp,
opt_line,opt_column,
opt_condition,opt_groupId){
return this.setScriptBreakPoint(Debug.ScriptBreakPointType.ScriptRegExp,
script_regexp,opt_line,opt_column,
opt_condition,opt_groupId);
};
Debug.enableScriptBreakPoint=function(a){
var b=this.findScriptBreakPoint(a,false);
b.enable();
};
Debug.disableScriptBreakPoint=function(a){
var b=this.findScriptBreakPoint(a,false);
b.disable();
};
Debug.changeScriptBreakPointCondition=function(
break_point_number,condition){
var a=this.findScriptBreakPoint(break_point_number,false);
a.setCondition(condition);
};
Debug.changeScriptBreakPointIgnoreCount=function(
break_point_number,ignoreCount){
if(ignoreCount<0){
throw new Error('Invalid argument');
}
var a=this.findScriptBreakPoint(break_point_number,false);
a.setIgnoreCount(ignoreCount);
};
Debug.scriptBreakPoints=function(){
return script_break_points;
};
Debug.clearStepping=function(){
%ClearStepping();
};
Debug.setBreakOnException=function(){
return %ChangeBreakOnException(Debug.ExceptionBreak.Caught,true);
};
Debug.clearBreakOnException=function(){
return %ChangeBreakOnException(Debug.ExceptionBreak.Caught,false);
};
Debug.isBreakOnException=function(){
return!!%IsBreakOnException(Debug.ExceptionBreak.Caught);
};
Debug.setBreakOnUncaughtException=function(){
return %ChangeBreakOnException(Debug.ExceptionBreak.Uncaught,true);
};
Debug.clearBreakOnUncaughtException=function(){
return %ChangeBreakOnException(Debug.ExceptionBreak.Uncaught,false);
};
Debug.isBreakOnUncaughtException=function(){
return!!%IsBreakOnException(Debug.ExceptionBreak.Uncaught);
};
Debug.showBreakPoints=function(a,b,c){
if(!(%_IsFunction(a)))throw new Error('Parameters have wrong types.');
var d=b?this.scriptSource(a):this.source(a);
var e=b?this.sourcePosition(a):0;
var g=this.breakLocations(a,c);
if(!g)return d;
g.sort(function(h,i){return h-i;});
var j="";
var k=0;
var l;
for(var m=0;m<g.length;m++){
l=g[m]-e;
j+=d.slice(k,l);
j+="[B"+m+"]";
k=l;
}
l=d.length;
j+=d.substring(k,l);
return j;
};
Debug.scripts=function(){
return %DebugGetLoadedScripts();
};
Debug.debuggerFlags=function(){
return debugger_flags;
};
Debug.MakeMirror=MakeMirror;
function MakeExecutionState(a){
return new ExecutionState(a);
}
function ExecutionState(a){
this.break_id=a;
this.selected_frame=0;
}
ExecutionState.prototype.prepareStep=function(opt_action,opt_count,
opt_callframe){
var a=Debug.StepAction.StepIn;
if(!(opt_action===(void 0)))a=builtins.$toNumber(opt_action);
var b=opt_count?builtins.$toNumber(opt_count):1;
var c=0;
if(!(opt_callframe===(void 0))){
c=opt_callframe.details_.frameId();
}
return %PrepareStep(this.break_id,a,b,c);
};
ExecutionState.prototype.evaluateGlobal=function(source,disable_break,
opt_additional_context){
return MakeMirror(%DebugEvaluateGlobal(this.break_id,source,
Boolean(disable_break),
opt_additional_context));
};
ExecutionState.prototype.frameCount=function(){
return %GetFrameCount(this.break_id);
};
ExecutionState.prototype.threadCount=function(){
return %GetThreadCount(this.break_id);
};
ExecutionState.prototype.frame=function(a){
if(a==null)a=this.selected_frame;
if(a<0||a>=this.frameCount()){
throw new Error('Illegal frame index.');
}
return new FrameMirror(this.break_id,a);
};
ExecutionState.prototype.setSelectedFrame=function(a){
var b=builtins.$toNumber(a);
if(b<0||b>=this.frameCount())throw new Error('Illegal frame index.');
this.selected_frame=b;
};
ExecutionState.prototype.selectedFrame=function(){
return this.selected_frame;
};
ExecutionState.prototype.debugCommandProcessor=function(a){
return new DebugCommandProcessor(this,a);
};
function MakeBreakEvent(a,b){
return new BreakEvent(a,b);
}
function BreakEvent(a,b){
this.frame_=new FrameMirror(a,0);
this.break_points_hit_=b;
}
BreakEvent.prototype.eventType=function(){
return Debug.DebugEvent.Break;
};
BreakEvent.prototype.func=function(){
return this.frame_.func();
};
BreakEvent.prototype.sourceLine=function(){
return this.frame_.sourceLine();
};
BreakEvent.prototype.sourceColumn=function(){
return this.frame_.sourceColumn();
};
BreakEvent.prototype.sourceLineText=function(){
return this.frame_.sourceLineText();
};
BreakEvent.prototype.breakPointsHit=function(){
return this.break_points_hit_;
};
BreakEvent.prototype.toJSONProtocol=function(){
var a={seq:next_response_seq++,
type:"event",
event:"break",
body:{invocationText:this.frame_.invocationText()}
};
var b=this.func().script();
if(b){
a.body.sourceLine=this.sourceLine(),
a.body.sourceColumn=this.sourceColumn(),
a.body.sourceLineText=this.sourceLineText(),
a.body.script=MakeScriptObject_(b,false);
}
if(this.breakPointsHit()){
a.body.breakpoints=[];
for(var c=0;c<this.breakPointsHit().length;c++){
var d=this.breakPointsHit()[c];
var e=d.script_break_point();
var g;
if(e){
g=e.number();
}else{
g=d.number();
}
a.body.breakpoints.push(g);
}
}
return JSON.stringify(ObjectToProtocolObject_(a));
};
function MakeExceptionEvent(a,b,c,d){
return new ExceptionEvent(a,b,c,d);
}
function ExceptionEvent(a,b,c,d){
this.exec_state_=new ExecutionState(a);
this.exception_=b;
this.uncaught_=c;
this.promise_=d;
}
ExceptionEvent.prototype.eventType=function(){
return Debug.DebugEvent.Exception;
};
ExceptionEvent.prototype.exception=function(){
return this.exception_;
};
ExceptionEvent.prototype.uncaught=function(){
return this.uncaught_;
};
ExceptionEvent.prototype.promise=function(){
return this.promise_;
};
ExceptionEvent.prototype.func=function(){
return this.exec_state_.frame(0).func();
};
ExceptionEvent.prototype.sourceLine=function(){
return this.exec_state_.frame(0).sourceLine();
};
ExceptionEvent.prototype.sourceColumn=function(){
return this.exec_state_.frame(0).sourceColumn();
};
ExceptionEvent.prototype.sourceLineText=function(){
return this.exec_state_.frame(0).sourceLineText();
};
ExceptionEvent.prototype.toJSONProtocol=function(){
var a=new ProtocolMessage();
a.event="exception";
a.body={uncaught:this.uncaught_,
exception:MakeMirror(this.exception_)
};
if(this.exec_state_.frameCount()>0){
a.body.sourceLine=this.sourceLine();
a.body.sourceColumn=this.sourceColumn();
a.body.sourceLineText=this.sourceLineText();
var b=this.func().script();
if(b){
a.body.script=MakeScriptObject_(b,false);
}
}else{
a.body.sourceLine=-1;
}
return a.toJSONProtocol();
};
function MakeCompileEvent(a,b){
return new CompileEvent(a,b);
}
function CompileEvent(a,b){
this.script_=MakeMirror(a);
this.type_=b;
}
CompileEvent.prototype.eventType=function(){
return this.type_;
};
CompileEvent.prototype.script=function(){
return this.script_;
};
CompileEvent.prototype.toJSONProtocol=function(){
var a=new ProtocolMessage();
a.running=true;
switch(this.type_){
case Debug.DebugEvent.BeforeCompile:
a.event="beforeCompile";
break;
case Debug.DebugEvent.AfterCompile:
a.event="afterCompile";
break;
case Debug.DebugEvent.CompileError:
a.event="compileError";
break;
}
a.body={};
a.body.script=this.script_;
return a.toJSONProtocol();
};
function MakeScriptObject_(a,b){
var c={id:a.id(),
name:a.name(),
lineOffset:a.lineOffset(),
columnOffset:a.columnOffset(),
lineCount:a.lineCount(),
};
if(!(a.data()===(void 0))){
c.data=a.data();
}
if(b){
c.source=a.source();
}
return c;
}
function MakePromiseEvent(a){
return new PromiseEvent(a);
}
function PromiseEvent(a){
this.promise_=a.promise;
this.parentPromise_=a.parentPromise;
this.status_=a.status;
this.value_=a.value;
}
PromiseEvent.prototype.promise=function(){
return MakeMirror(this.promise_);
}
PromiseEvent.prototype.parentPromise=function(){
return MakeMirror(this.parentPromise_);
}
PromiseEvent.prototype.status=function(){
return this.status_;
}
PromiseEvent.prototype.value=function(){
return MakeMirror(this.value_);
}
function MakeAsyncTaskEvent(a){
return new AsyncTaskEvent(a);
}
function AsyncTaskEvent(a){
this.type_=a.type;
this.name_=a.name;
this.id_=a.id;
}
AsyncTaskEvent.prototype.type=function(){
return this.type_;
}
AsyncTaskEvent.prototype.name=function(){
return this.name_;
}
AsyncTaskEvent.prototype.id=function(){
return this.id_;
}
function DebugCommandProcessor(a,b){
this.exec_state_=a;
this.running_=b||false;
}
DebugCommandProcessor.prototype.processDebugRequest=function(a){
return this.processDebugJSONRequest(a);
};
function ProtocolMessage(a){
this.seq=next_response_seq++;
if(a){
this.type='response';
this.request_seq=a.seq;
this.command=a.command;
}else{
this.type='event';
}
this.success=true;
this.running=undefined;
}
ProtocolMessage.prototype.setOption=function(a,b){
if(!this.options_){
this.options_={};
}
this.options_[a]=b;
};
ProtocolMessage.prototype.failed=function(a,b){
this.success=false;
this.message=a;
if((%_IsObject(b))){
this.error_details=b;
}
};
ProtocolMessage.prototype.toJSONProtocol=function(){
var a={};
a.seq=this.seq;
if(this.request_seq){
a.request_seq=this.request_seq;
}
a.type=this.type;
if(this.event){
a.event=this.event;
}
if(this.command){
a.command=this.command;
}
if(this.success){
a.success=this.success;
}else{
a.success=false;
}
if(this.body){
var b;
var c=MakeMirrorSerializer(true,this.options_);
if(this.body instanceof Mirror){
b=c.serializeValue(this.body);
}else if(this.body instanceof Array){
b=[];
for(var d=0;d<this.body.length;d++){
if(this.body[d]instanceof Mirror){
b.push(c.serializeValue(this.body[d]));
}else{
b.push(ObjectToProtocolObject_(this.body[d],c));
}
}
}else{
b=ObjectToProtocolObject_(this.body,c);
}
a.body=b;
a.refs=c.serializeReferencedObjects();
}
if(this.message){
a.message=this.message;
}
if(this.error_details){
a.error_details=this.error_details;
}
a.running=this.running;
return JSON.stringify(a);
};
DebugCommandProcessor.prototype.createResponse=function(a){
return new ProtocolMessage(a);
};
DebugCommandProcessor.prototype.processDebugJSONRequest=function(
json_request){
var a;
var b;
try{
try{
a=JSON.parse(json_request);
b=this.createResponse(a);
if(!a.type){
throw new Error('Type not specified');
}
if(a.type!='request'){
throw new Error("Illegal type '"+a.type+"' in request");
}
if(!a.command){
throw new Error('Command not specified');
}
if(a.arguments){
var c=a.arguments;
if(c.inlineRefs||c.compactFormat){
b.setOption('inlineRefs',true);
}
if(!(c.maxStringLength===(void 0))){
b.setOption('maxStringLength',c.maxStringLength);
}
}
var d=a.command.toLowerCase();
var e=DebugCommandProcessor.prototype.dispatch_[d];
if((%_IsFunction(e))){
%_CallFunction(this,a,b,e);
}else{
throw new Error('Unknown command "'+a.command+'" in request');
}
}catch(e){
if(!b){
b=this.createResponse();
}
b.success=false;
b.message=builtins.$toString(e);
}
try{
if(!(b.running===(void 0))){
this.running_=b.running;
}
b.running=this.running_;
return b.toJSONProtocol();
}catch(e){
return'{"seq":'+b.seq+','+
'"request_seq":'+a.seq+','+
'"type":"response",'+
'"success":false,'+
'"message":"Internal error: '+builtins.$toString(e)+'"}';
}
}catch(e){
return'{"seq":0,"type":"response","success":false,"message":"Internal error"}';
}
};
DebugCommandProcessor.prototype.continueRequest_=function(a,b){
if(a.arguments){
var c=1;
var d=Debug.StepAction.StepIn;
var e=a.arguments.stepaction;
var g=a.arguments.stepcount;
if(g){
c=builtins.$toNumber(g);
if(c<0){
throw new Error('Invalid stepcount argument "'+g+'".');
}
}
if(e){
if(e=='in'){
d=Debug.StepAction.StepIn;
}else if(e=='min'){
d=Debug.StepAction.StepMin;
}else if(e=='next'){
d=Debug.StepAction.StepNext;
}else if(e=='out'){
d=Debug.StepAction.StepOut;
}else{
throw new Error('Invalid stepaction argument "'+e+'".');
}
}
this.exec_state_.prepareStep(d,c);
}
b.running=true;
};
DebugCommandProcessor.prototype.breakRequest_=function(a,b){
};
DebugCommandProcessor.prototype.setBreakPointRequest_=
function(a,b){
if(!a.arguments){
b.failed('Missing arguments');
return;
}
var c=a.arguments.type;
var d=a.arguments.target;
var e=a.arguments.line;
var g=a.arguments.column;
var h=(a.arguments.enabled===(void 0))?
true:a.arguments.enabled;
var i=a.arguments.condition;
var j=a.arguments.ignoreCount;
var k=a.arguments.groupId;
if(!c||(d===(void 0))){
b.failed('Missing argument "type" or "target"');
return;
}
var l;
if(c=='function'){
if(!(typeof(d)==='string')){
b.failed('Argument "target" is not a string value');
return;
}
var m;
try{
m=this.exec_state_.evaluateGlobal(d).value();
}catch(e){
b.failed('Error: "'+builtins.$toString(e)+
'" evaluating "'+d+'"');
return;
}
if(!(%_IsFunction(m))){
b.failed('"'+d+'" does not evaluate to a function');
return;
}
l=Debug.setBreakPoint(m,e,g,i);
}else if(c=='handle'){
var n=parseInt(d,10);
var o=LookupMirror(n);
if(!o){
return b.failed('Object #'+n+'# not found');
}
if(!o.isFunction()){
return b.failed('Object #'+n+'# is not a function');
}
l=Debug.setBreakPoint(o.value(),
e,g,i);
}else if(c=='script'){
l=
Debug.setScriptBreakPointByName(d,e,g,i,
k);
}else if(c=='scriptId'){
l=
Debug.setScriptBreakPointById(d,e,g,i,k);
}else if(c=='scriptRegExp'){
l=
Debug.setScriptBreakPointByRegExp(d,e,g,i,
k);
}else{
b.failed('Illegal type "'+c+'"');
return;
}
var p=Debug.findBreakPoint(l);
if(j){
Debug.changeBreakPointIgnoreCount(l,j);
}
if(!h){
Debug.disableBreakPoint(l);
}
b.body={type:c,
breakpoint:l};
if(p instanceof ScriptBreakPoint){
if(p.type()==Debug.ScriptBreakPointType.ScriptId){
b.body.type='scriptId';
b.body.script_id=p.script_id();
}else if(p.type()==Debug.ScriptBreakPointType.ScriptName){
b.body.type='scriptName';
b.body.script_name=p.script_name();
}else if(p.type()==Debug.ScriptBreakPointType.ScriptRegExp){
b.body.type='scriptRegExp';
b.body.script_regexp=p.script_regexp_object().source;
}else{
throw new Error("Internal error: Unexpected breakpoint type: "+
p.type());
}
b.body.line=p.line();
b.body.column=p.column();
b.body.actual_locations=p.actual_locations();
}else{
b.body.type='function';
b.body.actual_locations=[p.actual_location];
}
};
DebugCommandProcessor.prototype.changeBreakPointRequest_=function(
request,response){
if(!request.arguments){
response.failed('Missing arguments');
return;
}
var a=builtins.$toNumber(request.arguments.breakpoint);
var b=request.arguments.enabled;
var c=request.arguments.condition;
var d=request.arguments.ignoreCount;
if(!a){
response.failed('Missing argument "breakpoint"');
return;
}
if(!(b===(void 0))){
if(b){
Debug.enableBreakPoint(a);
}else{
Debug.disableBreakPoint(a);
}
}
if(!(c===(void 0))){
Debug.changeBreakPointCondition(a,c);
}
if(!(d===(void 0))){
Debug.changeBreakPointIgnoreCount(a,d);
}
};
DebugCommandProcessor.prototype.clearBreakPointGroupRequest_=function(
request,response){
if(!request.arguments){
response.failed('Missing arguments');
return;
}
var a=request.arguments.groupId;
if(!a){
response.failed('Missing argument "groupId"');
return;
}
var b=[];
var c=[];
for(var d=0;d<script_break_points.length;d++){
var e=script_break_points[d];
if(e.groupId()==a){
b.push(e.number());
e.clear();
}else{
c.push(e);
}
}
script_break_points=c;
response.body={breakpoints:b};
};
DebugCommandProcessor.prototype.clearBreakPointRequest_=function(
request,response){
if(!request.arguments){
response.failed('Missing arguments');
return;
}
var a=builtins.$toNumber(request.arguments.breakpoint);
if(!a){
response.failed('Missing argument "breakpoint"');
return;
}
Debug.clearBreakPoint(a);
response.body={breakpoint:a};
};
DebugCommandProcessor.prototype.listBreakpointsRequest_=function(
request,response){
var a=[];
for(var b=0;b<script_break_points.length;b++){
var c=script_break_points[b];
var d={
number:c.number(),
line:c.line(),
column:c.column(),
groupId:c.groupId(),
hit_count:c.hit_count(),
active:c.active(),
condition:c.condition(),
ignoreCount:c.ignoreCount(),
actual_locations:c.actual_locations()
};
if(c.type()==Debug.ScriptBreakPointType.ScriptId){
d.type='scriptId';
d.script_id=c.script_id();
}else if(c.type()==Debug.ScriptBreakPointType.ScriptName){
d.type='scriptName';
d.script_name=c.script_name();
}else if(c.type()==Debug.ScriptBreakPointType.ScriptRegExp){
d.type='scriptRegExp';
d.script_regexp=c.script_regexp_object().source;
}else{
throw new Error("Internal error: Unexpected breakpoint type: "+
c.type());
}
a.push(d);
}
response.body={
breakpoints:a,
breakOnExceptions:Debug.isBreakOnException(),
breakOnUncaughtExceptions:Debug.isBreakOnUncaughtException()
};
};
DebugCommandProcessor.prototype.disconnectRequest_=
function(a,b){
Debug.disableAllBreakPoints();
this.continueRequest_(a,b);
};
DebugCommandProcessor.prototype.setExceptionBreakRequest_=
function(a,b){
if(!a.arguments){
b.failed('Missing arguments');
return;
}
var c=a.arguments.type;
if(!c){
b.failed('Missing argument "type"');
return;
}
var d;
if(c=='all'){
d=!Debug.isBreakOnException();
}else if(c=='uncaught'){
d=!Debug.isBreakOnUncaughtException();
}
if(!(a.arguments.enabled===(void 0))){
d=a.arguments.enabled;
if((d!=true)&&(d!=false)){
b.failed('Illegal value for "enabled":"'+d+'"');
}
}
if(c=='all'){
%ChangeBreakOnException(Debug.ExceptionBreak.Caught,d);
}else if(c=='uncaught'){
%ChangeBreakOnException(Debug.ExceptionBreak.Uncaught,d);
}else{
b.failed('Unknown "type":"'+c+'"');
}
b.body={'type':c,'enabled':d};
};
DebugCommandProcessor.prototype.backtraceRequest_=function(
request,response){
var a=this.exec_state_.frameCount();
if(a==0){
response.body={
totalFrames:a
};
return;
}
var b=0;
var c=kDefaultBacktraceLength;
if(request.arguments){
if(request.arguments.fromFrame){
b=request.arguments.fromFrame;
}
if(request.arguments.toFrame){
c=request.arguments.toFrame;
}
if(request.arguments.bottom){
var d=a-b;
b=a-c;
c=d;
}
if(b<0||c<0){
return response.failed('Invalid frame number');
}
}
c=Math.min(a,c);
if(c<=b){
var e='Invalid frame range';
return response.failed(e);
}
var g=[];
for(var h=b;h<c;h++){
g.push(this.exec_state_.frame(h));
}
response.body={
fromFrame:b,
toFrame:c,
totalFrames:a,
frames:g
};
};
DebugCommandProcessor.prototype.frameRequest_=function(a,b){
if(this.exec_state_.frameCount()==0){
return b.failed('No frames');
}
if(a.arguments){
var c=a.arguments.number;
if(c<0||this.exec_state_.frameCount()<=c){
return b.failed('Invalid frame number');
}
this.exec_state_.setSelectedFrame(a.arguments.number);
}
b.body=this.exec_state_.frame();
};
DebugCommandProcessor.prototype.resolveFrameFromScopeDescription_=
function(a){
if(a&&!(a.frameNumber===(void 0))){
var b=a.frameNumber;
if(b<0||this.exec_state_.frameCount()<=b){
throw new Error('Invalid frame number');
}
return this.exec_state_.frame(b);
}else{
return this.exec_state_.frame();
}
};
DebugCommandProcessor.prototype.resolveScopeHolder_=
function(a){
if(a&&"functionHandle"in a){
if(!(typeof(a.functionHandle)==='number')){
throw new Error('Function handle must be a number');
}
var b=LookupMirror(a.functionHandle);
if(!b){
throw new Error('Failed to find function object by handle');
}
if(!b.isFunction()){
throw new Error('Value of non-function type is found by handle');
}
return b;
}else{
if(this.exec_state_.frameCount()==0){
throw new Error('No scopes');
}
var c=this.resolveFrameFromScopeDescription_(a);
return c;
}
}
DebugCommandProcessor.prototype.scopesRequest_=function(a,b){
var c=this.resolveScopeHolder_(a.arguments);
var d=c.scopeCount();
var e=[];
for(var g=0;g<d;g++){
e.push(c.scope(g));
}
b.body={
fromScope:0,
toScope:d,
totalScopes:d,
scopes:e
};
};
DebugCommandProcessor.prototype.scopeRequest_=function(a,b){
var c=this.resolveScopeHolder_(a.arguments);
var d=0;
if(a.arguments&&!(a.arguments.number===(void 0))){
d=builtins.$toNumber(a.arguments.number);
if(d<0||c.scopeCount()<=d){
return b.failed('Invalid scope number');
}
}
b.body=c.scope(d);
};
DebugCommandProcessor.resolveValue_=function(a){
if("handle"in a){
var b=LookupMirror(a.handle);
if(!b){
throw new Error("Failed to resolve value by handle, ' #"+
a.handle+"# not found");
}
return b.value();
}else if("stringDescription"in a){
if(a.type==BOOLEAN_TYPE){
return Boolean(a.stringDescription);
}else if(a.type==NUMBER_TYPE){
return Number(a.stringDescription);
}if(a.type==STRING_TYPE){
return String(a.stringDescription);
}else{
throw new Error("Unknown type");
}
}else if("value"in a){
return a.value;
}else if(a.type==UNDEFINED_TYPE){
return(void 0);
}else if(a.type==NULL_TYPE){
return null;
}else{
throw new Error("Failed to parse value description");
}
};
DebugCommandProcessor.prototype.setVariableValueRequest_=
function(a,b){
if(!a.arguments){
b.failed('Missing arguments');
return;
}
if((a.arguments.name===(void 0))){
b.failed('Missing variable name');
}
var c=a.arguments.name;
var d=a.arguments.scope;
var e=this.resolveScopeHolder_(d);
if((d.number===(void 0))){
b.failed('Missing scope number');
}
var g=builtins.$toNumber(d.number);
var h=e.scope(g);
var i=
DebugCommandProcessor.resolveValue_(a.arguments.newValue);
h.setVariableValue(c,i);
var j=MakeMirror(i);
b.body={
newValue:j
};
};
DebugCommandProcessor.prototype.evaluateRequest_=function(a,b){
if(!a.arguments){
return b.failed('Missing arguments');
}
var c=a.arguments.expression;
var d=a.arguments.frame;
var e=a.arguments.global;
var g=a.arguments.disable_break;
var h=a.arguments.additional_context;
try{
c=String(c);
}catch(e){
return b.failed('Failed to convert expression argument to string');
}
if(!(d===(void 0))&&e){
return b.failed('Arguments "frame" and "global" are exclusive');
}
var i;
if(h){
i={};
for(var j=0;j<h.length;j++){
var k=h[j];
if(!(typeof(k.name)==='string')){
return b.failed("Context element #"+j+
" doesn't contain name:string property");
}
var l=DebugCommandProcessor.resolveValue_(k);
i[k.name]=l;
}
}
if(e){
b.body=this.exec_state_.evaluateGlobal(
c,Boolean(g),i);
return;
}
if((g===(void 0))){
g=true;
}
if(this.exec_state_.frameCount()==0){
return b.failed('No frames');
}
if(!(d===(void 0))){
var m=builtins.$toNumber(d);
if(m<0||m>=this.exec_state_.frameCount()){
return b.failed('Invalid frame "'+d+'"');
}
b.body=this.exec_state_.frame(m).evaluate(
c,Boolean(g),i);
return;
}else{
b.body=this.exec_state_.frame().evaluate(
c,Boolean(g),i);
return;
}
};
DebugCommandProcessor.prototype.lookupRequest_=function(a,b){
if(!a.arguments){
return b.failed('Missing arguments');
}
var c=a.arguments.handles;
if((c===(void 0))){
return b.failed('Argument "handles" missing');
}
if(!(a.arguments.includeSource===(void 0))){
var d=builtins.$toBoolean(a.arguments.includeSource);
b.setOption('includeSource',d);
}
var e={};
for(var g=0;g<c.length;g++){
var h=c[g];
var i=LookupMirror(h);
if(!i){
return b.failed('Object #'+h+'# not found');
}
e[h]=i;
}
b.body=e;
};
DebugCommandProcessor.prototype.referencesRequest_=
function(a,b){
if(!a.arguments){
return b.failed('Missing arguments');
}
var c=a.arguments.type;
var d=a.arguments.handle;
if((c===(void 0))){
return b.failed('Argument "type" missing');
}
if((d===(void 0))){
return b.failed('Argument "handle" missing');
}
if(c!='referencedBy'&&c!='constructedBy'){
return b.failed('Invalid type "'+c+'"');
}
var e=LookupMirror(d);
if(e){
if(c=='referencedBy'){
b.body=e.referencedBy();
}else{
b.body=e.constructedBy();
}
}else{
return b.failed('Object #'+d+'# not found');
}
};
DebugCommandProcessor.prototype.sourceRequest_=function(a,b){
if(this.exec_state_.frameCount()==0){
return b.failed('No source');
}
var c;
var d;
var e=this.exec_state_.frame();
if(a.arguments){
c=a.arguments.fromLine;
d=a.arguments.toLine;
if(!(a.arguments.frame===(void 0))){
var g=builtins.$toNumber(a.arguments.frame);
if(g<0||g>=this.exec_state_.frameCount()){
return b.failed('Invalid frame "'+e+'"');
}
e=this.exec_state_.frame(g);
}
}
var h=e.func().script();
if(!h){
return b.failed('No source');
}
var i=h.sourceSlice(c,d);
if(!i){
return b.failed('Invalid line interval');
}
b.body={};
b.body.source=i.sourceText();
b.body.fromLine=i.from_line;
b.body.toLine=i.to_line;
b.body.fromPosition=i.from_position;
b.body.toPosition=i.to_position;
b.body.totalLines=h.lineCount();
};
DebugCommandProcessor.prototype.scriptsRequest_=function(a,b){
var c=ScriptTypeFlag(Debug.ScriptType.Normal);
var d=false;
var e=null;
if(a.arguments){
if(!(a.arguments.types===(void 0))){
c=builtins.$toNumber(a.arguments.types);
if(isNaN(c)||c<0){
return b.failed('Invalid types "'+
a.arguments.types+'"');
}
}
if(!(a.arguments.includeSource===(void 0))){
d=builtins.$toBoolean(a.arguments.includeSource);
b.setOption('includeSource',d);
}
if((%_IsArray(a.arguments.ids))){
e={};
var g=a.arguments.ids;
for(var h=0;h<g.length;h++){
e[g[h]]=true;
}
}
var i=null;
var j=null;
if(!(a.arguments.filter===(void 0))){
var k=builtins.$toNumber(a.arguments.filter);
if(!isNaN(k)){
j=k;
}
i=a.arguments.filter;
}
}
var l=%DebugGetLoadedScripts();
b.body=[];
for(var h=0;h<l.length;h++){
if(e&&!e[l[h].id]){
continue;
}
if(i||j){
var m=l[h];
var n=false;
if(j&&!n){
if(m.id&&m.id===j){
n=true;
}
}
if(i&&!n){
if(m.name&&m.name.indexOf(i)>=0){
n=true;
}
}
if(!n)continue;
}
if(c&ScriptTypeFlag(l[h].type)){
b.body.push(MakeMirror(l[h]));
}
}
};
DebugCommandProcessor.prototype.threadsRequest_=function(a,b){
var c=this.exec_state_.threadCount();
var d=[];
for(var e=0;e<c;e++){
var g=%GetThreadDetails(this.exec_state_.break_id,e);
var h={current:g[0],
id:g[1]
};
d.push(h);
}
b.body={
totalThreads:c,
threads:d
};
};
DebugCommandProcessor.prototype.suspendRequest_=function(a,b){
b.running=false;
};
DebugCommandProcessor.prototype.versionRequest_=function(a,b){
b.body={
V8Version:%GetV8Version()
};
};
DebugCommandProcessor.prototype.changeLiveRequest_=function(
request,response){
if(!request.arguments){
return response.failed('Missing arguments');
}
var a=request.arguments.script_id;
var b=!!request.arguments.preview_only;
var c=%DebugGetLoadedScripts();
var d=null;
for(var e=0;e<c.length;e++){
if(c[e].id==a){
d=c[e];
}
}
if(!d){
response.failed('Script not found');
return;
}
var g=new Array();
if(!(typeof(request.arguments.new_source)==='string')){
throw"new_source argument expected";
}
var h=request.arguments.new_source;
var i;
try{
i=Debug.LiveEdit.SetScriptSource(d,
h,b,g);
}catch(e){
if(e instanceof Debug.LiveEdit.Failure&&"details"in e){
response.failed(e.message,e.details);
return;
}
throw e;
}
response.body={change_log:g,result:i};
if(!b&&!this.running_&&i.stack_modified){
response.body.stepin_recommended=true;
}
};
DebugCommandProcessor.prototype.restartFrameRequest_=function(
request,response){
if(!request.arguments){
return response.failed('Missing arguments');
}
var a=request.arguments.frame;
if(this.exec_state_.frameCount()==0){
return response.failed('No frames');
}
var b;
if(!(a===(void 0))){
var c=builtins.$toNumber(a);
if(c<0||c>=this.exec_state_.frameCount()){
return response.failed('Invalid frame "'+a+'"');
}
b=this.exec_state_.frame(c);
}else{
b=this.exec_state_.frame();
}
var d=Debug.LiveEdit.RestartFrame(b);
response.body={result:d};
};
DebugCommandProcessor.prototype.debuggerFlagsRequest_=function(request,
response){
if(!request.arguments){
response.failed('Missing arguments');
return;
}
var a=request.arguments.flags;
response.body={flags:[]};
if(!(a===(void 0))){
for(var b=0;b<a.length;b++){
var c=a[b].name;
var d=debugger_flags[c];
if(!d){
continue;
}
if('value'in a[b]){
d.setValue(a[b].value);
}
response.body.flags.push({name:c,value:d.getValue()});
}
}else{
for(var c in debugger_flags){
var e=debugger_flags[c].getValue();
response.body.flags.push({name:c,value:e});
}
}
};
DebugCommandProcessor.prototype.v8FlagsRequest_=function(a,b){
var c=a.arguments.flags;
if(!c)c='';
%SetFlags(c);
};
DebugCommandProcessor.prototype.gcRequest_=function(a,b){
var c=a.arguments.type;
if(!c)c='all';
var d=%GetHeapUsage();
%CollectGarbage(c);
var e=%GetHeapUsage();
b.body={"before":d,"after":e};
};
DebugCommandProcessor.prototype.dispatch_=(function(){
var a=DebugCommandProcessor.prototype;
return{
"continue":a.continueRequest_,
"break":a.breakRequest_,
"setbreakpoint":a.setBreakPointRequest_,
"changebreakpoint":a.changeBreakPointRequest_,
"clearbreakpoint":a.clearBreakPointRequest_,
"clearbreakpointgroup":a.clearBreakPointGroupRequest_,
"disconnect":a.disconnectRequest_,
"setexceptionbreak":a.setExceptionBreakRequest_,
"listbreakpoints":a.listBreakpointsRequest_,
"backtrace":a.backtraceRequest_,
"frame":a.frameRequest_,
"scopes":a.scopesRequest_,
"scope":a.scopeRequest_,
"setvariablevalue":a.setVariableValueRequest_,
"evaluate":a.evaluateRequest_,
"lookup":a.lookupRequest_,
"references":a.referencesRequest_,
"source":a.sourceRequest_,
"scripts":a.scriptsRequest_,
"threads":a.threadsRequest_,
"suspend":a.suspendRequest_,
"version":a.versionRequest_,
"changelive":a.changeLiveRequest_,
"restartframe":a.restartFrameRequest_,
"flags":a.debuggerFlagsRequest_,
"v8flag":a.v8FlagsRequest_,
"gc":a.gcRequest_,
};
})();
DebugCommandProcessor.prototype.isRunning=function(){
return this.running_;
};
DebugCommandProcessor.prototype.systemBreak=function(a,b){
return %SystemBreak();
};
function ObjectToProtocolObject_(a,b){
var c={};
for(var d in a){
if(typeof d=='string'){
var e=ValueToProtocolValue_(a[d],
b);
if(!(e===(void 0))){
c[d]=e;
}
}
}
return c;
}
function ArrayToProtocolArray_(a,b){
var c=[];
for(var d=0;d<a.length;d++){
c.push(ValueToProtocolValue_(a[d],b));
}
return c;
}
function ValueToProtocolValue_(a,b){
var c;
switch(typeof a){
case'object':
if(a instanceof Mirror){
c=b.serializeValue(a);
}else if((%_IsArray(a))){
c=ArrayToProtocolArray_(a,b);
}else{
c=ObjectToProtocolObject_(a,b);
}
break;
case'boolean':
case'string':
case'number':
c=a;
break;
default:
c=null;
}
return c;
}

mirrorÊ¥
"use strict";
var next_handle_=0;
var next_transient_handle_=-1;
var mirror_cache_=[];
var mirror_cache_enabled_=true;
function ToggleMirrorCache(a){
mirror_cache_enabled_=a;
next_handle_=0;
mirror_cache_=[];
}
function ObjectIsPromise(a){
try{
return(%_IsSpecObject(a))&&
!(%DebugGetProperty(a,builtins.$promiseStatus)===(void 0));
}catch(e){
return false;
}
}
function MakeMirror(a,b){
var c;
if(!b&&mirror_cache_enabled_){
for(var d in mirror_cache_){
c=mirror_cache_[d];
if(c.value()===a){
return c;
}
if(c.isNumber()&&isNaN(c.value())&&
typeof a=='number'&&isNaN(a)){
return c;
}
}
}
if((a===(void 0))){
c=new UndefinedMirror();
}else if((a===null)){
c=new NullMirror();
}else if((typeof(a)==='boolean')){
c=new BooleanMirror(a);
}else if((typeof(a)==='number')){
c=new NumberMirror(a);
}else if((typeof(a)==='string')){
c=new StringMirror(a);
}else if((typeof(a)==='symbol')){
c=new SymbolMirror(a);
}else if((%_IsArray(a))){
c=new ArrayMirror(a);
}else if((%_ClassOf(a)==='Date')){
c=new DateMirror(a);
}else if((%_IsFunction(a))){
c=new FunctionMirror(a);
}else if((%_IsRegExp(a))){
c=new RegExpMirror(a);
}else if((%_ClassOf(a)==='Error')){
c=new ErrorMirror(a);
}else if((%_ClassOf(a)==='Script')){
c=new ScriptMirror(a);
}else if((%_ClassOf(a)==='Map')||(%_ClassOf(a)==='WeakMap')){
c=new MapMirror(a);
}else if((%_ClassOf(a)==='Set')||(%_ClassOf(a)==='WeakSet')){
c=new SetMirror(a);
}else if((%_ClassOf(a)==='Map Iterator')||(%_ClassOf(a)==='Set Iterator')){
c=new IteratorMirror(a);
}else if(ObjectIsPromise(a)){
c=new PromiseMirror(a);
}else if((%_ClassOf(a)==='Generator')){
c=new GeneratorMirror(a);
}else{
c=new ObjectMirror(a,OBJECT_TYPE,b);
}
if(mirror_cache_enabled_)mirror_cache_[c.handle()]=c;
return c;
}
function LookupMirror(a){
if(!mirror_cache_enabled_)throw new Error("Mirror cache is disabled");
return mirror_cache_[a];
}
function GetUndefinedMirror(){
return MakeMirror((void 0));
}
function inherits(a,b){
var c=function(){};
c.prototype=b.prototype;
a.super_=b.prototype;
a.prototype=new c();
a.prototype.constructor=a;
}
var UNDEFINED_TYPE='undefined';
var NULL_TYPE='null';
var BOOLEAN_TYPE='boolean';
var NUMBER_TYPE='number';
var STRING_TYPE='string';
var SYMBOL_TYPE='symbol';
var OBJECT_TYPE='object';
var FUNCTION_TYPE='function';
var REGEXP_TYPE='regexp';
var ERROR_TYPE='error';
var PROPERTY_TYPE='property';
var INTERNAL_PROPERTY_TYPE='internalProperty';
var FRAME_TYPE='frame';
var SCRIPT_TYPE='script';
var CONTEXT_TYPE='context';
var SCOPE_TYPE='scope';
var PROMISE_TYPE='promise';
var MAP_TYPE='map';
var SET_TYPE='set';
var ITERATOR_TYPE='iterator';
var GENERATOR_TYPE='generator';
var kMaxProtocolStringLength=80;
var PropertyKind={};
PropertyKind.Named=1;
PropertyKind.Indexed=2;
var PropertyType={};
PropertyType.Data=0;
PropertyType.DataConstant=2;
PropertyType.AccessorConstant=3;
var PropertyAttribute={};
PropertyAttribute.None=0;
PropertyAttribute.ReadOnly=1;
PropertyAttribute.DontEnum=2;
PropertyAttribute.DontDelete=4;
var ScopeType={Global:0,
Local:1,
With:2,
Closure:3,
Catch:4,
Block:5,
Script:6};
function Mirror(a){
this.type_=a;
}
Mirror.prototype.type=function(){
return this.type_;
};
Mirror.prototype.isValue=function(){
return this instanceof ValueMirror;
};
Mirror.prototype.isUndefined=function(){
return this instanceof UndefinedMirror;
};
Mirror.prototype.isNull=function(){
return this instanceof NullMirror;
};
Mirror.prototype.isBoolean=function(){
return this instanceof BooleanMirror;
};
Mirror.prototype.isNumber=function(){
return this instanceof NumberMirror;
};
Mirror.prototype.isString=function(){
return this instanceof StringMirror;
};
Mirror.prototype.isSymbol=function(){
return this instanceof SymbolMirror;
};
Mirror.prototype.isObject=function(){
return this instanceof ObjectMirror;
};
Mirror.prototype.isFunction=function(){
return this instanceof FunctionMirror;
};
Mirror.prototype.isUnresolvedFunction=function(){
return this instanceof UnresolvedFunctionMirror;
};
Mirror.prototype.isArray=function(){
return this instanceof ArrayMirror;
};
Mirror.prototype.isDate=function(){
return this instanceof DateMirror;
};
Mirror.prototype.isRegExp=function(){
return this instanceof RegExpMirror;
};
Mirror.prototype.isError=function(){
return this instanceof ErrorMirror;
};
Mirror.prototype.isPromise=function(){
return this instanceof PromiseMirror;
};
Mirror.prototype.isGenerator=function(){
return this instanceof GeneratorMirror;
};
Mirror.prototype.isProperty=function(){
return this instanceof PropertyMirror;
};
Mirror.prototype.isInternalProperty=function(){
return this instanceof InternalPropertyMirror;
};
Mirror.prototype.isFrame=function(){
return this instanceof FrameMirror;
};
Mirror.prototype.isScript=function(){
return this instanceof ScriptMirror;
};
Mirror.prototype.isContext=function(){
return this instanceof ContextMirror;
};
Mirror.prototype.isScope=function(){
return this instanceof ScopeMirror;
};
Mirror.prototype.isMap=function(){
return this instanceof MapMirror;
};
Mirror.prototype.isSet=function(){
return this instanceof SetMirror;
};
Mirror.prototype.isIterator=function(){
return this instanceof IteratorMirror;
};
Mirror.prototype.allocateHandle_=function(){
if(mirror_cache_enabled_)this.handle_=next_handle_++;
};
Mirror.prototype.allocateTransientHandle_=function(){
this.handle_=next_transient_handle_--;
};
Mirror.prototype.toText=function(){
return"#<"+this.constructor.name+">";
};
function ValueMirror(a,b,c){
%_CallFunction(this,a,Mirror);
this.value_=b;
if(!c){
this.allocateHandle_();
}else{
this.allocateTransientHandle_();
}
}
inherits(ValueMirror,Mirror);
Mirror.prototype.handle=function(){
return this.handle_;
};
ValueMirror.prototype.isPrimitive=function(){
var a=this.type();
return a==='undefined'||
a==='null'||
a==='boolean'||
a==='number'||
a==='string'||
a==='symbol';
};
ValueMirror.prototype.value=function(){
return this.value_;
};
function UndefinedMirror(){
%_CallFunction(this,UNDEFINED_TYPE,(void 0),ValueMirror);
}
inherits(UndefinedMirror,ValueMirror);
UndefinedMirror.prototype.toText=function(){
return'undefined';
};
function NullMirror(){
%_CallFunction(this,NULL_TYPE,null,ValueMirror);
}
inherits(NullMirror,ValueMirror);
NullMirror.prototype.toText=function(){
return'null';
};
function BooleanMirror(a){
%_CallFunction(this,BOOLEAN_TYPE,a,ValueMirror);
}
inherits(BooleanMirror,ValueMirror);
BooleanMirror.prototype.toText=function(){
return this.value_?'true':'false';
};
function NumberMirror(a){
%_CallFunction(this,NUMBER_TYPE,a,ValueMirror);
}
inherits(NumberMirror,ValueMirror);
NumberMirror.prototype.toText=function(){
return %_NumberToString(this.value_);
};
function StringMirror(a){
%_CallFunction(this,STRING_TYPE,a,ValueMirror);
}
inherits(StringMirror,ValueMirror);
StringMirror.prototype.length=function(){
return this.value_.length;
};
StringMirror.prototype.getTruncatedValue=function(a){
if(a!=-1&&this.length()>a){
return this.value_.substring(0,a)+
'... (length: '+this.length()+')';
}
return this.value_;
};
StringMirror.prototype.toText=function(){
return this.getTruncatedValue(kMaxProtocolStringLength);
};
function SymbolMirror(a){
%_CallFunction(this,SYMBOL_TYPE,a,ValueMirror);
}
inherits(SymbolMirror,ValueMirror);
SymbolMirror.prototype.description=function(){
return %SymbolDescription(%_ValueOf(this.value_));
}
SymbolMirror.prototype.toText=function(){
return %_CallFunction(this.value_,builtins.$symbolToString);
}
function ObjectMirror(a,b,c){
%_CallFunction(this,b||OBJECT_TYPE,a,c,ValueMirror);
}
inherits(ObjectMirror,ValueMirror);
ObjectMirror.prototype.className=function(){
return %_ClassOf(this.value_);
};
ObjectMirror.prototype.constructorFunction=function(){
return MakeMirror(%DebugGetProperty(this.value_,'constructor'));
};
ObjectMirror.prototype.prototypeObject=function(){
return MakeMirror(%DebugGetProperty(this.value_,'prototype'));
};
ObjectMirror.prototype.protoObject=function(){
return MakeMirror(%DebugGetPrototype(this.value_));
};
ObjectMirror.prototype.hasNamedInterceptor=function(){
var a=%GetInterceptorInfo(this.value_);
return(a&2)!=0;
};
ObjectMirror.prototype.hasIndexedInterceptor=function(){
var a=%GetInterceptorInfo(this.value_);
return(a&1)!=0;
};
function TryGetPropertyNames(a){
try{
return %GetOwnPropertyNames(a,32);
}catch(e){
return[];
}
}
ObjectMirror.prototype.propertyNames=function(a,b){
a=a||PropertyKind.Named|PropertyKind.Indexed;
var c;
var d;
var e=0;
if(a&PropertyKind.Named){
c=TryGetPropertyNames(this.value_);
e+=c.length;
if(this.hasNamedInterceptor()&&(a&PropertyKind.Named)){
var g=
%GetNamedInterceptorPropertyNames(this.value_);
if(g){
c=c.concat(g);
e+=g.length;
}
}
}
if(a&PropertyKind.Indexed){
d=%GetOwnElementNames(this.value_);
e+=d.length;
if(this.hasIndexedInterceptor()&&(a&PropertyKind.Indexed)){
var h=
%GetIndexedInterceptorElementNames(this.value_);
if(h){
d=d.concat(h);
e+=h.length;
}
}
}
b=Math.min(b||e,e);
var i=new Array(b);
var j=0;
if(a&PropertyKind.Named){
for(var k=0;j<b&&k<c.length;k++){
i[j++]=c[k];
}
}
if(a&PropertyKind.Indexed){
for(var k=0;j<b&&k<d.length;k++){
i[j++]=d[k];
}
}
return i;
};
ObjectMirror.prototype.properties=function(a,b){
var c=this.propertyNames(a,b);
var d=new Array(c.length);
for(var e=0;e<c.length;e++){
d[e]=this.property(c[e]);
}
return d;
};
ObjectMirror.prototype.internalProperties=function(){
return ObjectMirror.GetInternalProperties(this.value_);
}
ObjectMirror.prototype.property=function(a){
var b=%DebugGetPropertyDetails(this.value_,builtins.$toName(a));
if(b){
return new PropertyMirror(this,a,b);
}
return GetUndefinedMirror();
};
ObjectMirror.prototype.lookupProperty=function(a){
var b=this.properties();
for(var c=0;c<b.length;c++){
var d=b[c];
if(d.propertyType()!=PropertyType.AccessorConstant){
if(%_ObjectEquals(d.value_,a.value_)){
return d;
}
}
}
return GetUndefinedMirror();
};
ObjectMirror.prototype.referencedBy=function(a){
var b=%DebugReferencedBy(this.value_,
Mirror.prototype,a||0);
for(var c=0;c<b.length;c++){
b[c]=MakeMirror(b[c]);
}
return b;
};
ObjectMirror.prototype.toText=function(){
var a;
var b=this.constructorFunction();
if(!b.isFunction()){
a=this.className();
}else{
a=b.name();
if(!a){
a=this.className();
}
}
return'#<'+a+'>';
};
ObjectMirror.GetInternalProperties=function(a){
if((%_ClassOf(a)==='String')||(%_ClassOf(a)==='Number')||
(%_ClassOf(a)==='Boolean')){
var b=%_ValueOf(a);
return[new InternalPropertyMirror("[[PrimitiveValue]]",b)];
}else if((%_IsFunction(a))){
var c=%BoundFunctionGetBindings(a);
var d=[];
if(c&&(%_IsArray(c))){
d.push(new InternalPropertyMirror("[[TargetFunction]]",
c[0]));
d.push(new InternalPropertyMirror("[[BoundThis]]",c[1]));
var e=[];
for(var g=2;g<c.length;g++){
e.push(c[g]);
}
d.push(new InternalPropertyMirror("[[BoundArgs]]",e));
}
return d;
}else if((%_ClassOf(a)==='Map Iterator')||(%_ClassOf(a)==='Set Iterator')){
var h=(%_ClassOf(a)==='Map Iterator')?%MapIteratorDetails(a)
:%SetIteratorDetails(a);
var i;
switch(h[2]){
case 1:i="keys";break;
case 2:i="values";break;
case 3:i="entries";break;
}
var d=[
new InternalPropertyMirror("[[IteratorHasMore]]",h[0]),
new InternalPropertyMirror("[[IteratorIndex]]",h[1])
];
if(i){
d.push(new InternalPropertyMirror("[[IteratorKind]]",i));
}
return d;
}else if((%_ClassOf(a)==='Generator')){
return[
new InternalPropertyMirror("[[GeneratorStatus]]",
GeneratorGetStatus_(a)),
new InternalPropertyMirror("[[GeneratorFunction]]",
%GeneratorGetFunction(a)),
new InternalPropertyMirror("[[GeneratorReceiver]]",
%GeneratorGetReceiver(a))
];
}else if(ObjectIsPromise(a)){
return[
new InternalPropertyMirror("[[PromiseStatus]]",PromiseGetStatus_(a)),
new InternalPropertyMirror("[[PromiseValue]]",PromiseGetValue_(a))
];
}
return[];
}
function FunctionMirror(a){
%_CallFunction(this,a,FUNCTION_TYPE,ObjectMirror);
this.resolved_=true;
}
inherits(FunctionMirror,ObjectMirror);
FunctionMirror.prototype.resolved=function(){
return this.resolved_;
};
FunctionMirror.prototype.name=function(){
return %FunctionGetName(this.value_);
};
FunctionMirror.prototype.inferredName=function(){
return %FunctionGetInferredName(this.value_);
};
FunctionMirror.prototype.source=function(){
if(this.resolved()){
return builtins.$functionSourceString(this.value_);
}
};
FunctionMirror.prototype.script=function(){
if(this.resolved()){
if(this.script_){
return this.script_;
}
var a=%FunctionGetScript(this.value_);
if(a){
return this.script_=MakeMirror(a);
}
}
};
FunctionMirror.prototype.sourcePosition_=function(){
if(this.resolved()){
return %FunctionGetScriptSourcePosition(this.value_);
}
};
FunctionMirror.prototype.sourceLocation=function(){
if(this.resolved()){
var a=this.script();
if(a){
return a.locationFromPosition(this.sourcePosition_(),true);
}
}
};
FunctionMirror.prototype.constructedBy=function(a){
if(this.resolved()){
var b=%DebugConstructedBy(this.value_,a||0);
for(var c=0;c<b.length;c++){
b[c]=MakeMirror(b[c]);
}
return b;
}else{
return[];
}
};
FunctionMirror.prototype.scopeCount=function(){
if(this.resolved()){
if((this.scopeCount_===(void 0))){
this.scopeCount_=%GetFunctionScopeCount(this.value());
}
return this.scopeCount_;
}else{
return 0;
}
};
FunctionMirror.prototype.scope=function(a){
if(this.resolved()){
return new ScopeMirror((void 0),this,a);
}
};
FunctionMirror.prototype.toText=function(){
return this.source();
};
function UnresolvedFunctionMirror(a){
%_CallFunction(this,FUNCTION_TYPE,a,ValueMirror);
this.propertyCount_=0;
this.elementCount_=0;
this.resolved_=false;
}
inherits(UnresolvedFunctionMirror,FunctionMirror);
UnresolvedFunctionMirror.prototype.className=function(){
return'Function';
};
UnresolvedFunctionMirror.prototype.constructorFunction=function(){
return GetUndefinedMirror();
};
UnresolvedFunctionMirror.prototype.prototypeObject=function(){
return GetUndefinedMirror();
};
UnresolvedFunctionMirror.prototype.protoObject=function(){
return GetUndefinedMirror();
};
UnresolvedFunctionMirror.prototype.name=function(){
return this.value_;
};
UnresolvedFunctionMirror.prototype.inferredName=function(){
return undefined;
};
UnresolvedFunctionMirror.prototype.propertyNames=function(a,b){
return[];
};
function ArrayMirror(a){
%_CallFunction(this,a,ObjectMirror);
}
inherits(ArrayMirror,ObjectMirror);
ArrayMirror.prototype.length=function(){
return this.value_.length;
};
ArrayMirror.prototype.indexedPropertiesFromRange=function(opt_from_index,
opt_to_index){
var a=opt_from_index||0;
var b=opt_to_index||this.length()-1;
if(a>b)return new Array();
var c=new Array(b-a+1);
for(var d=a;d<=b;d++){
var e=%DebugGetPropertyDetails(this.value_,builtins.$toString(d));
var g;
if(e){
g=new PropertyMirror(this,d,e);
}else{
g=GetUndefinedMirror();
}
c[d-a]=g;
}
return c;
};
function DateMirror(a){
%_CallFunction(this,a,ObjectMirror);
}
inherits(DateMirror,ObjectMirror);
DateMirror.prototype.toText=function(){
var a=JSON.stringify(this.value_);
return a.substring(1,a.length-1);
};
function RegExpMirror(a){
%_CallFunction(this,a,REGEXP_TYPE,ObjectMirror);
}
inherits(RegExpMirror,ObjectMirror);
RegExpMirror.prototype.source=function(){
return this.value_.source;
};
RegExpMirror.prototype.global=function(){
return this.value_.global;
};
RegExpMirror.prototype.ignoreCase=function(){
return this.value_.ignoreCase;
};
RegExpMirror.prototype.multiline=function(){
return this.value_.multiline;
};
RegExpMirror.prototype.sticky=function(){
return this.value_.sticky;
};
RegExpMirror.prototype.unicode=function(){
return this.value_.unicode;
};
RegExpMirror.prototype.toText=function(){
return"/"+this.source()+"/";
};
function ErrorMirror(a){
%_CallFunction(this,a,ERROR_TYPE,ObjectMirror);
}
inherits(ErrorMirror,ObjectMirror);
ErrorMirror.prototype.message=function(){
return this.value_.message;
};
ErrorMirror.prototype.toText=function(){
var a;
try{
a=%_CallFunction(this.value_,builtins.$errorToString);
}catch(e){
a='#<Error>';
}
return a;
};
function PromiseMirror(a){
%_CallFunction(this,a,PROMISE_TYPE,ObjectMirror);
}
inherits(PromiseMirror,ObjectMirror);
function PromiseGetStatus_(a){
var b=%DebugGetProperty(a,builtins.$promiseStatus);
if(b==0)return"pending";
if(b==1)return"resolved";
return"rejected";
}
function PromiseGetValue_(a){
return %DebugGetProperty(a,builtins.$promiseValue);
}
PromiseMirror.prototype.status=function(){
return PromiseGetStatus_(this.value_);
};
PromiseMirror.prototype.promiseValue=function(){
return MakeMirror(PromiseGetValue_(this.value_));
};
function MapMirror(a){
%_CallFunction(this,a,MAP_TYPE,ObjectMirror);
}
inherits(MapMirror,ObjectMirror);
MapMirror.prototype.entries=function(a){
var b=[];
if((%_ClassOf(this.value_)==='WeakMap')){
var c=%GetWeakMapEntries(this.value_,a||0);
for(var d=0;d<c.length;d+=2){
b.push({
key:c[d],
value:c[d+1]
});
}
return b;
}
var e=%_CallFunction(this.value_,builtins.$mapEntries);
var g;
while((!a||b.length<a)&&
!(g=e.next()).done){
b.push({
key:g.value[0],
value:g.value[1]
});
}
return b;
};
function SetMirror(a){
%_CallFunction(this,a,SET_TYPE,ObjectMirror);
}
inherits(SetMirror,ObjectMirror);
function IteratorGetValues_(a,b,c){
var d=[];
var e;
while((!c||d.length<c)&&
!(e=%_CallFunction(a,b)).done){
d.push(e.value);
}
return d;
}
SetMirror.prototype.values=function(a){
if((%_ClassOf(this.value_)==='WeakSet')){
return %GetWeakSetValues(this.value_,a||0);
}
var b=%_CallFunction(this.value_,builtins.$setValues);
return IteratorGetValues_(b,builtins.$setIteratorNext,a);
};
function IteratorMirror(a){
%_CallFunction(this,a,ITERATOR_TYPE,ObjectMirror);
}
inherits(IteratorMirror,ObjectMirror);
IteratorMirror.prototype.preview=function(a){
if((%_ClassOf(this.value_)==='Map Iterator')){
return IteratorGetValues_(%MapIteratorClone(this.value_),
builtins.$mapIteratorNext,
a);
}else if((%_ClassOf(this.value_)==='Set Iterator')){
return IteratorGetValues_(%SetIteratorClone(this.value_),
builtins.$setIteratorNext,
a);
}
};
function GeneratorMirror(a){
%_CallFunction(this,a,GENERATOR_TYPE,ObjectMirror);
}
inherits(GeneratorMirror,ObjectMirror);
function GeneratorGetStatus_(a){
var b=%GeneratorGetContinuation(a);
if(b<0)return"running";
if(b==0)return"closed";
return"suspended";
}
GeneratorMirror.prototype.status=function(){
return GeneratorGetStatus_(this.value_);
};
GeneratorMirror.prototype.sourcePosition_=function(){
return %GeneratorGetSourcePosition(this.value_);
};
GeneratorMirror.prototype.sourceLocation=function(){
var a=this.sourcePosition_();
if(!(a===(void 0))){
var b=this.func().script();
if(b){
return b.locationFromPosition(a,true);
}
}
};
GeneratorMirror.prototype.func=function(){
if(!this.func_){
this.func_=MakeMirror(%GeneratorGetFunction(this.value_));
}
return this.func_;
};
GeneratorMirror.prototype.context=function(){
if(!this.context_){
this.context_=new ContextMirror(%GeneratorGetContext(this.value_));
}
return this.context_;
};
GeneratorMirror.prototype.receiver=function(){
if(!this.receiver_){
this.receiver_=MakeMirror(%GeneratorGetReceiver(this.value_));
}
return this.receiver_;
};
function PropertyMirror(a,b,c){
%_CallFunction(this,PROPERTY_TYPE,Mirror);
this.mirror_=a;
this.name_=b;
this.value_=c[0];
this.details_=c[1];
this.is_interceptor_=c[2];
if(c.length>3){
this.exception_=c[3];
this.getter_=c[4];
this.setter_=c[5];
}
}
inherits(PropertyMirror,Mirror);
PropertyMirror.prototype.isReadOnly=function(){
return(this.attributes()&PropertyAttribute.ReadOnly)!=0;
};
PropertyMirror.prototype.isEnum=function(){
return(this.attributes()&PropertyAttribute.DontEnum)==0;
};
PropertyMirror.prototype.canDelete=function(){
return(this.attributes()&PropertyAttribute.DontDelete)==0;
};
PropertyMirror.prototype.name=function(){
return this.name_;
};
PropertyMirror.prototype.isIndexed=function(){
for(var a=0;a<this.name_.length;a++){
if(this.name_[a]<'0'||'9'<this.name_[a]){
return false;
}
}
return true;
};
PropertyMirror.prototype.value=function(){
return MakeMirror(this.value_,false);
};
PropertyMirror.prototype.isException=function(){
return this.exception_?true:false;
};
PropertyMirror.prototype.attributes=function(){
return %DebugPropertyAttributesFromDetails(this.details_);
};
PropertyMirror.prototype.propertyType=function(){
return %DebugPropertyTypeFromDetails(this.details_);
};
PropertyMirror.prototype.insertionIndex=function(){
return %DebugPropertyIndexFromDetails(this.details_);
};
PropertyMirror.prototype.hasGetter=function(){
return this.getter_?true:false;
};
PropertyMirror.prototype.hasSetter=function(){
return this.setter_?true:false;
};
PropertyMirror.prototype.getter=function(){
if(this.hasGetter()){
return MakeMirror(this.getter_);
}else{
return GetUndefinedMirror();
}
};
PropertyMirror.prototype.setter=function(){
if(this.hasSetter()){
return MakeMirror(this.setter_);
}else{
return GetUndefinedMirror();
}
};
PropertyMirror.prototype.isNative=function(){
return this.is_interceptor_||
((this.propertyType()==PropertyType.AccessorConstant)&&
!this.hasGetter()&&!this.hasSetter());
};
function InternalPropertyMirror(a,b){
%_CallFunction(this,INTERNAL_PROPERTY_TYPE,Mirror);
this.name_=a;
this.value_=b;
}
inherits(InternalPropertyMirror,Mirror);
InternalPropertyMirror.prototype.name=function(){
return this.name_;
};
InternalPropertyMirror.prototype.value=function(){
return MakeMirror(this.value_,false);
};
var kFrameDetailsFrameIdIndex=0;
var kFrameDetailsReceiverIndex=1;
var kFrameDetailsFunctionIndex=2;
var kFrameDetailsArgumentCountIndex=3;
var kFrameDetailsLocalCountIndex=4;
var kFrameDetailsSourcePositionIndex=5;
var kFrameDetailsConstructCallIndex=6;
var kFrameDetailsAtReturnIndex=7;
var kFrameDetailsFlagsIndex=8;
var kFrameDetailsFirstDynamicIndex=9;
var kFrameDetailsNameIndex=0;
var kFrameDetailsValueIndex=1;
var kFrameDetailsNameValueSize=2;
var kFrameDetailsFlagDebuggerFrameMask=1<<0;
var kFrameDetailsFlagOptimizedFrameMask=1<<1;
var kFrameDetailsFlagInlinedFrameIndexMask=7<<2;
function FrameDetails(a,b){
this.break_id_=a;
this.details_=%GetFrameDetails(a,b);
}
FrameDetails.prototype.frameId=function(){
%CheckExecutionState(this.break_id_);
return this.details_[kFrameDetailsFrameIdIndex];
};
FrameDetails.prototype.receiver=function(){
%CheckExecutionState(this.break_id_);
return this.details_[kFrameDetailsReceiverIndex];
};
FrameDetails.prototype.func=function(){
%CheckExecutionState(this.break_id_);
return this.details_[kFrameDetailsFunctionIndex];
};
FrameDetails.prototype.isConstructCall=function(){
%CheckExecutionState(this.break_id_);
return this.details_[kFrameDetailsConstructCallIndex];
};
FrameDetails.prototype.isAtReturn=function(){
%CheckExecutionState(this.break_id_);
return this.details_[kFrameDetailsAtReturnIndex];
};
FrameDetails.prototype.isDebuggerFrame=function(){
%CheckExecutionState(this.break_id_);
var a=kFrameDetailsFlagDebuggerFrameMask;
return(this.details_[kFrameDetailsFlagsIndex]&a)==a;
};
FrameDetails.prototype.isOptimizedFrame=function(){
%CheckExecutionState(this.break_id_);
var a=kFrameDetailsFlagOptimizedFrameMask;
return(this.details_[kFrameDetailsFlagsIndex]&a)==a;
};
FrameDetails.prototype.isInlinedFrame=function(){
return this.inlinedFrameIndex()>0;
};
FrameDetails.prototype.inlinedFrameIndex=function(){
%CheckExecutionState(this.break_id_);
var a=kFrameDetailsFlagInlinedFrameIndexMask;
return(this.details_[kFrameDetailsFlagsIndex]&a)>>2;
};
FrameDetails.prototype.argumentCount=function(){
%CheckExecutionState(this.break_id_);
return this.details_[kFrameDetailsArgumentCountIndex];
};
FrameDetails.prototype.argumentName=function(a){
%CheckExecutionState(this.break_id_);
if(a>=0&&a<this.argumentCount()){
return this.details_[kFrameDetailsFirstDynamicIndex+
a*kFrameDetailsNameValueSize+
kFrameDetailsNameIndex];
}
};
FrameDetails.prototype.argumentValue=function(a){
%CheckExecutionState(this.break_id_);
if(a>=0&&a<this.argumentCount()){
return this.details_[kFrameDetailsFirstDynamicIndex+
a*kFrameDetailsNameValueSize+
kFrameDetailsValueIndex];
}
};
FrameDetails.prototype.localCount=function(){
%CheckExecutionState(this.break_id_);
return this.details_[kFrameDetailsLocalCountIndex];
};
FrameDetails.prototype.sourcePosition=function(){
%CheckExecutionState(this.break_id_);
return this.details_[kFrameDetailsSourcePositionIndex];
};
FrameDetails.prototype.localName=function(a){
%CheckExecutionState(this.break_id_);
if(a>=0&&a<this.localCount()){
var b=kFrameDetailsFirstDynamicIndex+
this.argumentCount()*kFrameDetailsNameValueSize;
return this.details_[b+
a*kFrameDetailsNameValueSize+
kFrameDetailsNameIndex];
}
};
FrameDetails.prototype.localValue=function(a){
%CheckExecutionState(this.break_id_);
if(a>=0&&a<this.localCount()){
var b=kFrameDetailsFirstDynamicIndex+
this.argumentCount()*kFrameDetailsNameValueSize;
return this.details_[b+
a*kFrameDetailsNameValueSize+
kFrameDetailsValueIndex];
}
};
FrameDetails.prototype.returnValue=function(){
%CheckExecutionState(this.break_id_);
var a=
kFrameDetailsFirstDynamicIndex+
(this.argumentCount()+this.localCount())*kFrameDetailsNameValueSize;
if(this.details_[kFrameDetailsAtReturnIndex]){
return this.details_[a];
}
};
FrameDetails.prototype.scopeCount=function(){
if((this.scopeCount_===(void 0))){
this.scopeCount_=%GetScopeCount(this.break_id_,this.frameId());
}
return this.scopeCount_;
};
FrameDetails.prototype.stepInPositionsImpl=function(){
return %GetStepInPositions(this.break_id_,this.frameId());
};
function FrameMirror(a,b){
%_CallFunction(this,FRAME_TYPE,Mirror);
this.break_id_=a;
this.index_=b;
this.details_=new FrameDetails(a,b);
}
inherits(FrameMirror,Mirror);
FrameMirror.prototype.details=function(){
return this.details_;
};
FrameMirror.prototype.index=function(){
return this.index_;
};
FrameMirror.prototype.func=function(){
if(this.func_){
return this.func_;
}
var a=this.details_.func();
if((%_IsFunction(a))){
return this.func_=MakeMirror(a);
}else{
return new UnresolvedFunctionMirror(a);
}
};
FrameMirror.prototype.receiver=function(){
return MakeMirror(this.details_.receiver());
};
FrameMirror.prototype.isConstructCall=function(){
return this.details_.isConstructCall();
};
FrameMirror.prototype.isAtReturn=function(){
return this.details_.isAtReturn();
};
FrameMirror.prototype.isDebuggerFrame=function(){
return this.details_.isDebuggerFrame();
};
FrameMirror.prototype.isOptimizedFrame=function(){
return this.details_.isOptimizedFrame();
};
FrameMirror.prototype.isInlinedFrame=function(){
return this.details_.isInlinedFrame();
};
FrameMirror.prototype.inlinedFrameIndex=function(){
return this.details_.inlinedFrameIndex();
};
FrameMirror.prototype.argumentCount=function(){
return this.details_.argumentCount();
};
FrameMirror.prototype.argumentName=function(a){
return this.details_.argumentName(a);
};
FrameMirror.prototype.argumentValue=function(a){
return MakeMirror(this.details_.argumentValue(a));
};
FrameMirror.prototype.localCount=function(){
return this.details_.localCount();
};
FrameMirror.prototype.localName=function(a){
return this.details_.localName(a);
};
FrameMirror.prototype.localValue=function(a){
return MakeMirror(this.details_.localValue(a));
};
FrameMirror.prototype.returnValue=function(){
return MakeMirror(this.details_.returnValue());
};
FrameMirror.prototype.sourcePosition=function(){
return this.details_.sourcePosition();
};
FrameMirror.prototype.sourceLocation=function(){
var a=this.func();
if(a.resolved()){
var b=a.script();
if(b){
return b.locationFromPosition(this.sourcePosition(),true);
}
}
};
FrameMirror.prototype.sourceLine=function(){
var a=this.sourceLocation();
if(a){
return a.line;
}
};
FrameMirror.prototype.sourceColumn=function(){
var a=this.sourceLocation();
if(a){
return a.column;
}
};
FrameMirror.prototype.sourceLineText=function(){
var a=this.sourceLocation();
if(a){
return a.sourceText();
}
};
FrameMirror.prototype.scopeCount=function(){
return this.details_.scopeCount();
};
FrameMirror.prototype.scope=function(a){
return new ScopeMirror(this,(void 0),a);
};
FrameMirror.prototype.allScopes=function(a){
var b=%GetAllScopesDetails(this.break_id_,
this.details_.frameId(),
this.details_.inlinedFrameIndex(),
!!a);
var c=[];
for(var d=0;d<b.length;++d){
c.push(new ScopeMirror(this,(void 0),d,b[d]));
}
return c;
};
FrameMirror.prototype.stepInPositions=function(){
var a=this.func().script();
var b=this.func().sourcePosition_();
var c=this.details_.stepInPositionsImpl();
var d=[];
if(c){
for(var e=0;e<c.length;e++){
var g={};
var h=a.locationFromPosition(b+c[e],
true);
serializeLocationFields(h,g);
var i={
position:g
};
d.push(i);
}
}
return d;
};
FrameMirror.prototype.evaluate=function(source,disable_break,
opt_context_object){
return MakeMirror(%DebugEvaluate(this.break_id_,
this.details_.frameId(),
this.details_.inlinedFrameIndex(),
source,
Boolean(disable_break),
opt_context_object));
};
FrameMirror.prototype.invocationText=function(){
var a='';
var b=this.func();
var c=this.receiver();
if(this.isConstructCall()){
a+='new ';
a+=b.name()?b.name():'[anonymous]';
}else if(this.isDebuggerFrame()){
a+='[debugger]';
}else{
var d=
!c.className||(c.className()!='global');
if(d){
a+=c.toText();
}
var e=GetUndefinedMirror();
if(c.isObject()){
for(var g=c;
!g.isNull()&&e.isUndefined();
g=g.protoObject()){
e=g.lookupProperty(b);
}
}
if(!e.isUndefined()){
if(!e.isIndexed()){
if(d){
a+='.';
}
a+=e.name();
}else{
a+='[';
a+=e.name();
a+=']';
}
if(b.name()&&b.name()!=e.name()){
a+='(aka '+b.name()+')';
}
}else{
if(d){
a+='.';
}
a+=b.name()?b.name():'[anonymous]';
}
}
if(!this.isDebuggerFrame()){
a+='(';
for(var h=0;h<this.argumentCount();h++){
if(h!=0)a+=', ';
if(this.argumentName(h)){
a+=this.argumentName(h);
a+='=';
}
a+=this.argumentValue(h).toText();
}
a+=')';
}
if(this.isAtReturn()){
a+=' returning ';
a+=this.returnValue().toText();
}
return a;
};
FrameMirror.prototype.sourceAndPositionText=function(){
var a='';
var b=this.func();
if(b.resolved()){
var c=b.script();
if(c){
if(c.name()){
a+=c.name();
}else{
a+='[unnamed]';
}
if(!this.isDebuggerFrame()){
var d=this.sourceLocation();
a+=' line ';
a+=!(d===(void 0))?(d.line+1):'?';
a+=' column ';
a+=!(d===(void 0))?(d.column+1):'?';
if(!(this.sourcePosition()===(void 0))){
a+=' (position '+(this.sourcePosition()+1)+')';
}
}
}else{
a+='[no source]';
}
}else{
a+='[unresolved]';
}
return a;
};
FrameMirror.prototype.localsText=function(){
var a='';
var b=this.localCount();
if(b>0){
for(var c=0;c<b;++c){
a+='      var ';
a+=this.localName(c);
a+=' = ';
a+=this.localValue(c).toText();
if(c<b-1)a+='\n';
}
}
return a;
};
FrameMirror.prototype.restart=function(){
var a=%LiveEditRestartFrame(this.break_id_,this.index_);
if((a===(void 0))){
a="Failed to find requested frame";
}
return a;
};
FrameMirror.prototype.toText=function(a){
var b='';
b+='#'+(this.index()<=9?'0':'')+this.index();
b+=' ';
b+=this.invocationText();
b+=' ';
b+=this.sourceAndPositionText();
if(a){
b+='\n';
b+=this.localsText();
}
return b;
};
var kScopeDetailsTypeIndex=0;
var kScopeDetailsObjectIndex=1;
function ScopeDetails(a,b,c,d){
if(a){
this.break_id_=a.break_id_;
this.details_=d||
%GetScopeDetails(a.break_id_,
a.details_.frameId(),
a.details_.inlinedFrameIndex(),
c);
this.frame_id_=a.details_.frameId();
this.inlined_frame_id_=a.details_.inlinedFrameIndex();
}else{
this.details_=d||%GetFunctionScopeDetails(b.value(),c);
this.fun_value_=b.value();
this.break_id_=undefined;
}
this.index_=c;
}
ScopeDetails.prototype.type=function(){
if(!(this.break_id_===(void 0))){
%CheckExecutionState(this.break_id_);
}
return this.details_[kScopeDetailsTypeIndex];
};
ScopeDetails.prototype.object=function(){
if(!(this.break_id_===(void 0))){
%CheckExecutionState(this.break_id_);
}
return this.details_[kScopeDetailsObjectIndex];
};
ScopeDetails.prototype.setVariableValueImpl=function(a,b){
var c;
if(!(this.break_id_===(void 0))){
%CheckExecutionState(this.break_id_);
c=%SetScopeVariableValue(this.break_id_,this.frame_id_,
this.inlined_frame_id_,this.index_,a,b);
}else{
c=%SetScopeVariableValue(this.fun_value_,null,null,this.index_,
a,b);
}
if(!c){
throw new Error("Failed to set variable value");
}
};
function ScopeMirror(a,b,c,d){
%_CallFunction(this,SCOPE_TYPE,Mirror);
if(a){
this.frame_index_=a.index_;
}else{
this.frame_index_=undefined;
}
this.scope_index_=c;
this.details_=new ScopeDetails(a,b,c,d);
}
inherits(ScopeMirror,Mirror);
ScopeMirror.prototype.details=function(){
return this.details_;
};
ScopeMirror.prototype.frameIndex=function(){
return this.frame_index_;
};
ScopeMirror.prototype.scopeIndex=function(){
return this.scope_index_;
};
ScopeMirror.prototype.scopeType=function(){
return this.details_.type();
};
ScopeMirror.prototype.scopeObject=function(){
var a=this.scopeType()==ScopeType.Local||
this.scopeType()==ScopeType.Closure||
this.scopeType()==ScopeType.Script;
return MakeMirror(this.details_.object(),a);
};
ScopeMirror.prototype.setVariableValue=function(a,b){
this.details_.setVariableValueImpl(a,b);
};
function ScriptMirror(a){
%_CallFunction(this,SCRIPT_TYPE,Mirror);
this.script_=a;
this.context_=new ContextMirror(a.context_data);
this.allocateHandle_();
}
inherits(ScriptMirror,Mirror);
ScriptMirror.prototype.value=function(){
return this.script_;
};
ScriptMirror.prototype.name=function(){
return this.script_.name||this.script_.nameOrSourceURL();
};
ScriptMirror.prototype.id=function(){
return this.script_.id;
};
ScriptMirror.prototype.source=function(){
return this.script_.source;
};
ScriptMirror.prototype.setSource=function(a){
%DebugSetScriptSource(this.script_,a);
};
ScriptMirror.prototype.lineOffset=function(){
return this.script_.line_offset;
};
ScriptMirror.prototype.columnOffset=function(){
return this.script_.column_offset;
};
ScriptMirror.prototype.data=function(){
return this.script_.data;
};
ScriptMirror.prototype.scriptType=function(){
return this.script_.type;
};
ScriptMirror.prototype.compilationType=function(){
return this.script_.compilation_type;
};
ScriptMirror.prototype.lineCount=function(){
return this.script_.lineCount();
};
ScriptMirror.prototype.locationFromPosition=function(
position,include_resource_offset){
return this.script_.locationFromPosition(position,include_resource_offset);
};
ScriptMirror.prototype.sourceSlice=function(a,b){
return this.script_.sourceSlice(a,b);
};
ScriptMirror.prototype.context=function(){
return this.context_;
};
ScriptMirror.prototype.evalFromScript=function(){
return MakeMirror(this.script_.eval_from_script);
};
ScriptMirror.prototype.evalFromFunctionName=function(){
return MakeMirror(this.script_.eval_from_function_name);
};
ScriptMirror.prototype.evalFromLocation=function(){
var a=this.evalFromScript();
if(!a.isUndefined()){
var b=this.script_.eval_from_script_position;
return a.locationFromPosition(b,true);
}
};
ScriptMirror.prototype.toText=function(){
var a='';
a+=this.name();
a+=' (lines: ';
if(this.lineOffset()>0){
a+=this.lineOffset();
a+='-';
a+=this.lineOffset()+this.lineCount()-1;
}else{
a+=this.lineCount();
}
a+=')';
return a;
};
function ContextMirror(a){
%_CallFunction(this,CONTEXT_TYPE,Mirror);
this.data_=a;
this.allocateHandle_();
}
inherits(ContextMirror,Mirror);
ContextMirror.prototype.data=function(){
return this.data_;
};
function MakeMirrorSerializer(a,b){
return new JSONProtocolSerializer(a,b);
}
function JSONProtocolSerializer(a,b){
this.details_=a;
this.options_=b;
this.mirrors_=[];
}
JSONProtocolSerializer.prototype.serializeReference=function(a){
return this.serialize_(a,true,true);
};
JSONProtocolSerializer.prototype.serializeValue=function(a){
var b=this.serialize_(a,false,true);
return b;
};
JSONProtocolSerializer.prototype.serializeReferencedObjects=function(){
var a=[];
var b=this.mirrors_.length;
for(var c=0;c<b;c++){
a.push(this.serialize_(this.mirrors_[c],false,false));
}
return a;
};
JSONProtocolSerializer.prototype.includeSource_=function(){
return this.options_&&this.options_.includeSource;
};
JSONProtocolSerializer.prototype.inlineRefs_=function(){
return this.options_&&this.options_.inlineRefs;
};
JSONProtocolSerializer.prototype.maxStringLength_=function(){
if((this.options_===(void 0))||
(this.options_.maxStringLength===(void 0))){
return kMaxProtocolStringLength;
}
return this.options_.maxStringLength;
};
JSONProtocolSerializer.prototype.add_=function(a){
for(var b=0;b<this.mirrors_.length;b++){
if(this.mirrors_[b]===a){
return;
}
}
this.mirrors_.push(a);
};
JSONProtocolSerializer.prototype.serializeReferenceWithDisplayData_=
function(a){
var b={};
b.ref=a.handle();
b.type=a.type();
switch(a.type()){
case UNDEFINED_TYPE:
case NULL_TYPE:
case BOOLEAN_TYPE:
case NUMBER_TYPE:
b.value=a.value();
break;
case STRING_TYPE:
b.value=a.getTruncatedValue(this.maxStringLength_());
break;
case SYMBOL_TYPE:
b.description=a.description();
break;
case FUNCTION_TYPE:
b.name=a.name();
b.inferredName=a.inferredName();
if(a.script()){
b.scriptId=a.script().id();
}
break;
case ERROR_TYPE:
case REGEXP_TYPE:
b.value=a.toText();
break;
case OBJECT_TYPE:
b.className=a.className();
break;
}
return b;
};
JSONProtocolSerializer.prototype.serialize_=function(mirror,reference,
details){
if(reference&&
(mirror.isValue()||mirror.isScript()||mirror.isContext())){
if(this.inlineRefs_()&&mirror.isValue()){
return this.serializeReferenceWithDisplayData_(mirror);
}else{
this.add_(mirror);
return{'ref':mirror.handle()};
}
}
var a={};
if(mirror.isValue()||mirror.isScript()||mirror.isContext()){
a.handle=mirror.handle();
}
a.type=mirror.type();
switch(mirror.type()){
case UNDEFINED_TYPE:
case NULL_TYPE:
break;
case BOOLEAN_TYPE:
a.value=mirror.value();
break;
case NUMBER_TYPE:
a.value=NumberToJSON_(mirror.value());
break;
case STRING_TYPE:
if(this.maxStringLength_()!=-1&&
mirror.length()>this.maxStringLength_()){
var b=mirror.getTruncatedValue(this.maxStringLength_());
a.value=b;
a.fromIndex=0;
a.toIndex=this.maxStringLength_();
}else{
a.value=mirror.value();
}
a.length=mirror.length();
break;
case SYMBOL_TYPE:
a.description=mirror.description();
break;
case OBJECT_TYPE:
case FUNCTION_TYPE:
case ERROR_TYPE:
case REGEXP_TYPE:
case PROMISE_TYPE:
case GENERATOR_TYPE:
this.serializeObject_(mirror,a,details);
break;
case PROPERTY_TYPE:
case INTERNAL_PROPERTY_TYPE:
throw new Error('PropertyMirror cannot be serialized independently');
break;
case FRAME_TYPE:
this.serializeFrame_(mirror,a);
break;
case SCOPE_TYPE:
this.serializeScope_(mirror,a);
break;
case SCRIPT_TYPE:
if(mirror.name()){
a.name=mirror.name();
}
a.id=mirror.id();
a.lineOffset=mirror.lineOffset();
a.columnOffset=mirror.columnOffset();
a.lineCount=mirror.lineCount();
if(mirror.data()){
a.data=mirror.data();
}
if(this.includeSource_()){
a.source=mirror.source();
}else{
var c=mirror.source().substring(0,80);
a.sourceStart=c;
}
a.sourceLength=mirror.source().length;
a.scriptType=mirror.scriptType();
a.compilationType=mirror.compilationType();
if(mirror.compilationType()==1&&
mirror.evalFromScript()){
a.evalFromScript=
this.serializeReference(mirror.evalFromScript());
var d=mirror.evalFromLocation();
if(d){
a.evalFromLocation={line:d.line,
column:d.column};
}
if(mirror.evalFromFunctionName()){
a.evalFromFunctionName=mirror.evalFromFunctionName();
}
}
if(mirror.context()){
a.context=this.serializeReference(mirror.context());
}
break;
case CONTEXT_TYPE:
a.data=mirror.data();
break;
}
a.text=mirror.toText();
return a;
};
JSONProtocolSerializer.prototype.serializeObject_=function(mirror,content,
details){
content.className=mirror.className();
content.constructorFunction=
this.serializeReference(mirror.constructorFunction());
content.protoObject=this.serializeReference(mirror.protoObject());
content.prototypeObject=this.serializeReference(mirror.prototypeObject());
if(mirror.hasNamedInterceptor()){
content.namedInterceptor=true;
}
if(mirror.hasIndexedInterceptor()){
content.indexedInterceptor=true;
}
if(mirror.isFunction()){
content.name=mirror.name();
if(!(mirror.inferredName()===(void 0))){
content.inferredName=mirror.inferredName();
}
content.resolved=mirror.resolved();
if(mirror.resolved()){
content.source=mirror.source();
}
if(mirror.script()){
content.script=this.serializeReference(mirror.script());
content.scriptId=mirror.script().id();
serializeLocationFields(mirror.sourceLocation(),content);
}
content.scopes=[];
for(var a=0;a<mirror.scopeCount();a++){
var b=mirror.scope(a);
content.scopes.push({
type:b.scopeType(),
index:a
});
}
}
if(mirror.isGenerator()){
content.status=mirror.status();
content.func=this.serializeReference(mirror.func())
content.receiver=this.serializeReference(mirror.receiver())
serializeLocationFields(mirror.sourceLocation(),content);
}
if(mirror.isDate()){
content.value=mirror.value();
}
if(mirror.isPromise()){
content.status=mirror.status();
content.promiseValue=this.serializeReference(mirror.promiseValue());
}
var c=mirror.propertyNames(PropertyKind.Named);
var d=mirror.propertyNames(PropertyKind.Indexed);
var e=new Array(c.length+d.length);
for(var a=0;a<c.length;a++){
var g=mirror.property(c[a]);
e[a]=this.serializeProperty_(g);
if(details){
this.add_(g.value());
}
}
for(var a=0;a<d.length;a++){
var g=mirror.property(d[a]);
e[c.length+a]=this.serializeProperty_(g);
if(details){
this.add_(g.value());
}
}
content.properties=e;
var h=mirror.internalProperties();
if(h.length>0){
var i=[];
for(var a=0;a<h.length;a++){
i.push(this.serializeInternalProperty_(h[a]));
}
content.internalProperties=i;
}
};
function serializeLocationFields(a,b){
if(!a){
return;
}
b.position=a.position;
var c=a.line;
if(!(c===(void 0))){
b.line=c;
}
var d=a.column;
if(!(d===(void 0))){
b.column=d;
}
}
JSONProtocolSerializer.prototype.serializeProperty_=function(a){
var b={};
b.name=a.name();
var c=a.value();
if(this.inlineRefs_()&&c.isValue()){
b.value=this.serializeReferenceWithDisplayData_(c);
}else{
if(a.attributes()!=PropertyAttribute.None){
b.attributes=a.attributes();
}
b.propertyType=a.propertyType();
b.ref=c.handle();
}
return b;
};
JSONProtocolSerializer.prototype.serializeInternalProperty_=
function(a){
var b={};
b.name=a.name();
var c=a.value();
if(this.inlineRefs_()&&c.isValue()){
b.value=this.serializeReferenceWithDisplayData_(c);
}else{
b.ref=c.handle();
}
return b;
};
JSONProtocolSerializer.prototype.serializeFrame_=function(a,b){
b.index=a.index();
b.receiver=this.serializeReference(a.receiver());
var c=a.func();
b.func=this.serializeReference(c);
var d=c.script();
if(d){
b.script=this.serializeReference(d);
}
b.constructCall=a.isConstructCall();
b.atReturn=a.isAtReturn();
if(a.isAtReturn()){
b.returnValue=this.serializeReference(a.returnValue());
}
b.debuggerFrame=a.isDebuggerFrame();
var e=new Array(a.argumentCount());
for(var g=0;g<a.argumentCount();g++){
var h={};
var i=a.argumentName(g);
if(i){
h.name=i;
}
h.value=this.serializeReference(a.argumentValue(g));
e[g]=h;
}
b.arguments=e;
var e=new Array(a.localCount());
for(var g=0;g<a.localCount();g++){
var j={};
j.name=a.localName(g);
j.value=this.serializeReference(a.localValue(g));
e[g]=j;
}
b.locals=e;
serializeLocationFields(a.sourceLocation(),b);
var k=a.sourceLineText();
if(!(k===(void 0))){
b.sourceLineText=k;
}
b.scopes=[];
for(var g=0;g<a.scopeCount();g++){
var l=a.scope(g);
b.scopes.push({
type:l.scopeType(),
index:g
});
}
};
JSONProtocolSerializer.prototype.serializeScope_=function(a,b){
b.index=a.scopeIndex();
b.frameIndex=a.frameIndex();
b.type=a.scopeType();
b.object=this.inlineRefs_()?
this.serializeValue(a.scopeObject()):
this.serializeReference(a.scopeObject());
};
function NumberToJSON_(a){
if(isNaN(a)){
return'NaN';
}
if(!(%_IsSmi(%IS_VAR(a))||((a==a)&&(a!=1/0)&&(a!=-1/0)))){
if(a>0){
return'Infinity';
}else{
return'-Infinity';
}
}
return a;
}

 liveeditÁø
"use strict";
Debug.LiveEdit=new function(){
var a;
var b="stack_update_needs_step_in";
function ApplyPatchMultiChunk(script,diff_array,new_source,preview_only,
change_log){
var c=script.source;
var d=GatherCompileInfo(c,script);
var e=BuildCodeInfoTree(d);
var g=new PosTranslator(diff_array);
MarkChangedFunctions(e,g.GetChunks());
FindLiveSharedInfos(e,script);
var h;
try{
h=GatherCompileInfo(new_source,script);
}catch(e){
var i=
new Failure("Failed to compile new version of script: "+e);
if(e instanceof SyntaxError){
var j={
type:"liveedit_compile_error",
syntaxErrorMessage:e.message
};
CopyErrorPositionToDetails(e,j);
i.details=j;
}
throw i;
}
var k=BuildCodeInfoTree(h);
FindCorrespondingFunctions(e,k);
var l=new Array();
var m=new Array();
var n=new Array();
var o=new Array();
function HarvestTodo(p){
function CollectDamaged(q){
m.push(q);
for(var r=0;r<q.children.length;r++){
CollectDamaged(q.children[r]);
}
}
function CollectNew(t){
for(var r=0;r<t.length;r++){
n.push(t[r]);
CollectNew(t[r].children);
}
}
if(p.status==a.DAMAGED){
CollectDamaged(p);
return;
}
if(p.status==a.UNCHANGED){
o.push(p);
}else if(p.status==a.SOURCE_CHANGED){
o.push(p);
}else if(p.status==a.CHANGED){
l.push(p);
CollectNew(p.unmatched_new_nodes);
}
for(var r=0;r<p.children.length;r++){
HarvestTodo(p.children[r]);
}
}
var u={
change_tree:DescribeChangeTree(e),
textual_diff:{
old_len:c.length,
new_len:new_source.length,
chunks:diff_array
},
updated:false
};
if(preview_only){
return u;
}
HarvestTodo(e);
var v=new Array();
for(var r=0;r<l.length;r++){
var w=
l[r].live_shared_function_infos;
if(w){
for(var x=0;x<w.length;x++){
v.push(w[x]);
}
}
}
var y=
CheckStackActivations(v,change_log);
u.stack_modified=y!=0;
u[b]=
u.stack_modified;
var z=TemporaryRemoveBreakPoints(script,change_log);
var A;
if(m.length==0){
%LiveEditReplaceScript(script,new_source,null);
A=(void 0);
}else{
var B=CreateNameForOldScript(script);
A=%LiveEditReplaceScript(script,new_source,
B);
var C=new Array();
change_log.push({linked_to_old_script:C});
for(var r=0;r<m.length;r++){
LinkToOldScript(m[r],A,
C);
}
u.created_script_name=B;
}
for(var r=0;r<n.length;r++){
%LiveEditFunctionSetScript(
n[r].info.shared_function_info,script);
}
for(var r=0;r<l.length;r++){
PatchFunctionCode(l[r],change_log);
}
var D=new Array();
change_log.push({position_patched:D});
for(var r=0;r<o.length;r++){
PatchPositions(o[r],diff_array,
D);
if(o[r].live_shared_function_infos){
o[r].live_shared_function_infos.
forEach(function(E){
%LiveEditFunctionSourceUpdated(E.raw_array);
});
}
}
z(g,A);
u.updated=true;
return u;
}
this.ApplyPatchMultiChunk=ApplyPatchMultiChunk;
function GatherCompileInfo(F,G){
var H=%LiveEditGatherCompileInfo(G,F);
var I=new Array();
var J=new Array();
for(var r=0;r<H.length;r++){
var E=new FunctionCompileInfo(H[r]);
%LiveEditFunctionSetScript(E.shared_function_info,(void 0));
I.push(E);
J.push(r);
}
for(var r=0;r<I.length;r++){
var K=r;
for(var x=r+1;x<I.length;x++){
if(I[K].start_position>I[x].start_position){
K=x;
}
}
if(K!=r){
var L=I[K];
var M=J[K];
I[K]=I[r];
J[K]=J[r];
I[r]=L;
J[r]=M;
}
}
var N=0;
function ResetIndexes(O,P){
var Q=-1;
while(N<I.length&&
I[N].outer_index==P){
var R=N;
I[R].outer_index=O;
if(Q!=-1){
I[Q].next_sibling_index=R;
}
Q=R;
N++;
ResetIndexes(R,J[R]);
}
if(Q!=-1){
I[Q].next_sibling_index=-1;
}
}
ResetIndexes(-1,-1);
Assert(N==I.length);
return I;
}
function PatchFunctionCode(p,S){
var T=p.corresponding_node.info;
if(p.live_shared_function_infos){
p.live_shared_function_infos.forEach(function(U){
%LiveEditReplaceFunctionCode(T.raw_array,
U.raw_array);
for(var r=0;r<p.children.length;r++){
if(p.children[r].corresponding_node){
var V=
p.children[r].corresponding_node.info.
shared_function_info;
if(p.children[r].live_shared_function_infos){
p.children[r].live_shared_function_infos.
forEach(function(W){
%LiveEditReplaceRefToNestedFunction(
U.info,
V,
W.info);
});
}
}
}
});
S.push({function_patched:T.function_name});
}else{
S.push({function_patched:T.function_name,
function_info_not_found:true});
}
}
function LinkToOldScript(X,A,Y){
if(X.live_shared_function_infos){
X.live_shared_function_infos.
forEach(function(E){
%LiveEditFunctionSetScript(E.info,A);
});
Y.push({name:X.info.function_name});
}else{
Y.push(
{name:X.info.function_name,not_found:true});
}
}
function TemporaryRemoveBreakPoints(Z,S){
var aa=GetScriptBreakPoints(Z);
var ab=[];
S.push({break_points_update:ab});
var ac=[];
for(var r=0;r<aa.length;r++){
var ad=aa[r];
ad.clear();
var ae=Debug.findScriptSourcePosition(Z,
ad.line(),ad.column());
var af={
position:ae,
line:ad.line(),
column:ad.column()
};
ac.push(af);
}
return function(g,ag){
for(var r=0;r<aa.length;r++){
var ad=aa[r];
if(ag){
var ah=ad.cloneForOtherScript(ag);
ah.set(ag);
ab.push({
type:"copied_to_old",
id:ad.number(),
new_id:ah.number(),
positions:ac[r]
});
}
var ai=g.Translate(
ac[r].position,
PosTranslator.ShiftWithTopInsideChunkHandler);
var aj=
Z.locationFromPosition(ai,false);
ad.update_positions(aj.line,aj.column);
var ak={
position:ai,
line:aj.line,
column:aj.column
};
ad.set(Z);
ab.push({type:"position_changed",
id:ad.number(),
old_positions:ac[r],
new_positions:ak
});
}
};
}
function Assert(al,am){
if(!al){
if(am){
throw"Assert "+am;
}else{
throw"Assert";
}
}
}
function DiffChunk(an,ao,ap,aq){
this.pos1=an;
this.pos2=ao;
this.len1=ap;
this.len2=aq;
}
function PosTranslator(ar){
var as=new Array();
var at=0;
for(var r=0;r<ar.length;r+=3){
var au=ar[r];
var av=au+at;
var aw=ar[r+1];
var ax=ar[r+2];
as.push(new DiffChunk(au,av,aw-au,
ax-av));
at=ax-aw;
}
this.chunks=as;
}
PosTranslator.prototype.GetChunks=function(){
return this.chunks;
};
PosTranslator.prototype.Translate=function(ay,az){
var aA=this.chunks;
if(aA.length==0||ay<aA[0].pos1){
return ay;
}
var aB=0;
var aC=aA.length-1;
while(aB<aC){
var aD=Math.floor((aB+aC)/2);
if(ay<aA[aD+1].pos1){
aC=aD;
}else{
aB=aD+1;
}
}
var aE=aA[aB];
if(ay>=aE.pos1+aE.len1){
return ay+aE.pos2+aE.len2-aE.pos1-aE.len1;
}
if(!az){
az=PosTranslator.DefaultInsideChunkHandler;
}
return az(ay,aE);
};
PosTranslator.DefaultInsideChunkHandler=function(ay,aF){
Assert(false,"Cannot translate position in changed area");
};
PosTranslator.ShiftWithTopInsideChunkHandler=
function(ay,aF){
return ay-aF.pos1+aF.pos2;
};
var a={
UNCHANGED:"unchanged",
SOURCE_CHANGED:"source changed",
CHANGED:"changed",
DAMAGED:"damaged"
};
function CodeInfoTreeNode(aG,aH,aI){
this.info=aG;
this.children=aH;
this.array_index=aI;
this.parent=(void 0);
this.status=a.UNCHANGED;
this.status_explanation=(void 0);
this.new_start_pos=(void 0);
this.new_end_pos=(void 0);
this.corresponding_node=(void 0);
this.unmatched_new_nodes=(void 0);
this.textual_corresponding_node=(void 0);
this.textually_unmatched_new_nodes=(void 0);
this.live_shared_function_infos=(void 0);
}
function BuildCodeInfoTree(aJ){
var aK=0;
function BuildNode(){
var aL=aK;
aK++;
var aM=new Array();
while(aK<aJ.length&&
aJ[aK].outer_index==aL){
aM.push(BuildNode());
}
var q=new CodeInfoTreeNode(aJ[aL],aM,
aL);
for(var r=0;r<aM.length;r++){
aM[r].parent=q;
}
return q;
}
var aN=BuildNode();
Assert(aK==aJ.length);
return aN;
}
function MarkChangedFunctions(aO,as){
var aP=new function(){
var aQ=0;
var aR=0;
this.current=function(){return as[aQ];};
this.next=function(){
var aE=as[aQ];
aR=aE.pos2+aE.len2-(aE.pos1+aE.len1);
aQ++;
};
this.done=function(){return aQ>=as.length;};
this.TranslatePos=function(ay){return ay+aR;};
};
function ProcessInternals(aS){
aS.new_start_pos=aP.TranslatePos(
aS.info.start_position);
var aT=0;
var aU=false;
var aV=false;
while(!aP.done()&&
aP.current().pos1<aS.info.end_position){
if(aT<aS.children.length){
var aW=aS.children[aT];
if(aW.info.end_position<=aP.current().pos1){
ProcessUnchangedChild(aW);
aT++;
continue;
}else if(aW.info.start_position>=
aP.current().pos1+aP.current().len1){
aU=true;
aP.next();
continue;
}else if(aW.info.start_position<=aP.current().pos1&&
aW.info.end_position>=aP.current().pos1+
aP.current().len1){
ProcessInternals(aW);
aV=aV||
(aW.status!=a.UNCHANGED);
aU=aU||
(aW.status==a.DAMAGED);
aT++;
continue;
}else{
aU=true;
aW.status=a.DAMAGED;
aW.status_explanation=
"Text diff overlaps with function boundary";
aT++;
continue;
}
}else{
if(aP.current().pos1+aP.current().len1<=
aS.info.end_position){
aS.status=a.CHANGED;
aP.next();
continue;
}else{
aS.status=a.DAMAGED;
aS.status_explanation=
"Text diff overlaps with function boundary";
return;
}
}
Assert("Unreachable",false);
}
while(aT<aS.children.length){
var aW=aS.children[aT];
ProcessUnchangedChild(aW);
aT++;
}
if(aU){
aS.status=a.CHANGED;
}else if(aV){
aS.status=a.SOURCE_CHANGED;
}
aS.new_end_pos=
aP.TranslatePos(aS.info.end_position);
}
function ProcessUnchangedChild(q){
q.new_start_pos=aP.TranslatePos(q.info.start_position);
q.new_end_pos=aP.TranslatePos(q.info.end_position);
}
ProcessInternals(aO);
}
function FindCorrespondingFunctions(aX,aY){
function ProcessNode(p,aZ){
var ba=
IsFunctionContextLocalsChanged(p.info,aZ.info);
if(ba){
p.status=a.CHANGED;
}
var bb=p.children;
var bc=aZ.children;
var bd=[];
var be=[];
var bf=0;
var bg=0;
while(bf<bb.length){
if(bb[bf].status==a.DAMAGED){
bf++;
}else if(bg<bc.length){
if(bc[bg].info.start_position<
bb[bf].new_start_pos){
bd.push(bc[bg]);
be.push(bc[bg]);
bg++;
}else if(bc[bg].info.start_position==
bb[bf].new_start_pos){
if(bc[bg].info.end_position==
bb[bf].new_end_pos){
bb[bf].corresponding_node=
bc[bg];
bb[bf].textual_corresponding_node=
bc[bg];
if(ba){
bb[bf].status=a.DAMAGED;
bb[bf].status_explanation=
"Enclosing function is now incompatible. "+
ba;
bb[bf].corresponding_node=(void 0);
}else if(bb[bf].status!=
a.UNCHANGED){
ProcessNode(bb[bf],
bc[bg]);
if(bb[bf].status==a.DAMAGED){
bd.push(
bb[bf].corresponding_node);
bb[bf].corresponding_node=(void 0);
p.status=a.CHANGED;
}
}
}else{
bb[bf].status=a.DAMAGED;
bb[bf].status_explanation=
"No corresponding function in new script found";
p.status=a.CHANGED;
bd.push(bc[bg]);
be.push(bc[bg]);
}
bg++;
bf++;
}else{
bb[bf].status=a.DAMAGED;
bb[bf].status_explanation=
"No corresponding function in new script found";
p.status=a.CHANGED;
bf++;
}
}else{
bb[bf].status=a.DAMAGED;
bb[bf].status_explanation=
"No corresponding function in new script found";
p.status=a.CHANGED;
bf++;
}
}
while(bg<bc.length){
bd.push(bc[bg]);
be.push(bc[bg]);
bg++;
}
if(p.status==a.CHANGED){
if(p.info.param_num!=aZ.info.param_num){
p.status=a.DAMAGED;
p.status_explanation="Changed parameter number: "+
p.info.param_num+" and "+aZ.info.param_num;
}
}
p.unmatched_new_nodes=bd;
p.textually_unmatched_new_nodes=
be;
}
ProcessNode(aX,aY);
aX.corresponding_node=aY;
aX.textual_corresponding_node=aY;
Assert(aX.status!=a.DAMAGED,
"Script became damaged");
}
function FindLiveSharedInfos(aX,G){
var bh=%LiveEditFindSharedFunctionInfosForScript(G);
var bi=new Array();
for(var r=0;r<bh.length;r++){
bi.push(new SharedInfoWrapper(bh[r]));
}
function FindFunctionInfos(I){
var bj=[];
for(var r=0;r<bi.length;r++){
var bk=bi[r];
if(bk.start_position==I.start_position&&
bk.end_position==I.end_position){
bj.push(bk);
}
}
if(bj.length>0){
return bj;
}
}
function TraverseTree(q){
q.live_shared_function_infos=FindFunctionInfos(q.info);
for(var r=0;r<q.children.length;r++){
TraverseTree(q.children[r]);
}
}
TraverseTree(aX);
}
function FunctionCompileInfo(bl){
this.function_name=bl[0];
this.start_position=bl[1];
this.end_position=bl[2];
this.param_num=bl[3];
this.code=bl[4];
this.code_scope_info=bl[5];
this.scope_info=bl[6];
this.outer_index=bl[7];
this.shared_function_info=bl[8];
this.next_sibling_index=null;
this.raw_array=bl;
}
function SharedInfoWrapper(bl){
this.function_name=bl[0];
this.start_position=bl[1];
this.end_position=bl[2];
this.info=bl[3];
this.raw_array=bl;
}
function PatchPositions(X,ar,Y){
if(X.live_shared_function_infos){
X.live_shared_function_infos.forEach(function(E){
%LiveEditPatchFunctionPositions(E.raw_array,
ar);
});
Y.push({name:X.info.function_name});
}else{
Y.push(
{name:X.info.function_name,info_not_found:true});
}
}
function CreateNameForOldScript(G){
return G.name+" (old)";
}
function IsFunctionContextLocalsChanged(bm,bn){
var bo=bm.scope_info;
var bp=bn.scope_info;
var bq;
var br;
if(bo){
bq=bo.toString();
}else{
bq="";
}
if(bp){
br=bp.toString();
}else{
br="";
}
if(bq!=br){
return"Variable map changed: ["+bq+
"] => ["+br+"]";
}
return;
}
var bs;
function CheckStackActivations(bt,S){
var bu=new Array();
for(var r=0;r<bt.length;r++){
bu[r]=bt[r].info;
}
var bv=%LiveEditCheckAndDropActivations(bu,true);
if(bv[bu.length]){
throw new Failure(bv[bu.length]);
}
var bw=new Array();
var bx=new Array();
for(var r=0;r<bu.length;r++){
var by=bt[r];
if(bv[r]==bs.REPLACED_ON_ACTIVE_STACK){
bx.push({name:by.function_name});
}else if(bv[r]!=bs.AVAILABLE_FOR_PATCH){
var bz={
name:by.function_name,
start_pos:by.start_position,
end_pos:by.end_position,
replace_problem:
bs.SymbolName(bv[r])
};
bw.push(bz);
}
}
if(bx.length>0){
S.push({dropped_from_stack:bx});
}
if(bw.length>0){
S.push({functions_on_stack:bw});
throw new Failure("Blocked by functions on stack");
}
return bx.length;
}
var bs={
AVAILABLE_FOR_PATCH:1,
BLOCKED_ON_ACTIVE_STACK:2,
BLOCKED_ON_OTHER_STACK:3,
BLOCKED_UNDER_NATIVE_CODE:4,
REPLACED_ON_ACTIVE_STACK:5,
BLOCKED_UNDER_GENERATOR:6,
BLOCKED_ACTIVE_GENERATOR:7
};
bs.SymbolName=function(bA){
var bB=bs;
for(var bC in bB){
if(bB[bC]==bA){
return bC;
}
}
};
function Failure(am){
this.message=am;
}
this.Failure=Failure;
Failure.prototype.toString=function(){
return"LiveEdit Failure: "+this.message;
};
function CopyErrorPositionToDetails(bD,j){
function createPositionStruct(G,bE){
if(bE==-1)return;
var bF=G.locationFromPosition(bE,true);
if(bF==null)return;
return{
line:bF.line+1,
column:bF.column+1,
position:bE
};
}
if(!("scriptObject"in bD)||!("startPosition"in bD)){
return;
}
var G=bD.scriptObject;
var bG={
start:createPositionStruct(G,bD.startPosition),
end:createPositionStruct(G,bD.endPosition)
};
j.position=bG;
}
function GetPcFromSourcePos(bH,bI){
return %GetFunctionCodePositionFromSource(bH,bI);
}
this.GetPcFromSourcePos=GetPcFromSourcePos;
function SetScriptSource(G,bJ,bK,S){
var c=G.source;
var bL=CompareStrings(c,bJ);
return ApplyPatchMultiChunk(G,bL,bJ,bK,
S);
}
this.SetScriptSource=SetScriptSource;
function CompareStrings(bM,bN){
return %LiveEditCompareStrings(bM,bN);
}
function ApplySingleChunkPatch(G,change_pos,change_len,new_str,
S){
var c=G.source;
var bJ=c.substring(0,change_pos)+
new_str+c.substring(change_pos+change_len);
return ApplyPatchMultiChunk(G,
[change_pos,change_pos+change_len,change_pos+new_str.length],
bJ,false,S);
}
function DescribeChangeTree(aX){
function ProcessOldNode(q){
var bO=[];
for(var r=0;r<q.children.length;r++){
var aW=q.children[r];
if(aW.status!=a.UNCHANGED){
bO.push(ProcessOldNode(aW));
}
}
var bP=[];
if(q.textually_unmatched_new_nodes){
for(var r=0;r<q.textually_unmatched_new_nodes.length;r++){
var aW=q.textually_unmatched_new_nodes[r];
bP.push(ProcessNewNode(aW));
}
}
var bQ={
name:q.info.function_name,
positions:DescribePositions(q),
status:q.status,
children:bO,
new_children:bP
};
if(q.status_explanation){
bQ.status_explanation=q.status_explanation;
}
if(q.textual_corresponding_node){
bQ.new_positions=DescribePositions(q.textual_corresponding_node);
}
return bQ;
}
function ProcessNewNode(q){
var bO=[];
if(false){
for(var r=0;r<q.children.length;r++){
bO.push(ProcessNewNode(q.children[r]));
}
}
var bQ={
name:q.info.function_name,
positions:DescribePositions(q),
children:bO,
};
return bQ;
}
function DescribePositions(q){
return{
start_position:q.info.start_position,
end_position:q.info.end_position
};
}
return ProcessOldNode(aX);
}
function RestartFrame(bR){
var bv=bR.restart();
if((typeof(bv)==='string')){
throw new Failure("Failed to restart frame: "+bv);
}
var bv={};
bv[b]=true;
return bv;
}
this.RestartFrame=RestartFrame;
this.TestApi={
PosTranslator:PosTranslator,
CompareStrings:CompareStrings,
ApplySingleChunkPatch:ApplySingleChunkPatch
};
};

`runtime6
var EQUALS;
var STRICT_EQUALS;
var COMPARE;
var ADD;
var ADD_STRONG;
var STRING_ADD_LEFT;
var STRING_ADD_LEFT_STRONG;
var STRING_ADD_RIGHT;
var STRING_ADD_RIGHT_STRONG;
var SUB;
var SUB_STRONG;
var MUL;
var MUL_STRONG;
var DIV;
var DIV_STRONG;
var MOD;
var MOD_STRONG;
var BIT_OR;
var BIT_OR_STRONG;
var BIT_AND;
var BIT_AND_STRONG;
var BIT_XOR;
var BIT_XOR_STRONG;
var SHL;
var SHL_STRONG;
var SAR;
var SAR_STRONG;
var SHR;
var SHR_STRONG;
var DELETE;
var IN;
var INSTANCE_OF;
var FILTER_KEY;
var CALL_NON_FUNCTION;
var CALL_NON_FUNCTION_AS_CONSTRUCTOR;
var CALL_FUNCTION_PROXY;
var CALL_FUNCTION_PROXY_AS_CONSTRUCTOR;
var APPLY_PREPARE;
var REFLECT_APPLY_PREPARE;
var REFLECT_CONSTRUCT_PREPARE;
var STACK_OVERFLOW;
var TO_OBJECT;
var TO_NUMBER;
var TO_STRING;
var TO_NAME;
var STRING_LENGTH_STUB;
var $defaultNumber;
var $defaultString;
var $NaN;
var $nonNumberToNumber;
var $nonStringToString;
var $sameValue;
var $sameValueZero;
var $toBoolean;
var $toInt32;
var $toInteger;
var $toLength;
var $toName;
var $toNumber;
var $toObject;
var $toPositiveInteger;
var $toPrimitive;
var $toString;
var $toUint32;
(function(a,b,c){
%CheckIsBootstrapping();
var d=a.Array;
var e=a.Boolean;
var g=a.String;
var h=a.Number;
EQUALS=function EQUALS(i){
if((typeof(this)==='string')&&(typeof(i)==='string'))return %StringEquals(this,i);
var j=this;
while(true){
if((typeof(j)==='number')){
while(true){
if((typeof(i)==='number'))return %NumberEquals(j,i);
if((i==null))return 1;
if((typeof(i)==='symbol'))return 1;
if(!(%_IsSpecObject(i))){
return %NumberEquals(j,%$toNumber(i));
}
i=%$toPrimitive(i,0);
}
}else if((typeof(j)==='string')){
while(true){
if((typeof(i)==='string'))return %StringEquals(j,i);
if((typeof(i)==='symbol'))return 1;
if((typeof(i)==='number'))return %NumberEquals(%$toNumber(j),i);
if((typeof(i)==='boolean'))return %NumberEquals(%$toNumber(j),%$toNumber(i));
if((i==null))return 1;
i=%$toPrimitive(i,0);
}
}else if((typeof(j)==='symbol')){
if((typeof(i)==='symbol'))return %_ObjectEquals(j,i)?0:1;
return 1;
}else if((typeof(j)==='boolean')){
if((typeof(i)==='boolean'))return %_ObjectEquals(j,i)?0:1;
if((i==null))return 1;
if((typeof(i)==='number'))return %NumberEquals(%$toNumber(j),i);
if((typeof(i)==='string'))return %NumberEquals(%$toNumber(j),%$toNumber(i));
if((typeof(i)==='symbol'))return 1;
j=%$toNumber(j);
i=%$toPrimitive(i,0);
}else if((j==null)){
return(i==null)?0:1;
}else{
if((%_IsSpecObject(i))){
return %_ObjectEquals(j,i)?0:1;
}
if((i==null))return 1;
if((typeof(i)==='symbol'))return 1;
if((typeof(i)==='boolean'))i=%$toNumber(i);
j=%$toPrimitive(j,0);
}
}
}
STRICT_EQUALS=function STRICT_EQUALS(j){
if((typeof(this)==='string')){
if(!(typeof(j)==='string'))return 1;
return %StringEquals(this,j);
}
if((typeof(this)==='number')){
if(!(typeof(j)==='number'))return 1;
return %NumberEquals(this,j);
}
return %_ObjectEquals(this,j)?0:1;
}
COMPARE=function COMPARE(j,k){
var l;
var m;
if((typeof(this)==='string')){
if((typeof(j)==='string'))return %_StringCompare(this,j);
if((j===(void 0)))return k;
l=this;
}else if((typeof(this)==='number')){
if((typeof(j)==='number'))return %NumberCompare(this,j,k);
if((j===(void 0)))return k;
l=this;
}else if((this===(void 0))){
if(!(j===(void 0))){
%$toPrimitive(j,1);
}
return k;
}else if((j===(void 0))){
%$toPrimitive(this,1);
return k;
}else{
l=%$toPrimitive(this,1);
}
m=%$toPrimitive(j,1);
if((typeof(l)==='string')&&(typeof(m)==='string')){
return %_StringCompare(l,m);
}else{
var n=%$toNumber(l);
var o=%$toNumber(m);
if((!%_IsSmi(%IS_VAR(n))&&!(n==n))||(!%_IsSmi(%IS_VAR(o))&&!(o==o)))return k;
return %NumberCompare(n,o,k);
}
}
ADD=function ADD(j){
if((typeof(this)==='number')&&(typeof(j)==='number'))return %NumberAdd(this,j);
if((typeof(this)==='string')&&(typeof(j)==='string'))return %_StringAdd(this,j);
var p=%$toPrimitive(this,0);
var q=%$toPrimitive(j,0);
if((typeof(p)==='string')){
return %_StringAdd(p,%$toString(q));
}else if((typeof(q)==='string')){
return %_StringAdd(%$nonStringToString(p),q);
}else{
return %NumberAdd(%$toNumber(p),%$toNumber(q));
}
}
ADD_STRONG=function ADD_STRONG(j){
if((typeof(this)==='number')&&(typeof(j)==='number'))return %NumberAdd(this,j);
if((typeof(this)==='string')&&(typeof(j)==='string'))return %_StringAdd(this,j);
throw %MakeTypeError('strong_implicit_cast');
}
STRING_ADD_LEFT=function STRING_ADD_LEFT(i){
if(!(typeof(i)==='string')){
if((%_ClassOf(i)==='String')&&%_IsStringWrapperSafeForDefaultValueOf(i)){
i=%_ValueOf(i);
}else{
i=(typeof(i)==='number')
?%_NumberToString(i)
:%$toString(%$toPrimitive(i,0));
}
}
return %_StringAdd(this,i);
}
STRING_ADD_LEFT_STRONG=function STRING_ADD_LEFT_STRONG(i){
if((typeof(i)==='string')){
return %_StringAdd(this,i);
}
throw %MakeTypeError('strong_implicit_cast');
}
STRING_ADD_RIGHT=function STRING_ADD_RIGHT(i){
var j=this;
if(!(typeof(j)==='string')){
if((%_ClassOf(j)==='String')&&%_IsStringWrapperSafeForDefaultValueOf(j)){
j=%_ValueOf(j);
}else{
j=(typeof(j)==='number')
?%_NumberToString(j)
:%$toString(%$toPrimitive(j,0));
}
}
return %_StringAdd(j,i);
}
STRING_ADD_RIGHT_STRONG=function STRING_ADD_RIGHT_STRONG(i){
if((typeof(this)==='string')){
return %_StringAdd(this,i);
}
throw %MakeTypeError('strong_implicit_cast');
}
SUB=function SUB(i){
var j=(typeof(this)==='number')?this:%$nonNumberToNumber(this);
if(!(typeof(i)==='number'))i=%$nonNumberToNumber(i);
return %NumberSub(j,i);
}
SUB_STRONG=function SUB_STRONG(i){
if((typeof(this)==='number')&&(typeof(i)==='number')){
return %NumberSub(this,i);
}
throw %MakeTypeError('strong_implicit_cast');
}
MUL=function MUL(i){
var j=(typeof(this)==='number')?this:%$nonNumberToNumber(this);
if(!(typeof(i)==='number'))i=%$nonNumberToNumber(i);
return %NumberMul(j,i);
}
MUL_STRONG=function MUL_STRONG(i){
if((typeof(this)==='number')&&(typeof(i)==='number')){
return %NumberMul(this,i);
}
throw %MakeTypeError('strong_implicit_cast');
}
DIV=function DIV(i){
var j=(typeof(this)==='number')?this:%$nonNumberToNumber(this);
if(!(typeof(i)==='number'))i=%$nonNumberToNumber(i);
return %NumberDiv(j,i);
}
DIV_STRONG=function DIV_STRONG(i){
if((typeof(this)==='number')&&(typeof(i)==='number')){
return %NumberDiv(this,i);
}
throw %MakeTypeError('strong_implicit_cast');
}
MOD=function MOD(i){
var j=(typeof(this)==='number')?this:%$nonNumberToNumber(this);
if(!(typeof(i)==='number'))i=%$nonNumberToNumber(i);
return %NumberMod(j,i);
}
MOD_STRONG=function MOD_STRONG(i){
if((typeof(this)==='number')&&(typeof(i)==='number')){
return %NumberMod(this,i);
}
throw %MakeTypeError('strong_implicit_cast');
}
BIT_OR=function BIT_OR(i){
var j=(typeof(this)==='number')?this:%$nonNumberToNumber(this);
if(!(typeof(i)==='number'))i=%$nonNumberToNumber(i);
return %NumberOr(j,i);
}
BIT_OR_STRONG=function BIT_OR_STRONG(i){
if((typeof(this)==='number')&&(typeof(i)==='number')){
return %NumberOr(this,i);
}
throw %MakeTypeError('strong_implicit_cast');
}
BIT_AND=function BIT_AND(i){
var j;
if((typeof(this)==='number')){
j=this;
if(!(typeof(i)==='number'))i=%$nonNumberToNumber(i);
}else{
j=%$nonNumberToNumber(this);
if(!(typeof(i)==='number'))i=%$nonNumberToNumber(i);
if((!%_IsSmi(%IS_VAR(j))&&!(j==j)))return 0;
}
return %NumberAnd(j,i);
}
BIT_AND_STRONG=function BIT_AND_STRONG(i){
if((typeof(this)==='number')&&(typeof(i)==='number')){
return %NumberAnd(this,i);
}
throw %MakeTypeError('strong_implicit_cast');
}
BIT_XOR=function BIT_XOR(i){
var j=(typeof(this)==='number')?this:%$nonNumberToNumber(this);
if(!(typeof(i)==='number'))i=%$nonNumberToNumber(i);
return %NumberXor(j,i);
}
BIT_XOR_STRONG=function BIT_XOR_STRONG(i){
if((typeof(this)==='number')&&(typeof(i)==='number')){
return %NumberXor(this,i);
}
throw %MakeTypeError('strong_implicit_cast');
}
SHL=function SHL(i){
var j=(typeof(this)==='number')?this:%$nonNumberToNumber(this);
if(!(typeof(i)==='number'))i=%$nonNumberToNumber(i);
return %NumberShl(j,i);
}
SHL_STRONG=function SHL_STRONG(i){
if((typeof(this)==='number')&&(typeof(i)==='number')){
return %NumberShl(this,i);
}
throw %MakeTypeError('strong_implicit_cast');
}
SAR=function SAR(i){
var j;
if((typeof(this)==='number')){
j=this;
if(!(typeof(i)==='number'))i=%$nonNumberToNumber(i);
}else{
j=%$nonNumberToNumber(this);
if(!(typeof(i)==='number'))i=%$nonNumberToNumber(i);
if((!%_IsSmi(%IS_VAR(j))&&!(j==j)))return 0;
}
return %NumberSar(j,i);
}
SAR_STRONG=function SAR_STRONG(i){
if((typeof(this)==='number')&&(typeof(i)==='number')){
return %NumberSar(this,i);
}
throw %MakeTypeError('strong_implicit_cast');
}
SHR=function SHR(i){
var j=(typeof(this)==='number')?this:%$nonNumberToNumber(this);
if(!(typeof(i)==='number'))i=%$nonNumberToNumber(i);
return %NumberShr(j,i);
}
SHR_STRONG=function SHR_STRONG(i){
if((typeof(this)==='number')&&(typeof(i)==='number')){
return %NumberShr(this,i);
}
throw %MakeTypeError('strong_implicit_cast');
}
DELETE=function DELETE(r,t){
return %DeleteProperty(%$toObject(this),%$toName(r),t);
}
IN=function IN(j){
if(!(%_IsSpecObject(j))){
throw %MakeTypeError(27,this,j);
}
if(%_IsNonNegativeSmi(this)){
if((%_IsArray(j))&&%_HasFastPackedElements(j)){
return this<j.length;
}
return %HasElement(j,this);
}
return %HasProperty(j,%$toName(this));
}
INSTANCE_OF=function INSTANCE_OF(u){
var v=this;
if(!(%_ClassOf(u)==='Function')){
throw %MakeTypeError(24,u);
}
if(!(%_IsSpecObject(v))){
return 1;
}
var w=%BoundFunctionGetBindings(u);
if(w){
u=w[0];
}
var x=u.prototype;
if(!(%_IsSpecObject(x))){
throw %MakeTypeError(25,x);
}
return %IsInPrototypeChain(x,v)?0:1;
}
FILTER_KEY=function FILTER_KEY(r){
var y=%$toName(r);
if(%HasProperty(this,y))return y;
return 0;
}
CALL_NON_FUNCTION=function CALL_NON_FUNCTION(){
var z=%GetFunctionDelegate(this);
if(!(%_IsFunction(z))){
var A=%RenderCallSite();
if(A=="")A=typeof this;
throw %MakeTypeError(9,A);
}
return %Apply(z,this,arguments,0,%_ArgumentsLength());
}
CALL_NON_FUNCTION_AS_CONSTRUCTOR=function CALL_NON_FUNCTION_AS_CONSTRUCTOR(){
var z=%GetConstructorDelegate(this);
if(!(%_IsFunction(z))){
var A=%RenderCallSite();
if(A=="")A=typeof this;
throw %MakeTypeError(9,A);
}
return %Apply(z,this,arguments,0,%_ArgumentsLength());
}
CALL_FUNCTION_PROXY=function CALL_FUNCTION_PROXY(){
var B=%_ArgumentsLength()-1;
var C=%_Arguments(B);
var D=%GetCallTrap(C);
return %Apply(D,this,arguments,0,B);
}
CALL_FUNCTION_PROXY_AS_CONSTRUCTOR=
function CALL_FUNCTION_PROXY_AS_CONSTRUCTOR(){
var C=this;
var D=%GetConstructTrap(C);
return %Apply(D,this,arguments,0,%_ArgumentsLength());
}
APPLY_PREPARE=function APPLY_PREPARE(E){
var F;
if((%_IsArray(E))){
F=E.length;
if(%_IsSmi(F)&&F>=0&&F<0x800000&&
(%_ClassOf(this)==='Function')){
return F;
}
}
F=(E==null)?0:%$toUint32(E.length);
if(F>0x800000)throw %MakeRangeError(103);
if(!(%_ClassOf(this)==='Function')){
throw %MakeTypeError(5,%$toString(this),typeof this);
}
if(E!=null&&!(%_IsSpecObject(E))){
throw %MakeTypeError(78,"Function.prototype.apply");
}
return F;
}
REFLECT_APPLY_PREPARE=function REFLECT_APPLY_PREPARE(E){
var F;
if((%_IsArray(E))){
F=E.length;
if(%_IsSmi(F)&&F>=0&&F<0x800000&&
(%_ClassOf(this)==='Function')){
return F;
}
}
if(!(%_ClassOf(this)==='Function')){
throw %MakeTypeError(9,%$toString(this));
}
if(!(%_IsSpecObject(E))){
throw %MakeTypeError(78,"Reflect.apply");
}
F=%$toLength(E.length);
if(F>0x800000)throw %MakeRangeError(103);
return F;
}
REFLECT_CONSTRUCT_PREPARE=function REFLECT_CONSTRUCT_PREPARE(
E,newTarget){
var F;
var G=(%_ClassOf(this)==='Function')&&%IsConstructor(this);
var H=(%_ClassOf(newTarget)==='Function')&&%IsConstructor(newTarget);
if((%_IsArray(E))){
F=E.length;
if(%_IsSmi(F)&&F>=0&&F<0x800000&&
G&&H){
return F;
}
}
if(!G){
if(!(%_ClassOf(this)==='Function')){
throw %MakeTypeError(9,%$toString(this));
}else{
throw %MakeTypeError(36,%$toString(this));
}
}
if(!H){
if(!(%_ClassOf(newTarget)==='Function')){
throw %MakeTypeError(9,%$toString(newTarget));
}else{
throw %MakeTypeError(36,%$toString(newTarget));
}
}
if(!(%_IsSpecObject(E))){
throw %MakeTypeError(78,"Reflect.construct");
}
F=%$toLength(E.length);
if(F>0x800000)throw %MakeRangeError(103);
return F;
}
STACK_OVERFLOW=function STACK_OVERFLOW(F){
throw %MakeRangeError(103);
}
TO_OBJECT=function TO_OBJECT(){
return %$toObject(this);
}
TO_NUMBER=function TO_NUMBER(){
return %$toNumber(this);
}
TO_STRING=function TO_STRING(){
return %$toString(this);
}
TO_NAME=function TO_NAME(){
return %$toName(this);
}
STRING_LENGTH_STUB=function STRING_LENGTH_STUB(I){
var J=this;
return %_StringGetLength(%_JSValueGetValue(J));
}
function ToPrimitive(j,K){
if((typeof(j)==='string'))return j;
if(!(%_IsSpecObject(j)))return j;
if((%_ClassOf(j)==='Symbol'))throw MakeTypeError(72);
if(K==0)K=((%_ClassOf(j)==='Date'))?2:1;
return(K==1)?DefaultNumber(j):DefaultString(j);
}
function ToBoolean(j){
if((typeof(j)==='boolean'))return j;
if((typeof(j)==='string'))return j.length!=0;
if(j==null)return false;
if((typeof(j)==='number'))return!((j==0)||(!%_IsSmi(%IS_VAR(j))&&!(j==j)));
return true;
}
function ToNumber(j){
if((typeof(j)==='number'))return j;
if((typeof(j)==='string')){
return %_HasCachedArrayIndex(j)?%_GetCachedArrayIndex(j)
:%StringToNumber(j);
}
if((typeof(j)==='boolean'))return j?1:0;
if((j===(void 0)))return $NaN;
if((typeof(j)==='symbol'))throw MakeTypeError(73);
return((j===null))?0:ToNumber(DefaultNumber(j));
}
function NonNumberToNumber(j){
if((typeof(j)==='string')){
return %_HasCachedArrayIndex(j)?%_GetCachedArrayIndex(j)
:%StringToNumber(j);
}
if((typeof(j)==='boolean'))return j?1:0;
if((j===(void 0)))return $NaN;
if((typeof(j)==='symbol'))throw MakeTypeError(73);
return((j===null))?0:ToNumber(DefaultNumber(j));
}
function ToString(j){
if((typeof(j)==='string'))return j;
if((typeof(j)==='number'))return %_NumberToString(j);
if((typeof(j)==='boolean'))return j?'true':'false';
if((j===(void 0)))return'undefined';
if((typeof(j)==='symbol'))throw MakeTypeError(74);
return((j===null))?'null':ToString(DefaultString(j));
}
function NonStringToString(j){
if((typeof(j)==='number'))return %_NumberToString(j);
if((typeof(j)==='boolean'))return j?'true':'false';
if((j===(void 0)))return'undefined';
if((typeof(j)==='symbol'))throw MakeTypeError(74);
return((j===null))?'null':ToString(DefaultString(j));
}
function ToName(j){
return(typeof(j)==='symbol')?j:ToString(j);
}
function ToObject(j){
if((typeof(j)==='string'))return new g(j);
if((typeof(j)==='number'))return new h(j);
if((typeof(j)==='boolean'))return new e(j);
if((typeof(j)==='symbol'))return %NewSymbolWrapper(j);
if((j==null)&&!(%_IsUndetectableObject(j))){
throw MakeTypeError(75);
}
return j;
}
function ToInteger(j){
if(%_IsSmi(j))return j;
return %NumberToInteger(ToNumber(j));
}
function ToLength(L){
L=ToInteger(L);
if(L<0)return 0;
return L<h.MAX_SAFE_INTEGER?L
:h.MAX_SAFE_INTEGER;
}
function ToUint32(j){
if(%_IsSmi(j)&&j>=0)return j;
return %NumberToJSUint32(ToNumber(j));
}
function ToInt32(j){
if(%_IsSmi(j))return j;
return %NumberToJSInt32(ToNumber(j));
}
function SameValue(j,i){
if(typeof j!=typeof i)return false;
if((typeof(j)==='number')){
if((!%_IsSmi(%IS_VAR(j))&&!(j==j))&&(!%_IsSmi(%IS_VAR(i))&&!(i==i)))return true;
if(j===0&&i===0&&%_IsMinusZero(j)!=%_IsMinusZero(i)){
return false;
}
}
return j===i;
}
function SameValueZero(j,i){
if(typeof j!=typeof i)return false;
if((typeof(j)==='number')){
if((!%_IsSmi(%IS_VAR(j))&&!(j==j))&&(!%_IsSmi(%IS_VAR(i))&&!(i==i)))return true;
}
return j===i;
}
function IsPrimitive(j){
return!(%_IsSpecObject(j));
}
function IsConcatSpreadable(x){
if(!(%_IsSpecObject(x)))return false;
var M=x[symbolIsConcatSpreadable];
if((M===(void 0)))return(%_IsArray(x));
return ToBoolean(M);
}
function DefaultNumber(j){
if(!(%_ClassOf(j)==='Symbol')){
var N=j.valueOf;
if((%_ClassOf(N)==='Function')){
var O=%_CallFunction(j,N);
if(IsPrimitive(O))return O;
}
var P=j.toString;
if((%_ClassOf(P)==='Function')){
var Q=%_CallFunction(j,P);
if(IsPrimitive(Q))return Q;
}
}
throw MakeTypeError(12);
}
function DefaultString(j){
if(!(%_ClassOf(j)==='Symbol')){
var P=j.toString;
if((%_ClassOf(P)==='Function')){
var Q=%_CallFunction(j,P);
if(IsPrimitive(Q))return Q;
}
var N=j.valueOf;
if((%_ClassOf(N)==='Function')){
var O=%_CallFunction(j,N);
if(IsPrimitive(O))return O;
}
}
throw MakeTypeError(12);
}
function ToPositiveInteger(j,R){
var S=(%_IsSmi(%IS_VAR(j))?j:%NumberToIntegerMapMinusZero($toNumber(j)));
if(S<0)throw MakeRangeError(R);
return S;
}
%FunctionSetPrototype(d,new d(0));
$defaultNumber=DefaultNumber;
$defaultString=DefaultString;
$NaN=%GetRootNaN();
$nonNumberToNumber=NonNumberToNumber;
$nonStringToString=NonStringToString;
$sameValue=SameValue;
$sameValueZero=SameValueZero;
$toBoolean=ToBoolean;
$toInt32=ToInt32;
$toInteger=ToInteger;
$toLength=ToLength;
$toName=ToName;
$toNumber=ToNumber;
$toObject=ToObject;
$toPositiveInteger=ToPositiveInteger;
$toPrimitive=ToPrimitive;
$toString=ToString;
$toUint32=ToUint32;
})

$v8nativesj
var $delete;
var $functionSourceString;
var $getIterator;
var $getMethod;
var $globalEval;
var $installConstants;
var $installFunctions;
var $installGetter;
var $isFinite;
var $isNaN;
var $newFunctionString;
var $numberIsNaN;
var $objectDefineProperties;
var $objectDefineProperty;
var $objectFreeze;
var $objectGetOwnPropertyDescriptor;
var $objectGetOwnPropertyKeys;
var $objectHasOwnProperty;
var $objectIsFrozen;
var $objectIsSealed;
var $objectLookupGetter;
var $objectLookupSetter;
var $objectToString;
var $overrideFunction;
var $ownPropertyKeys;
var $setFunctionName;
var $setUpLockedPrototype;
var $toCompletePropertyDescriptor;
var $toNameArray;
(function(a,b,c){
%CheckIsBootstrapping();
var d=a.Array;
var e=a.Boolean;
var g=a.Function;
var h=a.Number;
var i=a.Object;
function SetFunctionName(j,k,l){
if((typeof(k)==='symbol')){
k="["+%SymbolDescription(k)+"]";
}
if((l===(void 0))){
%FunctionSetName(j,k);
}else{
%FunctionSetName(j,l+" "+k);
}
}
function InstallFunctions(m,n,o){
%OptimizeObjectForAddingMultipleProperties(m,o.length>>1);
for(var p=0;p<o.length;p+=2){
var q=o[p];
var j=o[p+1];
SetFunctionName(j,q);
%FunctionRemovePrototype(j);
%AddNamedProperty(m,q,j,n);
%SetNativeFlag(j);
}
%ToFastProperties(m);
}
function OverrideFunction(m,k,j){
ObjectDefineProperty(m,k,{value:j,
writeable:true,
configurable:true,
enumerable:false});
SetFunctionName(j,k);
%FunctionRemovePrototype(j);
%SetNativeFlag(j);
}
function InstallGetter(m,k,r,n){
if(typeof n=="undefined"){
n=2;
}
SetFunctionName(r,k,"get");
%FunctionRemovePrototype(r);
%DefineAccessorPropertyUnchecked(m,k,r,null,n);
%SetNativeFlag(r);
}
function InstallGetterSetter(m,k,r,t){
SetFunctionName(r,k,"get");
SetFunctionName(t,k,"set");
%FunctionRemovePrototype(r);
%FunctionRemovePrototype(t);
%DefineAccessorPropertyUnchecked(m,k,r,t,2);
%SetNativeFlag(r);
%SetNativeFlag(t);
}
function InstallConstants(m,u){
%OptimizeObjectForAddingMultipleProperties(m,u.length>>1);
var n=2|4|1;
for(var p=0;p<u.length;p+=2){
var k=u[p];
var v=u[p+1];
%AddNamedProperty(m,k,v,n);
}
%ToFastProperties(m);
}
function SetUpLockedPrototype(w,x,y){
%CheckIsBootstrapping();
var z=w.prototype;
var A=(y.length>>1)+(x?x.length:0);
if(A>=4){
%OptimizeObjectForAddingMultipleProperties(z,A);
}
if(x){
for(var p=0;p<x.length;p++){
%AddNamedProperty(z,x[p],
(void 0),2|4);
}
}
for(var p=0;p<y.length;p+=2){
var q=y[p];
var j=y[p+1];
%AddNamedProperty(z,q,j,2|4|1);
%SetNativeFlag(j);
}
%InternalSetPrototype(z,null);
%ToFastProperties(z);
}
function GlobalIsNaN(B){
B=((typeof(%IS_VAR(B))==='number')?B:$nonNumberToNumber(B));
return(!%_IsSmi(%IS_VAR(B))&&!(B==B));
}
function GlobalIsFinite(B){
B=((typeof(%IS_VAR(B))==='number')?B:$nonNumberToNumber(B));
return(%_IsSmi(%IS_VAR(B))||((B==B)&&(B!=1/0)&&(B!=-1/0)));
}
function GlobalParseInt(C,D){
if((D===(void 0))||D===10||D===0){
if(%_IsSmi(C))return C;
if((typeof(C)==='number')&&
((0.01<C&&C<1e9)||
(-1e9<C&&C<-0.01))){
return C|0;
}
C=((typeof(%IS_VAR(C))==='string')?C:$nonStringToString(C));
D=D|0;
}else{
C=((typeof(%IS_VAR(C))==='string')?C:$nonStringToString(C));
D=(%_IsSmi(%IS_VAR(D))?D:(D>>0));
if(!(D==0||(2<=D&&D<=36))){
return $NaN;
}
}
if(%_HasCachedArrayIndex(C)&&
(D==0||D==10)){
return %_GetCachedArrayIndex(C);
}
return %StringParseInt(C,D);
}
function GlobalParseFloat(C){
C=((typeof(%IS_VAR(C))==='string')?C:$nonStringToString(C));
if(%_HasCachedArrayIndex(C))return %_GetCachedArrayIndex(C);
return %StringParseFloat(C);
}
function GlobalEval(E){
if(!(typeof(E)==='string'))return E;
var F=%GlobalProxy(GlobalEval);
var j=%CompileString(E,false);
if(!(%_IsFunction(j)))return j;
return %_CallFunction(F,j);
}
var n=2|4|1;
InstallConstants(a,[
"NaN",$NaN,
"Infinity",(1/0),
"undefined",(void 0),
]);
InstallFunctions(a,2,[
"isNaN",GlobalIsNaN,
"isFinite",GlobalIsFinite,
"parseInt",GlobalParseInt,
"parseFloat",GlobalParseFloat,
"eval",GlobalEval
]);
function ObjectToString(){
if((this===(void 0))&&!(%_IsUndetectableObject(this)))return"[object Undefined]";
if((this===null))return"[object Null]";
var G=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var H=%_ClassOf(G);
var I;
if(harmony_tostring){
I=G[symbolToStringTag];
if(!(typeof(I)==='string')){
I=H;
}
}else{
I=H;
}
return`[object ${I}]`;
}
function ObjectToLocaleString(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Object.prototype.toLocaleString");
return this.toString();
}
function ObjectValueOf(){
return((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
}
function ObjectHasOwnProperty(J){
if(%_IsJSProxy(this)){
if((typeof(J)==='symbol'))return false;
var K=%GetHandler(this);
return CallTrap1(K,"hasOwn",$proxyDerivedHasOwnTrap,$toName(J));
}
return %HasOwnProperty(((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this)),$toName(J));
}
function ObjectIsPrototypeOf(J){
if(!(%_IsSpecObject(J)))return false;
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Object.prototype.isPrototypeOf");
return %IsInPrototypeChain(this,J);
}
function ObjectPropertyIsEnumerable(J){
var L=$toName(J);
if(%_IsJSProxy(this)){
if((typeof(J)==='symbol'))return false;
var M=GetOwnPropertyJS(this,L);
return(M===(void 0))?false:M.isEnumerable();
}
return %IsPropertyEnumerable(((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this)),L);
}
function ObjectDefineGetter(k,N){
var O=this;
if(O==null&&!(%_IsUndetectableObject(O))){
O=%GlobalProxy(ObjectDefineGetter);
}
if(!(%_ClassOf(N)==='Function')){
throw MakeTypeError(40);
}
var M=new PropertyDescriptor();
M.setGet(N);
M.setEnumerable(true);
M.setConfigurable(true);
DefineOwnProperty(((%_IsSpecObject(%IS_VAR(O)))?O:$toObject(O)),$toName(k),M,false);
}
function ObjectLookupGetter(k){
var O=this;
if(O==null&&!(%_IsUndetectableObject(O))){
O=%GlobalProxy(ObjectLookupGetter);
}
return %LookupAccessor(((%_IsSpecObject(%IS_VAR(O)))?O:$toObject(O)),$toName(k),0);
}
function ObjectDefineSetter(k,N){
var O=this;
if(O==null&&!(%_IsUndetectableObject(O))){
O=%GlobalProxy(ObjectDefineSetter);
}
if(!(%_ClassOf(N)==='Function')){
throw MakeTypeError(42);
}
var M=new PropertyDescriptor();
M.setSet(N);
M.setEnumerable(true);
M.setConfigurable(true);
DefineOwnProperty(((%_IsSpecObject(%IS_VAR(O)))?O:$toObject(O)),$toName(k),M,false);
}
function ObjectLookupSetter(k){
var O=this;
if(O==null&&!(%_IsUndetectableObject(O))){
O=%GlobalProxy(ObjectLookupSetter);
}
return %LookupAccessor(((%_IsSpecObject(%IS_VAR(O)))?O:$toObject(O)),$toName(k),1);
}
function ObjectKeys(P){
P=((%_IsSpecObject(%IS_VAR(P)))?P:$toObject(P));
if(%_IsJSProxy(P)){
var K=%GetHandler(P);
var Q=CallTrap0(K,"keys",$proxyDerivedKeysTrap);
return ToNameArray(Q,"keys",false);
}
return %OwnKeys(P);
}
function IsAccessorDescriptor(M){
if((M===(void 0)))return false;
return M.hasGetter()||M.hasSetter();
}
function IsDataDescriptor(M){
if((M===(void 0)))return false;
return M.hasValue()||M.hasWritable();
}
function IsGenericDescriptor(M){
if((M===(void 0)))return false;
return!(IsAccessorDescriptor(M)||IsDataDescriptor(M));
}
function IsInconsistentDescriptor(M){
return IsAccessorDescriptor(M)&&IsDataDescriptor(M);
}
function FromPropertyDescriptor(M){
if((M===(void 0)))return M;
if(IsDataDescriptor(M)){
return{value:M.getValue(),
writable:M.isWritable(),
enumerable:M.isEnumerable(),
configurable:M.isConfigurable()};
}
return{get:M.getGet(),
set:M.getSet(),
enumerable:M.isEnumerable(),
configurable:M.isConfigurable()};
}
function FromGenericPropertyDescriptor(M){
if((M===(void 0)))return M;
var P=new i();
if(M.hasValue()){
%AddNamedProperty(P,"value",M.getValue(),0);
}
if(M.hasWritable()){
%AddNamedProperty(P,"writable",M.isWritable(),0);
}
if(M.hasGetter()){
%AddNamedProperty(P,"get",M.getGet(),0);
}
if(M.hasSetter()){
%AddNamedProperty(P,"set",M.getSet(),0);
}
if(M.hasEnumerable()){
%AddNamedProperty(P,"enumerable",M.isEnumerable(),0);
}
if(M.hasConfigurable()){
%AddNamedProperty(P,"configurable",M.isConfigurable(),0);
}
return P;
}
function ToPropertyDescriptor(P){
if(!(%_IsSpecObject(P)))throw MakeTypeError(55,P);
var M=new PropertyDescriptor();
if("enumerable"in P){
M.setEnumerable($toBoolean(P.enumerable));
}
if("configurable"in P){
M.setConfigurable($toBoolean(P.configurable));
}
if("value"in P){
M.setValue(P.value);
}
if("writable"in P){
M.setWritable($toBoolean(P.writable));
}
if("get"in P){
var R=P.get;
if(!(R===(void 0))&&!(%_ClassOf(R)==='Function')){
throw MakeTypeError(41,R);
}
M.setGet(R);
}
if("set"in P){
var S=P.set;
if(!(S===(void 0))&&!(%_ClassOf(S)==='Function')){
throw MakeTypeError(43,S);
}
M.setSet(S);
}
if(IsInconsistentDescriptor(M)){
throw MakeTypeError(76,P);
}
return M;
}
function ToCompletePropertyDescriptor(P){
var M=ToPropertyDescriptor(P);
if(IsGenericDescriptor(M)||IsDataDescriptor(M)){
if(!M.hasValue())M.setValue((void 0));
if(!M.hasWritable())M.setWritable(false);
}else{
if(!M.hasGetter())M.setGet((void 0));
if(!M.hasSetter())M.setSet((void 0));
}
if(!M.hasEnumerable())M.setEnumerable(false);
if(!M.hasConfigurable())M.setConfigurable(false);
return M;
}
function PropertyDescriptor(){
this.value_=(void 0);
this.hasValue_=false;
this.writable_=false;
this.hasWritable_=false;
this.enumerable_=false;
this.hasEnumerable_=false;
this.configurable_=false;
this.hasConfigurable_=false;
this.get_=(void 0);
this.hasGetter_=false;
this.set_=(void 0);
this.hasSetter_=false;
}
SetUpLockedPrototype(PropertyDescriptor,[
"value_",
"hasValue_",
"writable_",
"hasWritable_",
"enumerable_",
"hasEnumerable_",
"configurable_",
"hasConfigurable_",
"get_",
"hasGetter_",
"set_",
"hasSetter_"
],[
"toString",function PropertyDescriptor_ToString(){
return"[object PropertyDescriptor]";
},
"setValue",function PropertyDescriptor_SetValue(T){
this.value_=T;
this.hasValue_=true;
},
"getValue",function PropertyDescriptor_GetValue(){
return this.value_;
},
"hasValue",function PropertyDescriptor_HasValue(){
return this.hasValue_;
},
"setEnumerable",function PropertyDescriptor_SetEnumerable(U){
this.enumerable_=U;
this.hasEnumerable_=true;
},
"isEnumerable",function PropertyDescriptor_IsEnumerable(){
return this.enumerable_;
},
"hasEnumerable",function PropertyDescriptor_HasEnumerable(){
return this.hasEnumerable_;
},
"setWritable",function PropertyDescriptor_SetWritable(V){
this.writable_=V;
this.hasWritable_=true;
},
"isWritable",function PropertyDescriptor_IsWritable(){
return this.writable_;
},
"hasWritable",function PropertyDescriptor_HasWritable(){
return this.hasWritable_;
},
"setConfigurable",
function PropertyDescriptor_SetConfigurable(W){
this.configurable_=W;
this.hasConfigurable_=true;
},
"hasConfigurable",function PropertyDescriptor_HasConfigurable(){
return this.hasConfigurable_;
},
"isConfigurable",function PropertyDescriptor_IsConfigurable(){
return this.configurable_;
},
"setGet",function PropertyDescriptor_SetGetter(R){
this.get_=R;
this.hasGetter_=true;
},
"getGet",function PropertyDescriptor_GetGetter(){
return this.get_;
},
"hasGetter",function PropertyDescriptor_HasGetter(){
return this.hasGetter_;
},
"setSet",function PropertyDescriptor_SetSetter(S){
this.set_=S;
this.hasSetter_=true;
},
"getSet",function PropertyDescriptor_GetSetter(){
return this.set_;
},
"hasSetter",function PropertyDescriptor_HasSetter(){
return this.hasSetter_;
}
]);
function ConvertDescriptorArrayToDescriptor(X){
if((X===(void 0))){
return(void 0);
}
var M=new PropertyDescriptor();
if(X[0]){
M.setGet(X[2]);
M.setSet(X[3]);
}else{
M.setValue(X[1]);
M.setWritable(X[4]);
}
M.setEnumerable(X[5]);
M.setConfigurable(X[6]);
return M;
}
function GetTrap(K,k,Y){
var Z=K[k];
if((Z===(void 0))){
if((Y===(void 0))){
throw MakeTypeError(60,K,k);
}
Z=Y;
}else if(!(%_ClassOf(Z)==='Function')){
throw MakeTypeError(61,K,k);
}
return Z;
}
function CallTrap0(K,k,Y){
return %_CallFunction(K,GetTrap(K,k,Y));
}
function CallTrap1(K,k,Y,E){
return %_CallFunction(K,E,GetTrap(K,k,Y));
}
function CallTrap2(K,k,Y,E,aa){
return %_CallFunction(K,E,aa,GetTrap(K,k,Y));
}
function GetOwnPropertyJS(P,ab){
var ac=$toName(ab);
if(%_IsJSProxy(P)){
if((typeof(ab)==='symbol'))return(void 0);
var K=%GetHandler(P);
var ad=CallTrap1(
K,"getOwnPropertyDescriptor",(void 0),ac);
if((ad===(void 0)))return ad;
var M=ToCompletePropertyDescriptor(ad);
if(!M.isConfigurable()){
throw MakeTypeError(64,
K,ac,"getOwnPropertyDescriptor");
}
return M;
}
var ae=%GetOwnProperty(((%_IsSpecObject(%IS_VAR(P)))?P:$toObject(P)),ac);
return ConvertDescriptorArrayToDescriptor(ae);
}
function Delete(P,ac,af){
var M=GetOwnPropertyJS(P,ac);
if((M===(void 0)))return true;
if(M.isConfigurable()){
%DeleteProperty(P,ac,0);
return true;
}else if(af){
throw MakeTypeError(18,ac);
}else{
return;
}
}
function GetMethod(P,ac){
var ag=P[ac];
if((ag==null))return(void 0);
if((%_ClassOf(ag)==='Function'))return ag;
throw MakeTypeError(9,typeof ag);
}
function DefineProxyProperty(P,ac,n,af){
if((typeof(ac)==='symbol'))return false;
var K=%GetHandler(P);
var ah=CallTrap2(K,"defineProperty",(void 0),ac,n);
if(!$toBoolean(ah)){
if(af){
throw MakeTypeError(59,
K,"false","defineProperty");
}else{
return false;
}
}
return true;
}
function DefineObjectProperty(P,ac,M,af){
var ai=%GetOwnProperty(P,$toName(ac));
var aj=ConvertDescriptorArrayToDescriptor(ai);
var ak=%IsExtensible(P);
if((aj===(void 0))&&!ak){
if(af){
throw MakeTypeError(18,ac);
}else{
return false;
}
}
if(!(aj===(void 0))){
if((IsGenericDescriptor(M)||
IsDataDescriptor(M)==IsDataDescriptor(aj))&&
(!M.hasEnumerable()||
$sameValue(M.isEnumerable(),aj.isEnumerable()))&&
(!M.hasConfigurable()||
$sameValue(M.isConfigurable(),aj.isConfigurable()))&&
(!M.hasWritable()||
$sameValue(M.isWritable(),aj.isWritable()))&&
(!M.hasValue()||
$sameValue(M.getValue(),aj.getValue()))&&
(!M.hasGetter()||
$sameValue(M.getGet(),aj.getGet()))&&
(!M.hasSetter()||
$sameValue(M.getSet(),aj.getSet()))){
return true;
}
if(!aj.isConfigurable()){
if(M.isConfigurable()||
(M.hasEnumerable()&&
M.isEnumerable()!=aj.isEnumerable())){
if(af){
throw MakeTypeError(67,ac);
}else{
return false;
}
}
if(!IsGenericDescriptor(M)){
if(IsDataDescriptor(aj)!=IsDataDescriptor(M)){
if(af){
throw MakeTypeError(67,ac);
}else{
return false;
}
}
if(IsDataDescriptor(aj)&&IsDataDescriptor(M)){
if(!aj.isWritable()&&M.isWritable()){
if(af){
throw MakeTypeError(67,ac);
}else{
return false;
}
}
if(!aj.isWritable()&&M.hasValue()&&
!$sameValue(M.getValue(),aj.getValue())){
if(af){
throw MakeTypeError(67,ac);
}else{
return false;
}
}
}
if(IsAccessorDescriptor(M)&&IsAccessorDescriptor(aj)){
if(M.hasSetter()&&
!$sameValue(M.getSet(),aj.getSet())){
if(af){
throw MakeTypeError(67,ac);
}else{
return false;
}
}
if(M.hasGetter()&&!$sameValue(M.getGet(),aj.getGet())){
if(af){
throw MakeTypeError(67,ac);
}else{
return false;
}
}
}
}
}
}
var al=0;
if(M.hasEnumerable()){
al|=M.isEnumerable()?0:2;
}else if(!(aj===(void 0))){
al|=aj.isEnumerable()?0:2;
}else{
al|=2;
}
if(M.hasConfigurable()){
al|=M.isConfigurable()?0:4;
}else if(!(aj===(void 0))){
al|=aj.isConfigurable()?0:4;
}else
al|=4;
if(IsDataDescriptor(M)||
(IsGenericDescriptor(M)&&
((aj===(void 0))||IsDataDescriptor(aj)))){
if(M.hasWritable()){
al|=M.isWritable()?0:1;
}else if(!(aj===(void 0))){
al|=aj.isWritable()?0:1;
}else{
al|=1;
}
var T=(void 0);
if(M.hasValue()){
T=M.getValue();
}else if(!(aj===(void 0))&&IsDataDescriptor(aj)){
T=aj.getValue();
}
%DefineDataPropertyUnchecked(P,ac,T,al);
}else{
var r=null;
if(M.hasGetter()){
r=M.getGet();
}else if(IsAccessorDescriptor(aj)&&aj.hasGetter()){
r=aj.getGet();
}
var t=null;
if(M.hasSetter()){
t=M.getSet();
}else if(IsAccessorDescriptor(aj)&&aj.hasSetter()){
t=aj.getSet();
}
%DefineAccessorPropertyUnchecked(P,ac,r,t,al);
}
return true;
}
function DefineArrayProperty(P,ac,M,af){
if(ac==="length"){
var am=P.length;
var an=am;
if(!M.hasValue()){
return DefineObjectProperty(P,"length",M,af);
}
var ao=$toUint32(M.getValue());
if(ao!=$toNumber(M.getValue())){
throw MakeRangeError(82);
}
var ap=GetOwnPropertyJS(P,"length");
if(ao!=am&&!ap.isWritable()){
if(af){
throw MakeTypeError(67,ac);
}else{
return false;
}
}
var aq=false;
var ar=%IsObserved(P)&&ao!==an;
var as;
if(ar){
$observeBeginPerformSplice(P);
as=[];
if(ao<an)
as.length=an-ao;
}
while(ao<am--){
var at=$toString(am);
if(ar){
var au=GetOwnPropertyJS(P,at);
if(au&&au.hasValue())
as[am-ao]=au.getValue();
}
if(!Delete(P,at,false)){
ao=am+1;
aq=true;
break;
}
}
aq=!DefineObjectProperty(P,"length",M,af)||aq;
if(ar){
$observeEndPerformSplice(P);
$observeEnqueueSpliceRecord(P,
ao<an?ao:an,
as,
ao>an?ao-an:0);
}
if(aq){
if(af){
throw MakeTypeError(67,ac);
}else{
return false;
}
}
return true;
}
if(!(typeof(ac)==='symbol')){
var at=$toUint32(ac);
var ar=false;
if($toString(at)==ac&&at!=4294967295){
var am=P.length;
if(at>=am&&%IsObserved(P)){
ar=true;
$observeBeginPerformSplice(P);
}
var ap=GetOwnPropertyJS(P,"length");
if((at>=am&&!ap.isWritable())||
!DefineObjectProperty(P,ac,M,true)){
if(ar)
$observeEndPerformSplice(P);
if(af){
throw MakeTypeError(18,ac);
}else{
return false;
}
}
if(at>=am){
P.length=at+1;
}
if(ar){
$observeEndPerformSplice(P);
$observeEnqueueSpliceRecord(P,am,[],at+1-am);
}
return true;
}
}
return DefineObjectProperty(P,ac,M,af);
}
function DefineOwnProperty(P,ac,M,af){
if(%_IsJSProxy(P)){
if((typeof(ac)==='symbol'))return false;
var n=FromGenericPropertyDescriptor(M);
return DefineProxyProperty(P,ac,n,af);
}else if((%_IsArray(P))){
return DefineArrayProperty(P,ac,M,af);
}else{
return DefineObjectProperty(P,ac,M,af);
}
}
function ObjectGetPrototypeOf(P){
return %_GetPrototype(((%_IsSpecObject(%IS_VAR(P)))?P:$toObject(P)));
}
function ObjectSetPrototypeOf(P,av){
if((P==null)&&!(%_IsUndetectableObject(P)))throw MakeTypeError(11,"Object.setPrototypeOf");
if(av!==null&&!(%_IsSpecObject(av))){
throw MakeTypeError(57,av);
}
if((%_IsSpecObject(P))){
%SetPrototype(P,av);
}
return P;
}
function ObjectGetOwnPropertyDescriptor(P,ac){
var M=GetOwnPropertyJS(((%_IsSpecObject(%IS_VAR(P)))?P:$toObject(P)),ac);
return FromPropertyDescriptor(M);
}
function ToNameArray(P,Z,aw){
if(!(%_IsSpecObject(P))){
throw MakeTypeError(62,Z,P);
}
var ax=$toUint32(P.length);
var ay=new d(ax);
var az=0;
var Q={__proto__:null};
for(var at=0;at<ax;at++){
var aA=$toName(P[at]);
if((typeof(aA)==='symbol')&&!aw)continue;
if(%HasOwnProperty(Q,aA)){
throw MakeTypeError(65,Z,aA);
}
ay[at]=aA;
++az;
Q[aA]=0;
}
ay.length=az;
return ay;
}
function ObjectGetOwnPropertyKeys(P,aB){
var aC=new InternalArray();
aB|=32;
var aD=%GetInterceptorInfo(P);
if((aB&8)===0){
var aE=%GetOwnElementNames(P);
for(var p=0;p<aE.length;++p){
aE[p]=%_NumberToString(aE[p]);
}
aC.push(aE);
if((aD&1)!=0){
var aF=%GetIndexedInterceptorElementNames(P);
if(!(aF===(void 0))){
aC.push(aF);
}
}
}
aC.push(%GetOwnPropertyNames(P,aB));
if((aD&2)!=0){
var aG=
%GetNamedInterceptorPropertyNames(P);
if(!(aG===(void 0))){
aC.push(aG);
}
}
var aH=
%Apply(InternalArray.prototype.concat,
aC[0],aC,1,aC.length-1);
if(aD!=0){
var aI={__proto__:null};
var aJ=0;
for(var p=0;p<aH.length;++p){
var k=aH[p];
if((typeof(k)==='symbol')){
if((aB&16)||(%SymbolIsPrivate(k))){
continue;
}
}else{
if(aB&8)continue;
k=$toString(k);
}
if(aI[k])continue;
aI[k]=true;
aH[aJ++]=k;
}
aH.length=aJ;
}
return aH;
}
function OwnPropertyKeys(P){
if(%_IsJSProxy(P)){
var K=%GetHandler(P);
var Q=CallTrap0(K,"ownKeys",(void 0));
return ToNameArray(Q,"getOwnPropertyNames",false);
}
return ObjectGetOwnPropertyKeys(P,32);
}
function ObjectGetOwnPropertyNames(P){
P=((%_IsSpecObject(%IS_VAR(P)))?P:$toObject(P));
if(%_IsJSProxy(P)){
var K=%GetHandler(P);
var Q=CallTrap0(K,"getOwnPropertyNames",(void 0));
return ToNameArray(Q,"getOwnPropertyNames",false);
}
return ObjectGetOwnPropertyKeys(P,16);
}
function ObjectCreate(av,aK){
if(!(%_IsSpecObject(av))&&av!==null){
throw MakeTypeError(57,av);
}
var P={};
%InternalSetPrototype(P,av);
if(!(aK===(void 0)))ObjectDefineProperties(P,aK);
return P;
}
function ObjectDefineProperty(P,ac,n){
if(!(%_IsSpecObject(P))){
throw MakeTypeError(10,"Object.defineProperty");
}
var k=$toName(ac);
if(%_IsJSProxy(P)){
var aL={__proto__:null};
for(var aM in n){
aL[aM]=n[aM];
}
DefineProxyProperty(P,k,aL,true);
}else{
var M=ToPropertyDescriptor(n);
DefineOwnProperty(P,k,M,true);
}
return P;
}
function GetOwnEnumerablePropertyNames(m){
var Q=new InternalArray();
for(var q in m){
if(%HasOwnProperty(m,q)){
Q.push(q);
}
}
var aB=8|32;
var aN=%GetOwnPropertyNames(m,aB);
for(var p=0;p<aN.length;++p){
var aO=aN[p];
if((typeof(aO)==='symbol')){
var M=ObjectGetOwnPropertyDescriptor(m,aO);
if(M.enumerable)Q.push(aO);
}
}
return Q;
}
function ObjectDefineProperties(P,aK){
if(!(%_IsSpecObject(P))){
throw MakeTypeError(10,"Object.defineProperties");
}
var ae=((%_IsSpecObject(%IS_VAR(aK)))?aK:$toObject(aK));
var Q=GetOwnEnumerablePropertyNames(ae);
var aP=new InternalArray();
for(var p=0;p<Q.length;p++){
aP.push(ToPropertyDescriptor(ae[Q[p]]));
}
for(var p=0;p<Q.length;p++){
DefineOwnProperty(P,Q[p],aP[p],true);
}
return P;
}
function ProxyFix(P){
var K=%GetHandler(P);
var ae=CallTrap0(K,"fix",(void 0));
if((ae===(void 0))){
throw MakeTypeError(59,K,"undefined","fix");
}
if(%IsJSFunctionProxy(P)){
var aQ=%GetCallTrap(P);
var aR=%GetConstructTrap(P);
var aS=$proxyDelegateCallAndConstruct(aQ,aR);
%Fix(P);
%SetCode(P,aS);
var z=new i();
ObjectDefineProperty(z,"constructor",
{value:P,writable:true,enumerable:false,configurable:true});
%FunctionSetPrototype(P,z);
P.length=0;
}else{
%Fix(P);
}
ObjectDefineProperties(P,ae);
}
function ObjectSealJS(P){
if(!(%_IsSpecObject(P)))return P;
var aT=%_IsJSProxy(P);
if(aT||%HasSloppyArgumentsElements(P)||%IsObserved(P)){
if(aT){
ProxyFix(P);
}
var Q=ObjectGetOwnPropertyNames(P);
for(var p=0;p<Q.length;p++){
var k=Q[p];
var M=GetOwnPropertyJS(P,k);
if(M.isConfigurable()){
M.setConfigurable(false);
DefineOwnProperty(P,k,M,true);
}
}
%PreventExtensions(P);
}else{
%ObjectSeal(P);
}
return P;
}
function ObjectFreezeJS(P){
if(!(%_IsSpecObject(P)))return P;
var aT=%_IsJSProxy(P);
if(aT||%HasSloppyArgumentsElements(P)||%IsObserved(P)){
if(aT){
ProxyFix(P);
}
var Q=ObjectGetOwnPropertyNames(P);
for(var p=0;p<Q.length;p++){
var k=Q[p];
var M=GetOwnPropertyJS(P,k);
if(M.isWritable()||M.isConfigurable()){
if(IsDataDescriptor(M))M.setWritable(false);
M.setConfigurable(false);
DefineOwnProperty(P,k,M,true);
}
}
%PreventExtensions(P);
}else{
%ObjectFreeze(P);
}
return P;
}
function ObjectPreventExtension(P){
if(!(%_IsSpecObject(P)))return P;
if(%_IsJSProxy(P)){
ProxyFix(P);
}
%PreventExtensions(P);
return P;
}
function ObjectIsSealed(P){
if(!(%_IsSpecObject(P)))return true;
if(%_IsJSProxy(P)){
return false;
}
if(%IsExtensible(P)){
return false;
}
var Q=ObjectGetOwnPropertyNames(P);
for(var p=0;p<Q.length;p++){
var k=Q[p];
var M=GetOwnPropertyJS(P,k);
if(M.isConfigurable()){
return false;
}
}
return true;
}
function ObjectIsFrozen(P){
if(!(%_IsSpecObject(P)))return true;
if(%_IsJSProxy(P)){
return false;
}
if(%IsExtensible(P)){
return false;
}
var Q=ObjectGetOwnPropertyNames(P);
for(var p=0;p<Q.length;p++){
var k=Q[p];
var M=GetOwnPropertyJS(P,k);
if(IsDataDescriptor(M)&&M.isWritable())return false;
if(M.isConfigurable())return false;
}
return true;
}
function ObjectIsExtensible(P){
if(!(%_IsSpecObject(P)))return false;
if(%_IsJSProxy(P)){
return true;
}
return %IsExtensible(P);
}
function ObjectIs(aU,aV){
return $sameValue(aU,aV);
}
function ObjectGetProto(){
return %_GetPrototype(((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this)));
}
function ObjectSetProto(av){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Object.prototype.__proto__");
if(((%_IsSpecObject(av))||(av===null))&&(%_IsSpecObject(this))){
%SetPrototype(this,av);
}
}
function ObjectConstructor(E){
if(%_IsConstructCall()){
if(E==null)return this;
return((%_IsSpecObject(%IS_VAR(E)))?E:$toObject(E));
}else{
if(E==null)return{};
return((%_IsSpecObject(%IS_VAR(E)))?E:$toObject(E));
}
}
%SetNativeFlag(i);
%SetCode(i,ObjectConstructor);
%AddNamedProperty(i.prototype,"constructor",i,
2);
InstallFunctions(i.prototype,2,[
"toString",ObjectToString,
"toLocaleString",ObjectToLocaleString,
"valueOf",ObjectValueOf,
"hasOwnProperty",ObjectHasOwnProperty,
"isPrototypeOf",ObjectIsPrototypeOf,
"propertyIsEnumerable",ObjectPropertyIsEnumerable,
"__defineGetter__",ObjectDefineGetter,
"__lookupGetter__",ObjectLookupGetter,
"__defineSetter__",ObjectDefineSetter,
"__lookupSetter__",ObjectLookupSetter
]);
InstallGetterSetter(i.prototype,"__proto__",ObjectGetProto,
ObjectSetProto);
InstallFunctions(i,2,[
"keys",ObjectKeys,
"create",ObjectCreate,
"defineProperty",ObjectDefineProperty,
"defineProperties",ObjectDefineProperties,
"freeze",ObjectFreezeJS,
"getPrototypeOf",ObjectGetPrototypeOf,
"setPrototypeOf",ObjectSetPrototypeOf,
"getOwnPropertyDescriptor",ObjectGetOwnPropertyDescriptor,
"getOwnPropertyNames",ObjectGetOwnPropertyNames,
"is",ObjectIs,
"isExtensible",ObjectIsExtensible,
"isFrozen",ObjectIsFrozen,
"isSealed",ObjectIsSealed,
"preventExtensions",ObjectPreventExtension,
"seal",ObjectSealJS
]);
function BooleanConstructor(E){
if(%_IsConstructCall()){
%_SetValueOf(this,$toBoolean(E));
}else{
return $toBoolean(E);
}
}
function BooleanToString(){
var aW=this;
if(!(typeof(aW)==='boolean')){
if(!(%_ClassOf(aW)==='Boolean')){
throw MakeTypeError(37,'Boolean.prototype.toString');
}
aW=%_ValueOf(aW);
}
return aW?'true':'false';
}
function BooleanValueOf(){
if(!(typeof(this)==='boolean')&&!(%_ClassOf(this)==='Boolean')){
throw MakeTypeError(37,'Boolean.prototype.valueOf');
}
return %_ValueOf(this);
}
%SetCode(e,BooleanConstructor);
%FunctionSetPrototype(e,new e(false));
%AddNamedProperty(e.prototype,"constructor",e,
2);
InstallFunctions(e.prototype,2,[
"toString",BooleanToString,
"valueOf",BooleanValueOf
]);
function NumberConstructor(E){
var T=%_ArgumentsLength()==0?0:$toNumber(E);
if(%_IsConstructCall()){
%_SetValueOf(this,T);
}else{
return T;
}
}
function NumberToStringJS(D){
var B=this;
if(!(typeof(this)==='number')){
if(!(%_ClassOf(this)==='Number')){
throw MakeTypeError(37,'Number.prototype.toString');
}
B=%_ValueOf(this);
}
if((D===(void 0))||D===10){
return %_NumberToString(B);
}
D=(%_IsSmi(%IS_VAR(D))?D:%NumberToInteger($toNumber(D)));
if(D<2||D>36)throw MakeRangeError(105);
return %NumberToRadixString(B,D);
}
function NumberToLocaleString(){
return %_CallFunction(this,NumberToStringJS);
}
function NumberValueOf(){
if(!(typeof(this)==='number')&&!(%_ClassOf(this)==='Number')){
throw MakeTypeError(37,'Number.prototype.valueOf');
}
return %_ValueOf(this);
}
function NumberToFixedJS(aX){
var E=this;
if(!(typeof(this)==='number')){
if(!(%_ClassOf(this)==='Number')){
throw MakeTypeError(23,
"Number.prototype.toFixed",this);
}
E=%_ValueOf(this);
}
var j=(%_IsSmi(%IS_VAR(aX))?aX:%NumberToInteger($toNumber(aX)));
if(j<0||j>20){
throw MakeRangeError(101,"toFixed() digits");
}
if((!%_IsSmi(%IS_VAR(E))&&!(E==E)))return"NaN";
if(E==(1/0))return"Infinity";
if(E==-(1/0))return"-Infinity";
return %NumberToFixed(E,j);
}
function NumberToExponentialJS(aX){
var E=this;
if(!(typeof(this)==='number')){
if(!(%_ClassOf(this)==='Number')){
throw MakeTypeError(23,
"Number.prototype.toExponential",this);
}
E=%_ValueOf(this);
}
var j=(aX===(void 0))?(void 0):(%_IsSmi(%IS_VAR(aX))?aX:%NumberToInteger($toNumber(aX)));
if((!%_IsSmi(%IS_VAR(E))&&!(E==E)))return"NaN";
if(E==(1/0))return"Infinity";
if(E==-(1/0))return"-Infinity";
if((j===(void 0))){
j=-1;
}else if(j<0||j>20){
throw MakeRangeError(101,"toExponential()");
}
return %NumberToExponential(E,j);
}
function NumberToPrecisionJS(aY){
var E=this;
if(!(typeof(this)==='number')){
if(!(%_ClassOf(this)==='Number')){
throw MakeTypeError(23,
"Number.prototype.toPrecision",this);
}
E=%_ValueOf(this);
}
if((aY===(void 0)))return $toString(%_ValueOf(this));
var ac=(%_IsSmi(%IS_VAR(aY))?aY:%NumberToInteger($toNumber(aY)));
if((!%_IsSmi(%IS_VAR(E))&&!(E==E)))return"NaN";
if(E==(1/0))return"Infinity";
if(E==-(1/0))return"-Infinity";
if(ac<1||ac>21){
throw MakeRangeError(104);
}
return %NumberToPrecision(E,ac);
}
function NumberIsFinite(B){
return(typeof(B)==='number')&&(%_IsSmi(%IS_VAR(B))||((B==B)&&(B!=1/0)&&(B!=-1/0)));
}
function NumberIsInteger(B){
return NumberIsFinite(B)&&(%_IsSmi(%IS_VAR(B))?B:%NumberToInteger($toNumber(B)))==B;
}
function NumberIsNaN(B){
return(typeof(B)==='number')&&(!%_IsSmi(%IS_VAR(B))&&!(B==B));
}
function NumberIsSafeInteger(B){
if(NumberIsFinite(B)){
var aZ=(%_IsSmi(%IS_VAR(B))?B:%NumberToInteger($toNumber(B)));
if(aZ==B){
return $abs(aZ)<=h.MAX_SAFE_INTEGER;
}
}
return false;
}
%SetCode(h,NumberConstructor);
%FunctionSetPrototype(h,new h(0));
%OptimizeObjectForAddingMultipleProperties(h.prototype,8);
%AddNamedProperty(h.prototype,"constructor",h,
2);
InstallConstants(h,[
"MAX_VALUE",1.7976931348623157e+308,
"MIN_VALUE",5e-324,
"NaN",$NaN,
"NEGATIVE_INFINITY",-(1/0),
"POSITIVE_INFINITY",(1/0),
"MAX_SAFE_INTEGER",%_MathPow(2,53)-1,
"MIN_SAFE_INTEGER",-%_MathPow(2,53)+1,
"EPSILON",%_MathPow(2,-52)
]);
InstallFunctions(h.prototype,2,[
"toString",NumberToStringJS,
"toLocaleString",NumberToLocaleString,
"valueOf",NumberValueOf,
"toFixed",NumberToFixedJS,
"toExponential",NumberToExponentialJS,
"toPrecision",NumberToPrecisionJS
]);
InstallFunctions(h,2,[
"isFinite",NumberIsFinite,
"isInteger",NumberIsInteger,
"isNaN",NumberIsNaN,
"isSafeInteger",NumberIsSafeInteger,
"parseInt",GlobalParseInt,
"parseFloat",GlobalParseFloat
]);
%SetInlineBuiltinFlag(NumberIsNaN);
function NativeCodeFunctionSourceString(ag){
var k=%FunctionGetName(ag);
if(k){
return'function '+k+'() { [native code] }';
}
return'function () { [native code] }';
}
function FunctionSourceString(ag){
while(%IsJSFunctionProxy(ag)){
ag=%GetCallTrap(ag);
}
if(!(%_IsFunction(ag))){
throw MakeTypeError(37,'Function.prototype.toString');
}
if(%FunctionIsBuiltin(ag)){
return NativeCodeFunctionSourceString(ag);
}
var ba=%ClassGetSourceCode(ag);
if((typeof(ba)==='string')){
return ba;
}
var bb=%FunctionGetSourceCode(ag);
if(!(typeof(bb)==='string')){
return NativeCodeFunctionSourceString(ag);
}
if(%FunctionIsArrow(ag)){
return bb;
}
var k=%FunctionNameShouldPrintAsAnonymous(ag)
?'anonymous'
:%FunctionGetName(ag);
var bc=%FunctionIsGenerator(ag);
var bd=%FunctionIsConciseMethod(ag)
?(bc?'*':'')
:(bc?'function* ':'function ');
return bd+k+bb;
}
function FunctionToString(){
return FunctionSourceString(this);
}
function FunctionBind(be){
if(!(%_ClassOf(this)==='Function'))throw MakeTypeError(21);
var bf=function(){
"use strict";
if(%_IsConstructCall()){
return %NewObjectFromBound(bf);
}
var bg=%BoundFunctionGetBindings(bf);
var bh=%_ArgumentsLength();
if(bh==0){
return %Apply(bg[0],bg[1],bg,2,bg.length-2);
}
if(bg.length===2){
return %Apply(bg[0],bg[1],arguments,0,bh);
}
var bi=bg.length-2;
var bj=new InternalArray(bi+bh);
for(var p=0;p<bi;p++){
bj[p]=bg[p+2];
}
for(var aJ=0;aJ<bh;aJ++){
bj[p++]=%_Arguments(aJ);
}
return %Apply(bg[0],bg[1],bj,0,bi+bh);
};
var ao=0;
var an=this.length;
if((typeof an==="number")&&
((an>>>0)===an)){
var bh=%_ArgumentsLength();
if(bh>0)bh--;
ao=an-bh;
if(ao<0)ao=0;
}
var ah=%FunctionBindArguments(bf,this,
be,ao);
return ah;
}
function NewFunctionString(bk,bl){
var ax=bk.length;
var ac='';
if(ax>1){
ac=$toString(bk[0]);
for(var p=1;p<ax-1;p++){
ac+=','+$toString(bk[p]);
}
if(%_CallFunction(ac,')',$stringIndexOf)!=-1){
throw MakeSyntaxError(110);
}
ac+='\n/'+'**/';
}
var bm=(ax>0)?$toString(bk[ax-1]):'';
return'('+bl+'('+ac+') {\n'+bm+'\n})';
}
function FunctionConstructor(bn){
var bb=NewFunctionString(arguments,'function');
var F=%GlobalProxy(FunctionConstructor);
var j=%_CallFunction(F,%CompileString(bb,true));
%FunctionMarkNameShouldPrintAsAnonymous(j);
return j;
}
%SetCode(g,FunctionConstructor);
%AddNamedProperty(g.prototype,"constructor",g,
2);
InstallFunctions(g.prototype,2,[
"bind",FunctionBind,
"toString",FunctionToString
]);
function GetIterator(P,bo){
if((bo===(void 0))){
bo=P[symbolIterator];
}
if(!(%_ClassOf(bo)==='Function')){
throw MakeTypeError(38,P);
}
var bp=%_CallFunction(P,bo);
if(!(%_IsSpecObject(bp))){
throw MakeTypeError(34,bp);
}
return bp;
}
$delete=Delete;
$functionSourceString=FunctionSourceString;
$getIterator=GetIterator;
$getMethod=GetMethod;
$globalEval=GlobalEval;
$installConstants=InstallConstants;
$installFunctions=InstallFunctions;
$installGetter=InstallGetter;
$isFinite=GlobalIsFinite;
$isNaN=GlobalIsNaN;
$newFunctionString=NewFunctionString;
$numberIsNaN=NumberIsNaN;
$objectDefineProperties=ObjectDefineProperties;
$objectDefineProperty=ObjectDefineProperty;
$objectFreeze=ObjectFreezeJS;
$objectGetOwnPropertyDescriptor=ObjectGetOwnPropertyDescriptor;
$objectGetOwnPropertyKeys=ObjectGetOwnPropertyKeys;
$objectHasOwnProperty=ObjectHasOwnProperty;
$objectIsFrozen=ObjectIsFrozen;
$objectIsSealed=ObjectIsSealed;
$objectLookupGetter=ObjectLookupGetter;
$objectLookupSetter=ObjectLookupSetter;
$objectToString=ObjectToString;
$overrideFunction=OverrideFunction;
$ownPropertyKeys=OwnPropertyKeys;
$setFunctionName=SetFunctionName;
$setUpLockedPrototype=SetUpLockedPrototype;
$toCompletePropertyDescriptor=ToCompletePropertyDescriptor;
$toNameArray=ToNameArray;
})

symbolµ
var $symbolToString;
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Object;
var e=a.Symbol;
function SymbolConstructor(g){
if(%_IsConstructCall())throw MakeTypeError(36,"Symbol");
return %CreateSymbol((g===(void 0))?g:$toString(g));
}
function SymbolToString(){
if(!((typeof(this)==='symbol')||(%_ClassOf(this)==='Symbol'))){
throw MakeTypeError(23,
"Symbol.prototype.toString",this);
}
var h=%SymbolDescription(%_ValueOf(this));
return"Symbol("+((h===(void 0))?"":h)+")";
}
function SymbolValueOf(){
if(!((typeof(this)==='symbol')||(%_ClassOf(this)==='Symbol'))){
throw MakeTypeError(23,
"Symbol.prototype.valueOf",this);
}
return %_ValueOf(this);
}
function SymbolFor(i){
i=((typeof(%IS_VAR(i))==='string')?i:$nonStringToString(i));
var j=%SymbolRegistry();
if((j.for[i]===(void 0))){
var k=%CreateSymbol(i);
j.for[i]=k;
j.keyFor[k]=i;
}
return j.for[i];
}
function SymbolKeyFor(k){
if(!(typeof(k)==='symbol'))throw MakeTypeError("not_a_symbol",[k]);
return %SymbolRegistry().keyFor[k];
}
function ObjectGetOwnPropertySymbols(l){
l=$toObject(l);
return $objectGetOwnPropertyKeys(l,8);
}
%SetCode(e,SymbolConstructor);
%FunctionSetPrototype(e,new d());
$installConstants(e,[
"iterator",symbolIterator,
"unscopables",symbolUnscopables
]);
$installFunctions(e,2,[
"for",SymbolFor,
"keyFor",SymbolKeyFor
]);
%AddNamedProperty(
e.prototype,"constructor",e,2);
%AddNamedProperty(
e.prototype,symbolToStringTag,"Symbol",2|1);
$installFunctions(e.prototype,2,[
"toString",SymbolToString,
"valueOf",SymbolValueOf
]);
$installFunctions(d,2,[
"getOwnPropertySymbols",ObjectGetOwnPropertySymbols
]);
$symbolToString=SymbolToString;
})

array}
var $arrayConcat;
var $arrayJoin;
var $arrayPush;
var $arrayPop;
var $arrayShift;
var $arraySlice;
var $arraySplice;
var $arrayUnshift;
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Array;
var e=new InternalArray();
function GetSortedArrayKeys(g,h){
var i=new InternalArray();
if((typeof(h)==='number')){
var j=h;
for(var k=0;k<j;++k){
var l=g[k];
if(!(l===(void 0))||k in g){
i.push(k);
}
}
}else{
var m=h.length;
for(var n=0;n<m;++n){
var o=h[n];
if(!(o===(void 0))){
var l=g[o];
if(!(l===(void 0))||o in g){
i.push(o);
}
}
}
%_CallFunction(i,function(p,q){return p-q;},ArraySort);
}
return i;
}
function SparseJoinWithSeparatorJS(g,r,t,u){
var i=GetSortedArrayKeys(g,%GetArrayKeys(g,r));
var v=0;
var w=new InternalArray(i.length*2);
var x=-1;
for(var k=0;k<i.length;k++){
var o=i[k];
if(o!=x){
var l=g[o];
if(!(typeof(l)==='string'))l=t(l);
w[k*2]=o;
w[k*2+1]=l;
x=o;
}
}
return %SparseJoinWithSeparator(w,r,u);
}
function SparseJoin(g,r,t){
var i=GetSortedArrayKeys(g,%GetArrayKeys(g,r));
var y=-1;
var z=i.length;
var w=new InternalArray(z);
var A=0;
for(var k=0;k<z;k++){
var o=i[k];
if(o!=y){
var l=g[o];
if(!(typeof(l)==='string'))l=t(l);
w[A++]=l;
y=o;
}
}
return %StringBuilderConcat(w,A,'');
}
function UseSparseVariant(g,m,B,C){
if(!B||m<1000||%IsObserved(g)||
%HasComplexElements(g)){
return false;
}
if(!%_IsSmi(m)){
return true;
}
var D=m>>2;
var E=%EstimateNumberOfElements(g);
return(E<D)&&
(C>E*4);
}
function Join(g,m,u,t){
if(m==0)return'';
var B=(%_IsArray(g));
if(B){
if(!%PushIfAbsent(e,g))return'';
}
try{
if(UseSparseVariant(g,m,B,m)){
%NormalizeElements(g);
if(u.length==0){
return SparseJoin(g,m,t);
}else{
return SparseJoinWithSeparatorJS(g,m,t,u);
}
}
if(m==1){
var l=g[0];
if((typeof(l)==='string'))return l;
return t(l);
}
var w=new InternalArray(m);
if(u.length==0){
var A=0;
for(var k=0;k<m;k++){
var l=g[k];
if(!(typeof(l)==='string'))l=t(l);
w[A++]=l;
}
w.length=A;
var F=%_FastOneByteArrayJoin(w,'');
if(!(F===(void 0)))return F;
return %StringBuilderConcat(w,A,'');
}
if(!(typeof(g[0])==='number')){
for(var k=0;k<m;k++){
var l=g[k];
if(!(typeof(l)==='string'))l=t(l);
w[k]=l;
}
}else{
for(var k=0;k<m;k++){
var l=g[k];
if((typeof(l)==='number')){
l=%_NumberToString(l);
}else if(!(typeof(l)==='string')){
l=t(l);
}
w[k]=l;
}
}
var F=%_FastOneByteArrayJoin(w,u);
if(!(F===(void 0)))return F;
return %StringBuilderJoin(w,m,u);
}finally{
if(B)e.length=e.length-1;
}
}
function ConvertToString(G){
if((typeof(G)==='number'))return %_NumberToString(G);
if((typeof(G)==='boolean'))return G?'true':'false';
return((G==null))?'':$toString($defaultString(G));
}
function ConvertToLocaleString(l){
if((l==null)){
return'';
}else{
var H=$toObject(l);
return $toString(H.toLocaleString());
}
}
function SparseSlice(g,I,J,r,K){
var h=%GetArrayKeys(g,I+J);
if((typeof(h)==='number')){
var j=h;
for(var k=I;k<j;++k){
var L=g[k];
if(!(L===(void 0))||k in g){
%AddElement(K,k-I,L,0);
}
}
}else{
var m=h.length;
for(var n=0;n<m;++n){
var o=h[n];
if(!(o===(void 0))){
if(o>=I){
var L=g[o];
if(!(L===(void 0))||o in g){
%AddElement(K,o-I,L,0);
}
}
}
}
}
}
function SparseMove(g,I,J,r,M){
if(M===J)return;
var N=new InternalArray(
$min(r-J+M,0xffffffff));
var O;
var h=%GetArrayKeys(g,r);
if((typeof(h)==='number')){
var j=h;
for(var k=0;k<I&&k<j;++k){
var L=g[k];
if(!(L===(void 0))||k in g){
N[k]=L;
}
}
for(var k=I+J;k<j;++k){
var L=g[k];
if(!(L===(void 0))||k in g){
N[k-J+M]=L;
}
}
}else{
var m=h.length;
for(var n=0;n<m;++n){
var o=h[n];
if(!(o===(void 0))){
if(o<I){
var L=g[o];
if(!(L===(void 0))||o in g){
N[o]=L;
}
}else if(o>=I+J){
var L=g[o];
if(!(L===(void 0))||o in g){
var P=o-J+M;
N[P]=L;
if(P>0xffffffff){
O=O||new InternalArray();
O.push(P);
}
}
}
}
}
}
%MoveArrayContents(N,g);
if(!(O===(void 0))){
var m=O.length;
for(var k=0;k<m;++k){
var o=O[k];
g[o]=N[o];
}
}
}
function SimpleSlice(g,I,J,r,K){
var B=(%_IsArray(g));
for(var k=0;k<J;k++){
var Q=I+k;
if(((B&&%_HasFastPackedElements(%IS_VAR(g)))?(Q<g.length):(Q in g))){
var L=g[Q];
%AddElement(K,k,L,0);
}
}
}
function SimpleMove(g,I,J,r,M){
var B=(%_IsArray(g));
if(M!==J){
if(M>J){
for(var k=r-J;k>I;k--){
var R=k+J-1;
var S=k+M-1;
if(((B&&%_HasFastPackedElements(%IS_VAR(g)))?(R<g.length):(R in g))){
g[S]=g[R];
}else{
delete g[S];
}
}
}else{
for(var k=I;k<r-J;k++){
var R=k+J;
var S=k+M;
if(((B&&%_HasFastPackedElements(%IS_VAR(g)))?(R<g.length):(R in g))){
g[S]=g[R];
}else{
delete g[S];
}
}
for(var k=r;k>r-J+M;k--){
delete g[k-1];
}
}
}
}
function ArrayToString(){
var g;
var T;
if((%_IsArray(this))){
T=this.join;
if(T===ArrayJoin){
return Join(this,this.length,',',ConvertToString);
}
g=this;
}else{
g=$toObject(this);
T=g.join;
}
if(!(%_ClassOf(T)==='Function')){
return %_CallFunction(g,$objectToString);
}
return %_CallFunction(g,T);
}
function ArrayToLocaleString(){
var g=$toObject(this);
var U=g.length;
var r=(U>>>0);
if(r===0)return"";
return Join(g,r,',',ConvertToLocaleString);
}
function ArrayJoin(u){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.join");
var g=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var m=(g.length>>>0);
if((u===(void 0))){
u=',';
}else if(!(typeof(u)==='string')){
u=$nonStringToString(u);
}
var F=%_FastOneByteArrayJoin(g,u);
if(!(F===(void 0)))return F;
if(m===1){
var l=g[0];
if((typeof(l)==='string'))return l;
if((l==null))return'';
return $nonStringToString(l);
}
return Join(g,m,u,ConvertToString);
}
function ObservedArrayPop(V){
V--;
var W=this[V];
try{
$observeBeginPerformSplice(this);
delete this[V];
this.length=V;
}finally{
$observeEndPerformSplice(this);
$observeEnqueueSpliceRecord(this,V,[W],0);
}
return W;
}
function ArrayPop(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.pop");
var g=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var V=(g.length>>>0);
if(V==0){
g.length=V;
return;
}
if(%IsObserved(g))
return ObservedArrayPop.call(g,V);
V--;
var W=g[V];
$delete(g,$toName(V),true);
g.length=V;
return W;
}
function ObservedArrayPush(){
var V=(this.length>>>0);
var X=%_ArgumentsLength();
try{
$observeBeginPerformSplice(this);
for(var k=0;k<X;k++){
this[k+V]=%_Arguments(k);
}
var Y=V+X;
this.length=Y;
}finally{
$observeEndPerformSplice(this);
$observeEnqueueSpliceRecord(this,V,[],X);
}
return Y;
}
function ArrayPush(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.push");
if(%IsObserved(this))
return ObservedArrayPush.apply(this,arguments);
var g=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var V=(g.length>>>0);
var X=%_ArgumentsLength();
for(var k=0;k<X;k++){
g[k+V]=%_Arguments(k);
}
var Y=V+X;
g.length=Y;
return Y;
}
function ArrayConcatJS(Z){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.concat");
var g=$toObject(this);
var aa=%_ArgumentsLength();
var ab=new InternalArray(1+aa);
ab[0]=g;
for(var k=0;k<aa;k++){
ab[k+1]=%_Arguments(k);
}
return %ArrayConcat(ab);
}
function SparseReverse(g,r){
var i=GetSortedArrayKeys(g,%GetArrayKeys(g,r));
var ac=i.length-1;
var ad=0;
while(ad<=ac){
var k=i[ad];
var ae=i[ac];
var af=r-ae-1;
var ag,ah;
if(af<=k){
ah=ae;
while(i[--ac]==ae){}
ag=af;
}
if(af>=k){
ag=k;
while(i[++ad]==k){}
ah=r-k-1;
}
var ai=g[ag];
if(!(ai===(void 0))||ag in g){
var aj=g[ah];
if(!(aj===(void 0))||ah in g){
g[ag]=aj;
g[ah]=ai;
}else{
g[ah]=ai;
delete g[ag];
}
}else{
var aj=g[ah];
if(!(aj===(void 0))||ah in g){
g[ag]=aj;
delete g[ah];
}
}
}
}
function ArrayReverse(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.reverse");
var g=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var r=(g.length>>>0);
if(UseSparseVariant(g,r,(%_IsArray(g)),r)){
%NormalizeElements(g);
SparseReverse(g,r);
return g;
}
var ae=r-1;
for(var k=0;k<ae;k++,ae--){
var ai=g[k];
if(!(ai===(void 0))||k in g){
var aj=g[ae];
if(!(aj===(void 0))||ae in g){
g[k]=aj;
g[ae]=ai;
}else{
g[ae]=ai;
delete g[k];
}
}else{
var aj=g[ae];
if(!(aj===(void 0))||ae in g){
g[k]=aj;
delete g[ae];
}
}
}
return g;
}
function ObservedArrayShift(r){
var ak=this[0];
try{
$observeBeginPerformSplice(this);
SimpleMove(this,0,1,r,0);
this.length=r-1;
}finally{
$observeEndPerformSplice(this);
$observeEnqueueSpliceRecord(this,0,[ak],0);
}
return ak;
}
function ArrayShift(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.shift");
var g=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var r=(g.length>>>0);
if(r===0){
g.length=0;
return;
}
if($objectIsSealed(g))throw MakeTypeError(7);
if(%IsObserved(g))
return ObservedArrayShift.call(g,r);
var ak=g[0];
if(UseSparseVariant(g,r,(%_IsArray(g)),r)){
SparseMove(g,0,1,r,0);
}else{
SimpleMove(g,0,1,r,0);
}
g.length=r-1;
return ak;
}
function ObservedArrayUnshift(){
var r=(this.length>>>0);
var al=%_ArgumentsLength();
try{
$observeBeginPerformSplice(this);
SimpleMove(this,0,0,r,al);
for(var k=0;k<al;k++){
this[k]=%_Arguments(k);
}
var Y=r+al;
this.length=Y;
}finally{
$observeEndPerformSplice(this);
$observeEnqueueSpliceRecord(this,0,[],al);
}
return Y;
}
function ArrayUnshift(Z){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.unshift");
if(%IsObserved(this))
return ObservedArrayUnshift.apply(this,arguments);
var g=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var r=(g.length>>>0);
var al=%_ArgumentsLength();
if(r>0&&UseSparseVariant(g,r,(%_IsArray(g)),r)&&
!$objectIsSealed(g)){
SparseMove(g,0,0,r,al);
}else{
SimpleMove(g,0,0,r,al);
}
for(var k=0;k<al;k++){
g[k]=%_Arguments(k);
}
var Y=r+al;
g.length=Y;
return Y;
}
function ArraySlice(am,an){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.slice");
var g=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var r=(g.length>>>0);
var I=(%_IsSmi(%IS_VAR(am))?am:%NumberToInteger($toNumber(am)));
var ao=r;
if(!(an===(void 0)))ao=(%_IsSmi(%IS_VAR(an))?an:%NumberToInteger($toNumber(an)));
if(I<0){
I+=r;
if(I<0)I=0;
}else{
if(I>r)I=r;
}
if(ao<0){
ao+=r;
if(ao<0)ao=0;
}else{
if(ao>r)ao=r;
}
var F=[];
if(ao<I)return F;
if(UseSparseVariant(g,r,(%_IsArray(g)),ao-I)){
%NormalizeElements(g);
%NormalizeElements(F);
SparseSlice(g,I,ao-I,r,F);
}else{
SimpleSlice(g,I,ao-I,r,F);
}
F.length=ao-I;
return F;
}
function ComputeSpliceStartIndex(I,r){
if(I<0){
I+=r;
return I<0?0:I;
}
return I>r?r:I;
}
function ComputeSpliceDeleteCount(ap,al,r,I){
var J=0;
if(al==1)
return r-I;
J=(%_IsSmi(%IS_VAR(ap))?ap:%NumberToInteger($toNumber(ap)));
if(J<0)
return 0;
if(J>r-I)
return r-I;
return J;
}
function ObservedArraySplice(am,ap){
var al=%_ArgumentsLength();
var r=(this.length>>>0);
var I=ComputeSpliceStartIndex((%_IsSmi(%IS_VAR(am))?am:%NumberToInteger($toNumber(am))),r);
var J=ComputeSpliceDeleteCount(ap,al,r,
I);
var K=[];
K.length=J;
var aq=al>2?al-2:0;
try{
$observeBeginPerformSplice(this);
SimpleSlice(this,I,J,r,K);
SimpleMove(this,I,J,r,aq);
var k=I;
var ar=2;
var as=%_ArgumentsLength();
while(ar<as){
this[k++]=%_Arguments(ar++);
}
this.length=r-J+aq;
}finally{
$observeEndPerformSplice(this);
if(K.length||aq){
$observeEnqueueSpliceRecord(this,
I,
K.slice(),
aq);
}
}
return K;
}
function ArraySplice(am,ap){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.splice");
if(%IsObserved(this))
return ObservedArraySplice.apply(this,arguments);
var al=%_ArgumentsLength();
var g=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var r=(g.length>>>0);
var I=ComputeSpliceStartIndex((%_IsSmi(%IS_VAR(am))?am:%NumberToInteger($toNumber(am))),r);
var J=ComputeSpliceDeleteCount(ap,al,r,
I);
var K=[];
K.length=J;
var aq=al>2?al-2:0;
if(J!=aq&&$objectIsSealed(g)){
throw MakeTypeError(7);
}else if(J>0&&$objectIsFrozen(g)){
throw MakeTypeError(6);
}
var at=J;
if(aq!=J){
at+=r-I-J;
}
if(UseSparseVariant(g,r,(%_IsArray(g)),at)){
%NormalizeElements(g);
%NormalizeElements(K);
SparseSlice(g,I,J,r,K);
SparseMove(g,I,J,r,aq);
}else{
SimpleSlice(g,I,J,r,K);
SimpleMove(g,I,J,r,aq);
}
var k=I;
var ar=2;
var as=%_ArgumentsLength();
while(ar<as){
g[k++]=%_Arguments(ar++);
}
g.length=r-J+aq;
return K;
}
function ArraySort(au){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.sort");
if(!(%_ClassOf(au)==='Function')){
au=function(G,av){
if(G===av)return 0;
if(%_IsSmi(G)&&%_IsSmi(av)){
return %SmiLexicographicCompare(G,av);
}
G=$toString(G);
av=$toString(av);
if(G==av)return 0;
else return G<av?-1:1;
};
}
var aw=function InsertionSort(p,ax,ay){
for(var k=ax+1;k<ay;k++){
var az=p[k];
for(var ae=k-1;ae>=ax;ae--){
var aA=p[ae];
var aB=%_CallFunction((void 0),aA,az,au);
if(aB>0){
p[ae+1]=aA;
}else{
break;
}
}
p[ae+1]=az;
}
};
var aC=function(p,ax,ay){
var aD=[];
var aE=200+((ay-ax)&15);
for(var k=ax+1,ae=0;k<ay-1;k+=aE,ae++){
aD[ae]=[k,p[k]];
}
%_CallFunction(aD,function(p,q){
return %_CallFunction((void 0),p[1],q[1],au);
},ArraySort);
var aF=aD[aD.length>>1][0];
return aF;
}
var aG=function QuickSort(p,ax,ay){
var aF=0;
while(true){
if(ay-ax<=10){
aw(p,ax,ay);
return;
}
if(ay-ax>1000){
aF=aC(p,ax,ay);
}else{
aF=ax+((ay-ax)>>1);
}
var aH=p[ax];
var aI=p[ay-1];
var aJ=p[aF];
var aK=%_CallFunction((void 0),aH,aI,au);
if(aK>0){
var aA=aH;
aH=aI;
aI=aA;
}
var aL=%_CallFunction((void 0),aH,aJ,au);
if(aL>=0){
var aA=aH;
aH=aJ;
aJ=aI;
aI=aA;
}else{
var aM=%_CallFunction((void 0),aI,aJ,au);
if(aM>0){
var aA=aI;
aI=aJ;
aJ=aA;
}
}
p[ax]=aH;
p[ay-1]=aJ;
var aN=aI;
var aO=ax+1;
var aP=ay-1;
p[aF]=p[aO];
p[aO]=aN;
partition:for(var k=aO+1;k<aP;k++){
var az=p[k];
var aB=%_CallFunction((void 0),az,aN,au);
if(aB<0){
p[k]=p[aO];
p[aO]=az;
aO++;
}else if(aB>0){
do{
aP--;
if(aP==k)break partition;
var aQ=p[aP];
aB=%_CallFunction((void 0),aQ,aN,au);
}while(aB>0);
p[k]=p[aP];
p[aP]=az;
if(aB<0){
az=p[k];
p[k]=p[aO];
p[aO]=az;
aO++;
}
}
}
if(ay-aP<aO-ax){
aG(p,aP,ay);
ay=aO;
}else{
aG(p,ax,aO);
ax=aP;
}
}
};
var aR=function CopyFromPrototype(aS,m){
var aT=0;
for(var aU=%_GetPrototype(aS);aU;aU=%_GetPrototype(aU)){
var h=%GetArrayKeys(aU,m);
if((typeof(h)==='number')){
var aV=h;
for(var k=0;k<aV;k++){
if(!(%_CallFunction(aS,k,$objectHasOwnProperty))&&(%_CallFunction(aU,k,$objectHasOwnProperty))){
aS[k]=aU[k];
if(k>=aT){aT=k+1;}
}
}
}else{
for(var k=0;k<h.length;k++){
var Q=h[k];
if(!(Q===(void 0))&&!(%_CallFunction(aS,Q,$objectHasOwnProperty))
&&(%_CallFunction(aU,Q,$objectHasOwnProperty))){
aS[Q]=aU[Q];
if(Q>=aT){aT=Q+1;}
}
}
}
}
return aT;
};
var aW=function(aS,ax,ay){
for(var aU=%_GetPrototype(aS);aU;aU=%_GetPrototype(aU)){
var h=%GetArrayKeys(aU,ay);
if((typeof(h)==='number')){
var aV=h;
for(var k=ax;k<aV;k++){
if((%_CallFunction(aU,k,$objectHasOwnProperty))){
aS[k]=(void 0);
}
}
}else{
for(var k=0;k<h.length;k++){
var Q=h[k];
if(!(Q===(void 0))&&ax<=Q&&
(%_CallFunction(aU,Q,$objectHasOwnProperty))){
aS[Q]=(void 0);
}
}
}
}
};
var aX=function SafeRemoveArrayHoles(aS){
var aY=0;
var aZ=m-1;
var ba=0;
while(aY<aZ){
while(aY<aZ&&
!(aS[aY]===(void 0))){
aY++;
}
if(!(%_CallFunction(aS,aY,$objectHasOwnProperty))){
ba++;
}
while(aY<aZ&&
(aS[aZ]===(void 0))){
if(!(%_CallFunction(aS,aZ,$objectHasOwnProperty))){
ba++;
}
aZ--;
}
if(aY<aZ){
aS[aY]=aS[aZ];
aS[aZ]=(void 0);
}
}
if(!(aS[aY]===(void 0)))aY++;
var k;
for(k=aY;k<m-ba;k++){
aS[k]=(void 0);
}
for(k=m-ba;k<m;k++){
if(k in %_GetPrototype(aS)){
aS[k]=(void 0);
}else{
delete aS[k];
}
}
return aY;
};
var m=(this.length>>>0);
if(m<2)return this;
var B=(%_IsArray(this));
var bb;
if(!B){
bb=aR(this,m);
}
var bc=%RemoveArrayHoles(this,m);
if(bc==-1){
bc=aX(this);
}
aG(this,0,bc);
if(!B&&(bc+1<bb)){
aW(this,bc,bb);
}
return this;
}
function ArrayFilter(bd,be){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.filter");
var g=$toObject(this);
var m=$toUint32(g.length);
if(!(%_ClassOf(bd)==='Function'))throw MakeTypeError(9,bd);
var bf=false;
if((be===null)){
if(%IsSloppyModeFunction(bd))be=(void 0);
}else if(!(be===(void 0))){
bf=(!(%_IsSpecObject(be))&&%IsSloppyModeFunction(bd));
}
var F=new d();
var bg=new InternalArray();
var bh=0;
var B=(%_IsArray(g));
var bi=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(bd);
for(var k=0;k<m;k++){
if(((B&&%_HasFastPackedElements(%IS_VAR(g)))?(k<g.length):(k in g))){
var az=g[k];
if(bi)%DebugPrepareStepInIfStepping(bd);
var bj=bf?$toObject(be):be;
if(%_CallFunction(bj,az,k,g,bd)){
bg[bh++]=az;
}
}
}
%MoveArrayContents(bg,F);
return F;
}
function ArrayForEach(bd,be){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.forEach");
var g=$toObject(this);
var m=(g.length>>>0);
if(!(%_ClassOf(bd)==='Function'))throw MakeTypeError(9,bd);
var bf=false;
if((be===null)){
if(%IsSloppyModeFunction(bd))be=(void 0);
}else if(!(be===(void 0))){
bf=(!(%_IsSpecObject(be))&&%IsSloppyModeFunction(bd));
}
var B=(%_IsArray(g));
var bi=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(bd);
for(var k=0;k<m;k++){
if(((B&&%_HasFastPackedElements(%IS_VAR(g)))?(k<g.length):(k in g))){
var az=g[k];
if(bi)%DebugPrepareStepInIfStepping(bd);
var bj=bf?$toObject(be):be;
%_CallFunction(bj,az,k,g,bd);
}
}
}
function ArraySome(bd,be){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.some");
var g=$toObject(this);
var m=(g.length>>>0);
if(!(%_ClassOf(bd)==='Function'))throw MakeTypeError(9,bd);
var bf=false;
if((be===null)){
if(%IsSloppyModeFunction(bd))be=(void 0);
}else if(!(be===(void 0))){
bf=(!(%_IsSpecObject(be))&&%IsSloppyModeFunction(bd));
}
var B=(%_IsArray(g));
var bi=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(bd);
for(var k=0;k<m;k++){
if(((B&&%_HasFastPackedElements(%IS_VAR(g)))?(k<g.length):(k in g))){
var az=g[k];
if(bi)%DebugPrepareStepInIfStepping(bd);
var bj=bf?$toObject(be):be;
if(%_CallFunction(bj,az,k,g,bd))return true;
}
}
return false;
}
function ArrayEvery(bd,be){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.every");
var g=$toObject(this);
var m=(g.length>>>0);
if(!(%_ClassOf(bd)==='Function'))throw MakeTypeError(9,bd);
var bf=false;
if((be===null)){
if(%IsSloppyModeFunction(bd))be=(void 0);
}else if(!(be===(void 0))){
bf=(!(%_IsSpecObject(be))&&%IsSloppyModeFunction(bd));
}
var B=(%_IsArray(g));
var bi=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(bd);
for(var k=0;k<m;k++){
if(((B&&%_HasFastPackedElements(%IS_VAR(g)))?(k<g.length):(k in g))){
var az=g[k];
if(bi)%DebugPrepareStepInIfStepping(bd);
var bj=bf?$toObject(be):be;
if(!%_CallFunction(bj,az,k,g,bd))return false;
}
}
return true;
}
function ArrayMap(bd,be){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.map");
var g=$toObject(this);
var m=(g.length>>>0);
if(!(%_ClassOf(bd)==='Function'))throw MakeTypeError(9,bd);
var bf=false;
if((be===null)){
if(%IsSloppyModeFunction(bd))be=(void 0);
}else if(!(be===(void 0))){
bf=(!(%_IsSpecObject(be))&&%IsSloppyModeFunction(bd));
}
var F=new d();
var bg=new InternalArray(m);
var B=(%_IsArray(g));
var bi=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(bd);
for(var k=0;k<m;k++){
if(((B&&%_HasFastPackedElements(%IS_VAR(g)))?(k<g.length):(k in g))){
var az=g[k];
if(bi)%DebugPrepareStepInIfStepping(bd);
var bj=bf?$toObject(be):be;
bg[k]=%_CallFunction(bj,az,k,g,bd);
}
}
%MoveArrayContents(bg,F);
return F;
}
function ArrayIndexOf(az,Q){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.indexOf");
var m=(this.length>>>0);
if(m==0)return-1;
if((Q===(void 0))){
Q=0;
}else{
Q=(%_IsSmi(%IS_VAR(Q))?Q:%NumberToInteger($toNumber(Q)));
if(Q<0){
Q=m+Q;
if(Q<0)Q=0;
}
}
var bk=Q;
var aT=m;
if(UseSparseVariant(this,m,(%_IsArray(this)),aT-bk)){
%NormalizeElements(this);
var h=%GetArrayKeys(this,m);
if((typeof(h)==='number')){
aT=h;
}else{
if(h.length==0)return-1;
var bl=GetSortedArrayKeys(this,h);
var V=bl.length;
var k=0;
while(k<V&&bl[k]<Q)k++;
while(k<V){
var o=bl[k];
if(!(o===(void 0))&&this[o]===az)return o;
k++;
}
return-1;
}
}
if(!(az===(void 0))){
for(var k=bk;k<aT;k++){
if(this[k]===az)return k;
}
return-1;
}
for(var k=bk;k<aT;k++){
if((this[k]===(void 0))&&k in this){
return k;
}
}
return-1;
}
function ArrayLastIndexOf(az,Q){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.lastIndexOf");
var m=(this.length>>>0);
if(m==0)return-1;
if(%_ArgumentsLength()<2){
Q=m-1;
}else{
Q=(%_IsSmi(%IS_VAR(Q))?Q:%NumberToInteger($toNumber(Q)));
if(Q<0)Q+=m;
if(Q<0)return-1;
else if(Q>=m)Q=m-1;
}
var bk=0;
var aT=Q;
if(UseSparseVariant(this,m,(%_IsArray(this)),Q)){
%NormalizeElements(this);
var h=%GetArrayKeys(this,Q+1);
if((typeof(h)==='number')){
aT=h;
}else{
if(h.length==0)return-1;
var bl=GetSortedArrayKeys(this,h);
var k=bl.length-1;
while(k>=0){
var o=bl[k];
if(!(o===(void 0))&&this[o]===az)return o;
k--;
}
return-1;
}
}
if(!(az===(void 0))){
for(var k=aT;k>=bk;k--){
if(this[k]===az)return k;
}
return-1;
}
for(var k=aT;k>=bk;k--){
if((this[k]===(void 0))&&k in this){
return k;
}
}
return-1;
}
function ArrayReduce(bm,L){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.reduce");
var g=$toObject(this);
var m=$toUint32(g.length);
if(!(%_ClassOf(bm)==='Function')){
throw MakeTypeError(9,bm);
}
var B=(%_IsArray(g));
var k=0;
find_initial:if(%_ArgumentsLength()<2){
for(;k<m;k++){
if(((B&&%_HasFastPackedElements(%IS_VAR(g)))?(k<g.length):(k in g))){
L=g[k++];
break find_initial;
}
}
throw MakeTypeError(68);
}
var bi=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(bm);
for(;k<m;k++){
if(((B&&%_HasFastPackedElements(%IS_VAR(g)))?(k<g.length):(k in g))){
var az=g[k];
if(bi)%DebugPrepareStepInIfStepping(bm);
L=%_CallFunction((void 0),L,az,k,g,bm);
}
}
return L;
}
function ArrayReduceRight(bm,L){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.reduceRight");
var g=$toObject(this);
var m=$toUint32(g.length);
if(!(%_ClassOf(bm)==='Function')){
throw MakeTypeError(9,bm);
}
var B=(%_IsArray(g));
var k=m-1;
find_initial:if(%_ArgumentsLength()<2){
for(;k>=0;k--){
if(((B&&%_HasFastPackedElements(%IS_VAR(g)))?(k<g.length):(k in g))){
L=g[k--];
break find_initial;
}
}
throw MakeTypeError(68);
}
var bi=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(bm);
for(;k>=0;k--){
if(((B&&%_HasFastPackedElements(%IS_VAR(g)))?(k<g.length):(k in g))){
var az=g[k];
if(bi)%DebugPrepareStepInIfStepping(bm);
L=%_CallFunction((void 0),L,az,k,g,bm);
}
}
return L;
}
function ArrayIsArray(aS){
return(%_IsArray(aS));
}
%AddNamedProperty(d.prototype,"constructor",d,
2);
var bn={
__proto__:null,
copyWithin:true,
entries:true,
fill:true,
find:true,
findIndex:true,
keys:true,
};
%AddNamedProperty(d.prototype,symbolUnscopables,bn,
2|1);
$installFunctions(d,2,[
"isArray",ArrayIsArray
]);
var bo=%SpecialArrayFunctions();
var bp=function(bq,br,r){
var bd=br;
if(bo.hasOwnProperty(bq)){
bd=bo[bq];
}
if(!(r===(void 0))){
%FunctionSetLength(bd,r);
}
return bd;
};
$installFunctions(d.prototype,2,[
"toString",bp("toString",ArrayToString),
"toLocaleString",bp("toLocaleString",ArrayToLocaleString),
"join",bp("join",ArrayJoin),
"pop",bp("pop",ArrayPop),
"push",bp("push",ArrayPush,1),
"concat",bp("concat",ArrayConcatJS,1),
"reverse",bp("reverse",ArrayReverse),
"shift",bp("shift",ArrayShift),
"unshift",bp("unshift",ArrayUnshift,1),
"slice",bp("slice",ArraySlice,2),
"splice",bp("splice",ArraySplice,2),
"sort",bp("sort",ArraySort),
"filter",bp("filter",ArrayFilter,1),
"forEach",bp("forEach",ArrayForEach,1),
"some",bp("some",ArraySome,1),
"every",bp("every",ArrayEvery,1),
"map",bp("map",ArrayMap,1),
"indexOf",bp("indexOf",ArrayIndexOf,1),
"lastIndexOf",bp("lastIndexOf",ArrayLastIndexOf,1),
"reduce",bp("reduce",ArrayReduce,1),
"reduceRight",bp("reduceRight",ArrayReduceRight,1)
]);
%FinishArrayPrototypeSetup(d.prototype);
$setUpLockedPrototype(InternalArray,d(),[
"concat",bp("concat",ArrayConcatJS),
"indexOf",bp("indexOf",ArrayIndexOf),
"join",bp("join",ArrayJoin),
"pop",bp("pop",ArrayPop),
"push",bp("push",ArrayPush),
"shift",bp("shift",ArrayShift),
"splice",bp("splice",ArraySplice)
]);
$setUpLockedPrototype(InternalPackedArray,d(),[
"join",bp("join",ArrayJoin),
"pop",bp("pop",ArrayPop),
"push",bp("push",ArrayPush),
"shift",bp("shift",ArrayShift)
]);
$arrayConcat=ArrayConcatJS;
$arrayJoin=ArrayJoin;
$arrayPush=ArrayPush;
$arrayPop=ArrayPop;
$arrayShift=ArrayShift;
$arraySlice=ArraySlice;
$arraySplice=ArraySplice;
$arrayUnshift=ArrayUnshift;
})

string–C
var $stringCharAt;
var $stringIndexOf;
var $stringSubstring;
(function(a,b,c){
%CheckIsBootstrapping();
var d=a.RegExp;
var e=a.String;
function StringConstructor(g){
if(%_ArgumentsLength()==0)g='';
if(%_IsConstructCall()){
%_SetValueOf(this,((typeof(%IS_VAR(g))==='string')?g:$nonStringToString(g)));
}else{
return(typeof(g)==='symbol')?
%_CallFunction(g,$symbolToString):((typeof(%IS_VAR(g))==='string')?g:$nonStringToString(g));
}
}
function StringToString(){
if(!(typeof(this)==='string')&&!(%_ClassOf(this)==='String')){
throw MakeTypeError(37,'String.prototype.toString');
}
return %_ValueOf(this);
}
function StringValueOf(){
if(!(typeof(this)==='string')&&!(%_ClassOf(this)==='String')){
throw MakeTypeError(37,'String.prototype.valueOf');
}
return %_ValueOf(this);
}
function StringCharAtJS(h){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.charAt");
var i=%_StringCharAt(this,h);
if(%_IsSmi(i)){
i=%_StringCharAt(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)),(%_IsSmi(%IS_VAR(h))?h:%NumberToInteger($toNumber(h))));
}
return i;
}
function StringCharCodeAtJS(h){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.charCodeAt");
var i=%_StringCharCodeAt(this,h);
if(!%_IsSmi(i)){
i=%_StringCharCodeAt(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)),(%_IsSmi(%IS_VAR(h))?h:%NumberToInteger($toNumber(h))));
}
return i;
}
function StringConcat(j){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.concat");
var k=%_ArgumentsLength();
var l=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
if(k===1){
return l+((typeof(%IS_VAR(j))==='string')?j:$nonStringToString(j));
}
var m=new InternalArray(k+1);
m[0]=l;
for(var n=0;n<k;n++){
var o=%_Arguments(n);
m[n+1]=((typeof(%IS_VAR(o))==='string')?o:$nonStringToString(o));
}
return %StringBuilderConcat(m,k+1,"");
}
function StringIndexOfJS(p){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.indexOf");
var q=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
p=((typeof(%IS_VAR(p))==='string')?p:$nonStringToString(p));
var r=0;
if(%_ArgumentsLength()>1){
r=%_Arguments(1);
r=(%_IsSmi(%IS_VAR(r))?r:%NumberToInteger($toNumber(r)));
if(r<0)r=0;
if(r>q.length)r=q.length;
}
return %StringIndexOf(q,p,r);
}
function StringLastIndexOfJS(t){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.lastIndexOf");
var u=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
var v=u.length;
var t=((typeof(%IS_VAR(t))==='string')?t:$nonStringToString(t));
var w=t.length;
var r=v-w;
if(%_ArgumentsLength()>1){
var x=$toNumber(%_Arguments(1));
if(!(!%_IsSmi(%IS_VAR(x))&&!(x==x))){
x=(%_IsSmi(%IS_VAR(x))?x:%NumberToInteger($toNumber(x)));
if(x<0){
x=0;
}
if(x+w<v){
r=x;
}
}
}
if(r<0){
return-1;
}
return %StringLastIndexOf(u,t,r);
}
function StringLocaleCompareJS(j){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.localeCompare");
return %StringLocaleCompare(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)),
((typeof(%IS_VAR(j))==='string')?j:$nonStringToString(j)));
}
function StringMatchJS(y){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.match");
var q=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
if((%_IsRegExp(y))){
var z=y.lastIndex;
(%_IsSmi(%IS_VAR(z))?z:$toNumber(z));
if(!y.global)return $regexpExecNoTests(y,q,0);
var i=%StringMatch(q,y,$regexpLastMatchInfo);
if(i!==null)$regexpLastMatchInfoOverride=null;
y.lastIndex=0;
return i;
}
y=new d(y);
return $regexpExecNoTests(y,q,0);
}
var A=['NFC','NFD','NFKC','NFKD'];
function StringNormalizeJS(B){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.normalize");
var B=B?((typeof(%IS_VAR(B))==='string')?B:$nonStringToString(B)):'NFC';
var C=A.indexOf(B);
if(C===-1){
throw MakeRangeError(100,A.join(', '));
}
return %_ValueOf(this);
}
var D=[2,"","",-1,-1];
function StringReplace(E,F){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.replace");
var q=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
if((%_IsRegExp(E))){
var z=E.lastIndex;
(%_IsSmi(%IS_VAR(z))?z:$toNumber(z));
if(!(%_ClassOf(F)==='Function')){
F=((typeof(%IS_VAR(F))==='string')?F:$nonStringToString(F));
if(!E.global){
var G=$regexpExec(E,q,0);
if(G==null){
E.lastIndex=0
return q;
}
if(F.length==0){
return %_SubString(q,0,G[3])+
%_SubString(q,G[4],q.length)
}
return ExpandReplacement(F,q,$regexpLastMatchInfo,
%_SubString(q,0,G[3]))+
%_SubString(q,G[4],q.length);
}
E.lastIndex=0;
if($regexpLastMatchInfoOverride==null){
return %StringReplaceGlobalRegExpWithString(
q,E,F,$regexpLastMatchInfo);
}else{
var H=$regexpLastMatchInfo[1];
$regexpLastMatchInfo[1]=0;
var I=%StringReplaceGlobalRegExpWithString(
q,E,F,$regexpLastMatchInfo);
if(%_IsSmi($regexpLastMatchInfo[1])){
$regexpLastMatchInfo[1]=H;
}else{
$regexpLastMatchInfoOverride=null;
}
return I;
}
}
if(E.global){
return StringReplaceGlobalRegExpWithFunction(q,E,F);
}
return StringReplaceNonGlobalRegExpWithFunction(q,E,F);
}
E=((typeof(%IS_VAR(E))==='string')?E:$nonStringToString(E));
if(E.length==1&&
q.length>0xFF&&
(typeof(F)==='string')&&
%StringIndexOf(F,'$',0)<0){
return %StringReplaceOneCharWithString(q,E,F);
}
var J=%StringIndexOf(q,E,0);
if(J<0)return q;
var K=J+E.length;
var i=%_SubString(q,0,J);
if((%_ClassOf(F)==='Function')){
var L=(void 0);
i+=%_CallFunction(L,E,J,q,F);
}else{
D[3]=J;
D[4]=K;
i=ExpandReplacement(((typeof(%IS_VAR(F))==='string')?F:$nonStringToString(F)),
q,
D,
i);
}
return i+%_SubString(q,K,q.length);
}
function ExpandReplacement(M,q,N,i){
var O=M.length;
var P=%StringIndexOf(M,'$',0);
if(P<0){
if(O>0)i+=M;
return i;
}
if(P>0)i+=%_SubString(M,0,P);
while(true){
var Q='$';
var x=P+1;
if(x<O){
var R=%_StringCharCodeAt(M,x);
if(R==36){
++x;
i+='$';
}else if(R==38){
++x;
i+=
%_SubString(q,N[3],N[4]);
}else if(R==96){
++x;
i+=%_SubString(q,0,N[3]);
}else if(R==39){
++x;
i+=%_SubString(q,N[4],q.length);
}else if(R>=48&&R<=57){
var S=(R-48)<<1;
var T=1;
var U=((N)[0]);
if(x+1<M.length){
var P=%_StringCharCodeAt(M,x+1);
if(P>=48&&P<=57){
var V=S*10+((P-48)<<1);
if(V<U){
S=V;
T=2;
}
}
}
if(S!=0&&S<U){
var J=N[(3+(S))];
if(J>=0){
i+=
%_SubString(q,J,N[(3+(S+1))]);
}
x+=T;
}else{
i+='$';
}
}else{
i+='$';
}
}else{
i+='$';
}
P=%StringIndexOf(M,'$',x);
if(P<0){
if(x<O){
i+=%_SubString(M,x,O);
}
return i;
}
if(P>x){
i+=%_SubString(M,x,P);
}
}
return i;
}
function CaptureString(M,W,r){
var X=r<<1;
var J=W[(3+(X))];
if(J<0)return;
var K=W[(3+(X+1))];
return %_SubString(M,J,K);
}
var Y=new InternalArray(16);
function StringReplaceGlobalRegExpWithFunction(q,y,F){
var Z=Y;
if(Z){
Y=null;
}else{
Z=new InternalArray(16);
}
var aa=%RegExpExecMultiple(y,
q,
$regexpLastMatchInfo,
Z);
y.lastIndex=0;
if((aa===null)){
Y=Z;
return q;
}
var k=aa.length;
if((($regexpLastMatchInfo)[0])==2){
var ab=0;
var ac=new InternalPackedArray(null,0,q);
for(var n=0;n<k;n++){
var ad=aa[n];
if(%_IsSmi(ad)){
if(ad>0){
ab=(ad>>11)+(ad&0x7ff);
}else{
ab=aa[++n]-ad;
}
}else{
ac[0]=ad;
ac[1]=ab;
$regexpLastMatchInfoOverride=ac;
var ae=
%_CallFunction((void 0),ad,ab,q,F);
aa[n]=((typeof(%IS_VAR(ae))==='string')?ae:$nonStringToString(ae));
ab+=ad.length;
}
}
}else{
for(var n=0;n<k;n++){
var ad=aa[n];
if(!%_IsSmi(ad)){
$regexpLastMatchInfoOverride=ad;
var ae=%Apply(F,(void 0),ad,0,ad.length);
aa[n]=((typeof(%IS_VAR(ae))==='string')?ae:$nonStringToString(ae));
}
}
}
var i=%StringBuilderConcat(aa,aa.length,q);
Z.length=0;
Y=Z;
return i;
}
function StringReplaceNonGlobalRegExpWithFunction(q,y,F){
var N=$regexpExec(y,q,0);
if((N===null)){
y.lastIndex=0;
return q;
}
var r=N[3];
var i=%_SubString(q,0,r);
var af=N[4];
var ag=((N)[0])>>1;
var ah;
if(ag==1){
var ai=%_SubString(q,r,af);
ah=%_CallFunction((void 0),ai,r,q,F);
}else{
var aj=new InternalArray(ag+2);
for(var ak=0;ak<ag;ak++){
aj[ak]=CaptureString(q,N,ak);
}
aj[ak]=r;
aj[ak+1]=q;
ah=%Apply(F,(void 0),aj,0,ak+2);
}
i+=ah;
return i+%_SubString(q,af,q.length);
}
function StringSearch(al){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.search");
var y;
if((typeof(al)==='string')){
y=%_GetFromCache(0,al);
}else if((%_IsRegExp(al))){
y=al;
}else{
y=new d(al);
}
var G=$regexpExec(y,((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)),0);
if(G){
return G[3];
}
return-1;
}
function StringSlice(J,K){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.slice");
var ai=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
var am=ai.length;
var an=(%_IsSmi(%IS_VAR(J))?J:%NumberToInteger($toNumber(J)));
var ao=am;
if(!(K===(void 0))){
ao=(%_IsSmi(%IS_VAR(K))?K:%NumberToInteger($toNumber(K)));
}
if(an<0){
an+=am;
if(an<0){
an=0;
}
}else{
if(an>am){
return'';
}
}
if(ao<0){
ao+=am;
if(ao<0){
return'';
}
}else{
if(ao>am){
ao=am;
}
}
if(ao<=an){
return'';
}
return %_SubString(ai,an,ao);
}
function StringSplitJS(ap,aq){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.split");
var q=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
aq=((aq===(void 0)))?0xffffffff:(aq>>>0);
var O=q.length;
if(!(%_IsRegExp(ap))){
var ar=((typeof(%IS_VAR(ap))==='string')?ap:$nonStringToString(ap));
if(aq===0)return[];
if((ap===(void 0)))return[q];
var as=ar.length;
if(as===0)return %StringToArray(q,aq);
var i=%StringSplit(q,ar,aq);
return i;
}
if(aq===0)return[];
return StringSplitOnRegExp(q,ap,aq,O);
}
function StringSplitOnRegExp(q,ap,aq,O){
if(O===0){
if($regexpExec(ap,q,0,0)!=null){
return[];
}
return[q];
}
var at=0;
var au=0;
var av=0;
var i=new InternalArray();
outer_loop:
while(true){
if(au===O){
i[i.length]=%_SubString(q,at,O);
break;
}
var N=$regexpExec(ap,q,au);
if(N==null||O===(av=N[3])){
i[i.length]=%_SubString(q,at,O);
break;
}
var aw=N[4];
if(au===aw&&aw===at){
au++;
continue;
}
i[i.length]=%_SubString(q,at,av);
if(i.length===aq)break;
var ax=((N)[0])+3;
for(var n=3+2;n<ax;){
var J=N[n++];
var K=N[n++];
if(K!=-1){
i[i.length]=%_SubString(q,J,K);
}else{
i[i.length]=(void 0);
}
if(i.length===aq)break outer_loop;
}
au=at=aw;
}
var ay=[];
%MoveArrayContents(i,ay);
return ay;
}
function StringSubstring(J,K){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.subString");
var ai=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
var am=ai.length;
var an=(%_IsSmi(%IS_VAR(J))?J:%NumberToInteger($toNumber(J)));
if(an<0){
an=0;
}else if(an>am){
an=am;
}
var ao=am;
if(!(K===(void 0))){
ao=(%_IsSmi(%IS_VAR(K))?K:%NumberToInteger($toNumber(K)));
if(ao>am){
ao=am;
}else{
if(ao<0)ao=0;
if(an>ao){
var az=ao;
ao=an;
an=az;
}
}
}
return %_SubString(ai,an,ao);
}
function StringSubstr(J,aA){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.substr");
var ai=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
var k;
if((aA===(void 0))){
k=ai.length;
}else{
k=(%_IsSmi(%IS_VAR(aA))?aA:%NumberToInteger($toNumber(aA)));
if(k<=0)return'';
}
if((J===(void 0))){
J=0;
}else{
J=(%_IsSmi(%IS_VAR(J))?J:%NumberToInteger($toNumber(J)));
if(J>=ai.length)return'';
if(J<0){
J+=ai.length;
if(J<0)J=0;
}
}
var K=J+k;
if(K>ai.length)K=ai.length;
return %_SubString(ai,J,K);
}
function StringToLowerCaseJS(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.toLowerCase");
return %StringToLowerCase(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)));
}
function StringToLocaleLowerCase(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.toLocaleLowerCase");
return %StringToLowerCase(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)));
}
function StringToUpperCaseJS(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.toUpperCase");
return %StringToUpperCase(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)));
}
function StringToLocaleUpperCase(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.toLocaleUpperCase");
return %StringToUpperCase(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)));
}
function StringTrimJS(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.trim");
return %StringTrim(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)),true,true);
}
function StringTrimLeft(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.trimLeft");
return %StringTrim(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)),true,false);
}
function StringTrimRight(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.trimRight");
return %StringTrim(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)),false,true);
}
function StringFromCharCode(aB){
var aA=%_ArgumentsLength();
if(aA==1){
if(!%_IsSmi(aB))aB=$toNumber(aB);
return %_StringCharFromCode(aB&0xffff);
}
var aC=%NewString(aA,true);
var n;
for(n=0;n<aA;n++){
var aB=%_Arguments(n);
if(!%_IsSmi(aB))aB=$toNumber(aB)&0xffff;
if(aB<0)aB=aB&0xffff;
if(aB>0xff)break;
%_OneByteSeqStringSetChar(n,aB,aC);
}
if(n==aA)return aC;
aC=%TruncateString(aC,n);
var aD=%NewString(aA-n,false);
for(var ak=0;n<aA;n++,ak++){
var aB=%_Arguments(n);
if(!%_IsSmi(aB))aB=$toNumber(aB)&0xffff;
%_TwoByteSeqStringSetChar(ak,aB,aD);
}
return aC+aD;
}
function HtmlEscape(aE){
return((typeof(%IS_VAR(aE))==='string')?aE:$nonStringToString(aE)).replace(/"/g,"&quot;");
}
function StringAnchor(aF){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.anchor");
return"<a name=\""+HtmlEscape(aF)+"\">"+this+"</a>";
}
function StringBig(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.big");
return"<big>"+this+"</big>";
}
function StringBlink(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.blink");
return"<blink>"+this+"</blink>";
}
function StringBold(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.bold");
return"<b>"+this+"</b>";
}
function StringFixed(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.fixed");
return"<tt>"+this+"</tt>";
}
function StringFontcolor(aG){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.fontcolor");
return"<font color=\""+HtmlEscape(aG)+"\">"+this+"</font>";
}
function StringFontsize(aH){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.fontsize");
return"<font size=\""+HtmlEscape(aH)+"\">"+this+"</font>";
}
function StringItalics(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.italics");
return"<i>"+this+"</i>";
}
function StringLink(ai){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.link");
return"<a href=\""+HtmlEscape(ai)+"\">"+this+"</a>";
}
function StringSmall(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.small");
return"<small>"+this+"</small>";
}
function StringStrike(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.strike");
return"<strike>"+this+"</strike>";
}
function StringSub(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.sub");
return"<sub>"+this+"</sub>";
}
function StringSup(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.sup");
return"<sup>"+this+"</sup>";
}
function StringRepeat(aI){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.repeat");
var ai=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
var aA=$toInteger(aI);
if(aA<0||aA>%_MaxSmi())throw MakeRangeError(88);
var aJ="";
while(true){
if(aA&1)aJ+=ai;
aA>>=1;
if(aA===0)return aJ;
ai+=ai;
}
}
function StringStartsWith(aK){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.startsWith");
var ai=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
if((%_IsRegExp(aK))){
throw MakeTypeError(19,"String.prototype.startsWith");
}
var aL=((typeof(%IS_VAR(aK))==='string')?aK:$nonStringToString(aK));
var h=0;
if(%_ArgumentsLength()>1){
h=%_Arguments(1);
h=$toInteger(h);
}
var am=ai.length;
var J=$min($max(h,0),am);
var aM=aL.length;
if(aM+J>am){
return false;
}
return %StringIndexOf(ai,aL,J)===J;
}
function StringEndsWith(aK){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.endsWith");
var ai=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
if((%_IsRegExp(aK))){
throw MakeTypeError(19,"String.prototype.endsWith");
}
var aL=((typeof(%IS_VAR(aK))==='string')?aK:$nonStringToString(aK));
var am=ai.length;
var h=am;
if(%_ArgumentsLength()>1){
var aN=%_Arguments(1);
if(!(aN===(void 0))){
h=$toInteger(aN);
}
}
var K=$min($max(h,0),am);
var aM=aL.length;
var J=K-aM;
if(J<0){
return false;
}
return %StringLastIndexOf(ai,aL,J)===J;
}
function StringIncludes(aK){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.includes");
var ai=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
if((%_IsRegExp(aK))){
throw MakeTypeError(19,"String.prototype.includes");
}
var aL=((typeof(%IS_VAR(aK))==='string')?aK:$nonStringToString(aK));
var h=0;
if(%_ArgumentsLength()>1){
h=%_Arguments(1);
h=$toInteger(h);
}
var am=ai.length;
var J=$min($max(h,0),am);
var aM=aL.length;
if(aM+J>am){
return false;
}
return %StringIndexOf(ai,aL,J)!==-1;
}
function StringCodePointAt(h){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.codePointAt");
var M=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
var aH=M.length;
h=(%_IsSmi(%IS_VAR(h))?h:%NumberToInteger($toNumber(h)));
if(h<0||h>=aH){
return(void 0);
}
var aO=%_StringCharCodeAt(M,h);
if(aO<0xD800||aO>0xDBFF||h+1==aH){
return aO;
}
var aP=%_StringCharCodeAt(M,h+1);
if(aP<0xDC00||aP>0xDFFF){
return aO;
}
return(aO-0xD800)*0x400+aP+0x2400;
}
function StringFromCodePoint(aQ){
var aB;
var O=%_ArgumentsLength();
var r;
var i="";
for(r=0;r<O;r++){
aB=%_Arguments(r);
if(!%_IsSmi(aB)){
aB=$toNumber(aB);
}
if(aB<0||aB>0x10FFFF||aB!==(%_IsSmi(%IS_VAR(aB))?aB:%NumberToInteger($toNumber(aB)))){
throw MakeRangeError(87,aB);
}
if(aB<=0xFFFF){
i+=%_StringCharFromCode(aB);
}else{
aB-=0x10000;
i+=%_StringCharFromCode((aB>>>10)&0x3FF|0xD800);
i+=%_StringCharFromCode(aB&0x3FF|0xDC00);
}
}
return i;
}
function StringRaw(aR){
var aS=%_ArgumentsLength();
var aT=$toObject(aR);
var aU=$toObject(aT.raw);
var aV=$toLength(aU.length);
if(aV<=0)return"";
var i=$toString(aU[0]);
for(var n=1;n<aV;++n){
if(n<aS){
i+=$toString(%_Arguments(n));
}
i+=$toString(aU[n]);
}
return i;
}
%SetCode(e,StringConstructor);
%FunctionSetPrototype(e,new e());
%AddNamedProperty(
e.prototype,"constructor",e,2);
$installFunctions(e,2,[
"fromCharCode",StringFromCharCode,
"fromCodePoint",StringFromCodePoint,
"raw",StringRaw
]);
$installFunctions(e.prototype,2,[
"valueOf",StringValueOf,
"toString",StringToString,
"charAt",StringCharAtJS,
"charCodeAt",StringCharCodeAtJS,
"codePointAt",StringCodePointAt,
"concat",StringConcat,
"endsWith",StringEndsWith,
"includes",StringIncludes,
"indexOf",StringIndexOfJS,
"lastIndexOf",StringLastIndexOfJS,
"localeCompare",StringLocaleCompareJS,
"match",StringMatchJS,
"normalize",StringNormalizeJS,
"repeat",StringRepeat,
"replace",StringReplace,
"search",StringSearch,
"slice",StringSlice,
"split",StringSplitJS,
"substring",StringSubstring,
"substr",StringSubstr,
"startsWith",StringStartsWith,
"toLowerCase",StringToLowerCaseJS,
"toLocaleLowerCase",StringToLocaleLowerCase,
"toUpperCase",StringToUpperCaseJS,
"toLocaleUpperCase",StringToLocaleUpperCase,
"trim",StringTrimJS,
"trimLeft",StringTrimLeft,
"trimRight",StringTrimRight,
"link",StringLink,
"anchor",StringAnchor,
"fontcolor",StringFontcolor,
"fontsize",StringFontsize,
"big",StringBig,
"blink",StringBlink,
"bold",StringBold,
"fixed",StringFixed,
"italics",StringItalics,
"small",StringSmall,
"strike",StringStrike,
"sub",StringSub,
"sup",StringSup
]);
$stringCharAt=StringCharAtJS;
$stringIndexOf=StringIndexOfJS;
$stringSubstring=StringSubstring;
})

urieW
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Object;
var e=a.Array;
function HexValueOf(g){
if(g>=48&&g<=57)return g-48;
if(g>=65&&g<=70)return g-55;
if(g>=97&&g<=102)return g-87;
return-1;
}
function isAlphaNumeric(h){
if(97<=h&&h<=122)return true;
if(65<=h&&h<=90)return true;
if(48<=h&&h<=57)return true;
return false;
}
var i=0;
function URIAddEncodedOctetToBuffer(j,k,l){
k[l++]=37;
k[l++]=i[j>>4];
k[l++]=i[j&0x0F];
return l;
}
function URIEncodeOctets(m,k,l){
if(i===0){
i=[48,49,50,51,52,53,54,55,56,57,
65,66,67,68,69,70];
}
l=URIAddEncodedOctetToBuffer(m[0],k,l);
if(m[1])l=URIAddEncodedOctetToBuffer(m[1],k,l);
if(m[2])l=URIAddEncodedOctetToBuffer(m[2],k,l);
if(m[3])l=URIAddEncodedOctetToBuffer(m[3],k,l);
return l;
}
function URIEncodeSingle(h,k,l){
var n=(h>>12)&0xF;
var o=(h>>6)&63;
var p=h&63;
var m=new e(3);
if(h<=0x007F){
m[0]=h;
}else if(h<=0x07FF){
m[0]=o+192;
m[1]=p+128;
}else{
m[0]=n+224;
m[1]=o+128;
m[2]=p+128;
}
return URIEncodeOctets(m,k,l);
}
function URIEncodePair(q,r,k,l){
var t=((q>>6)&0xF)+1;
var u=(q>>2)&0xF;
var n=q&3;
var o=(r>>6)&0xF;
var p=r&63;
var m=new e(4);
m[0]=(t>>2)+240;
m[1]=(((t&3)<<4)|u)+128;
m[2]=((n<<4)|o)+128;
m[3]=p+128;
return URIEncodeOctets(m,k,l);
}
function URIHexCharsToCharCode(v,w){
var x=HexValueOf(v);
var y=HexValueOf(w);
if(x==-1||y==-1)throw MakeURIError();
return(x<<4)|y;
}
function URIDecodeOctets(m,k,l){
var z;
var A=m[0];
if(A<0x80){
z=A;
}else if(A<0xc2){
throw MakeURIError();
}else{
var B=m[1];
if(A<0xe0){
var C=A&0x1f;
if((B<0x80)||(B>0xbf))throw MakeURIError();
var D=B&0x3f;
z=(C<<6)+D;
if(z<0x80||z>0x7ff)throw MakeURIError();
}else{
var E=m[2];
if(A<0xf0){
var C=A&0x0f;
if((B<0x80)||(B>0xbf))throw MakeURIError();
var D=B&0x3f;
if((E<0x80)||(E>0xbf))throw MakeURIError();
var F=E&0x3f;
z=(C<<12)+(D<<6)+F;
if((z<0x800)||(z>0xffff))throw MakeURIError();
}else{
var G=m[3];
if(A<0xf8){
var C=(A&0x07);
if((B<0x80)||(B>0xbf))throw MakeURIError();
var D=(B&0x3f);
if((E<0x80)||(E>0xbf)){
throw MakeURIError();
}
var F=(E&0x3f);
if((G<0x80)||(G>0xbf))throw MakeURIError();
var H=(G&0x3f);
z=(C<<18)+(D<<12)+(F<<6)+H;
if((z<0x10000)||(z>0x10ffff))throw MakeURIError();
}else{
throw MakeURIError();
}
}
}
}
if(0xD800<=z&&z<=0xDFFF)throw MakeURIError();
if(z<0x10000){
%_TwoByteSeqStringSetChar(l++,z,k);
}else{
%_TwoByteSeqStringSetChar(l++,(z>>10)+0xd7c0,k);
%_TwoByteSeqStringSetChar(l++,(z&0x3ff)+0xdc00,k);
}
return l;
}
function Encode(I,J){
var K=I.length;
var L=new InternalArray(K);
var l=0;
for(var M=0;M<K;M++){
var q=I.charCodeAt(M);
if(J(q)){
L[l++]=q;
}else{
if(q>=0xDC00&&q<=0xDFFF)throw MakeURIError();
if(q<0xD800||q>0xDBFF){
l=URIEncodeSingle(q,L,l);
}else{
M++;
if(M==K)throw MakeURIError();
var r=I.charCodeAt(M);
if(r<0xDC00||r>0xDFFF)throw MakeURIError();
l=URIEncodePair(q,r,L,l);
}
}
}
var k=%NewString(L.length,true);
for(var N=0;N<L.length;N++){
%_OneByteSeqStringSetChar(N,L[N],k);
}
return k;
}
function Decode(I,O){
var K=I.length;
var P=%NewString(K,true);
var l=0;
var M=0;
for(;M<K;M++){
var g=I.charCodeAt(M);
if(g==37){
if(M+2>=K)throw MakeURIError();
var h=URIHexCharsToCharCode(I.charCodeAt(M+1),I.charCodeAt(M+2));
if(h>>7)break;
if(O(h)){
%_OneByteSeqStringSetChar(l++,37,P);
%_OneByteSeqStringSetChar(l++,I.charCodeAt(M+1),P);
%_OneByteSeqStringSetChar(l++,I.charCodeAt(M+2),P);
}else{
%_OneByteSeqStringSetChar(l++,h,P);
}
M+=2;
}else{
if(g>0x7f)break;
%_OneByteSeqStringSetChar(l++,g,P);
}
}
P=%TruncateString(P,l);
if(M==K)return P;
var Q=%NewString(K-M,false);
l=0;
for(;M<K;M++){
var g=I.charCodeAt(M);
if(g==37){
if(M+2>=K)throw MakeURIError();
var h=URIHexCharsToCharCode(I.charCodeAt(++M),I.charCodeAt(++M));
if(h>>7){
var R=0;
while(((h<<++R)&0x80)!=0){}
if(R==1||R>4)throw MakeURIError();
var m=new e(R);
m[0]=h;
if(M+3*(R-1)>=K)throw MakeURIError();
for(var N=1;N<R;N++){
if(I.charAt(++M)!='%')throw MakeURIError();
m[N]=URIHexCharsToCharCode(I.charCodeAt(++M),
I.charCodeAt(++M));
}
l=URIDecodeOctets(m,Q,l);
}else if(O(h)){
%_TwoByteSeqStringSetChar(l++,37,Q);
%_TwoByteSeqStringSetChar(l++,I.charCodeAt(M-1),Q);
%_TwoByteSeqStringSetChar(l++,I.charCodeAt(M),Q);
}else{
%_TwoByteSeqStringSetChar(l++,h,Q);
}
}else{
%_TwoByteSeqStringSetChar(l++,g,Q);
}
}
Q=%TruncateString(Q,l);
return P+Q;
}
function URIEscapeJS(S){
var T=$toString(S);
return %URIEscape(T);
}
function URIUnescapeJS(S){
var T=$toString(S);
return %URIUnescape(T);
}
function URIDecode(I){
var U=function(h){
if(35<=h&&h<=36)return true;
if(h==38)return true;
if(43<=h&&h<=44)return true;
if(h==47)return true;
if(58<=h&&h<=59)return true;
if(h==61)return true;
if(63<=h&&h<=64)return true;
return false;
};
var V=$toString(I);
return Decode(V,U);
}
function URIDecodeComponent(W){
var U=function(h){return false;};
var V=$toString(W);
return Decode(V,U);
}
function URIEncode(I){
var X=function(h){
if(isAlphaNumeric(h))return true;
if(h==33)return true;
if(35<=h&&h<=36)return true;
if(38<=h&&h<=47)return true;
if(58<=h&&h<=59)return true;
if(h==61)return true;
if(63<=h&&h<=64)return true;
if(h==95)return true;
if(h==126)return true;
return false;
};
var V=$toString(I);
return Encode(V,X);
}
function URIEncodeComponent(W){
var X=function(h){
if(isAlphaNumeric(h))return true;
if(h==33)return true;
if(39<=h&&h<=42)return true;
if(45<=h&&h<=46)return true;
if(h==95)return true;
if(h==126)return true;
return false;
};
var V=$toString(W);
return Encode(V,X);
}
$installFunctions(a,2,[
"escape",URIEscapeJS,
"unescape",URIUnescapeJS,
"decodeURI",URIDecode,
"decodeURIComponent",URIDecodeComponent,
"encodeURI",URIEncode,
"encodeURIComponent",URIEncodeComponent
]);
})

math¥]
var rngstate;
var $abs;
var $exp;
var $floor;
var $max;
var $min;
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Object;
function MathAbs(e){
e=+e;
return(e>0)?e:0-e;
}
function MathAcosJS(e){
return %_MathAcos(+e);
}
function MathAsinJS(e){
return %_MathAsin(+e);
}
function MathAtanJS(e){
return %_MathAtan(+e);
}
function MathAtan2JS(g,e){
g=+g;
e=+e;
return %_MathAtan2(g,e);
}
function MathCeil(e){
return-%_MathFloor(-e);
}
function MathExp(e){
return %MathExpRT(((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e)));
}
function MathFloorJS(e){
return %_MathFloor(+e);
}
function MathLog(e){
return %_MathLogRT(((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e)));
}
function MathMax(h,i){
var j=%_ArgumentsLength();
if(j==2){
h=((typeof(%IS_VAR(h))==='number')?h:$nonNumberToNumber(h));
i=((typeof(%IS_VAR(i))==='number')?i:$nonNumberToNumber(i));
if(i>h)return i;
if(h>i)return h;
if(h==i){
return(h===0&&%_IsMinusZero(h))?i:h;
}
return $NaN;
}
var k=-(1/0);
for(var l=0;l<j;l++){
var m=%_Arguments(l);
m=((typeof(%IS_VAR(m))==='number')?m:$nonNumberToNumber(m));
if((!%_IsSmi(%IS_VAR(m))&&!(m==m))||m>k||(k===0&&m===0&&%_IsMinusZero(k))){
k=m;
}
}
return k;
}
function MathMin(h,i){
var j=%_ArgumentsLength();
if(j==2){
h=((typeof(%IS_VAR(h))==='number')?h:$nonNumberToNumber(h));
i=((typeof(%IS_VAR(i))==='number')?i:$nonNumberToNumber(i));
if(i>h)return h;
if(h>i)return i;
if(h==i){
return(h===0&&%_IsMinusZero(h))?h:i;
}
return $NaN;
}
var k=(1/0);
for(var l=0;l<j;l++){
var m=%_Arguments(l);
m=((typeof(%IS_VAR(m))==='number')?m:$nonNumberToNumber(m));
if((!%_IsSmi(%IS_VAR(m))&&!(m==m))||m<k||(k===0&&m===0&&%_IsMinusZero(m))){
k=m;
}
}
return k;
}
function MathPowJS(e,g){
return %_MathPow(((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e)),((typeof(%IS_VAR(g))==='number')?g:$nonNumberToNumber(g)));
}
function MathRandom(){
var n=(MathImul(18030,rngstate[0]&0xFFFF)+(rngstate[0]>>>16))|0;
rngstate[0]=n;
var o=(MathImul(36969,rngstate[1]&0xFFFF)+(rngstate[1]>>>16))|0;
rngstate[1]=o;
var e=((n<<16)+(o&0xFFFF))|0;
return(e<0?(e+0x100000000):e)*2.3283064365386962890625e-10;
}
function MathRound(e){
return %RoundNumber(((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e)));
}
function MathSqrtJS(e){
return %_MathSqrt(+e);
}
function MathImul(e,g){
return %NumberImul(((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e)),((typeof(%IS_VAR(g))==='number')?g:$nonNumberToNumber(g)));
}
function MathSign(e){
e=+e;
if(e>0)return 1;
if(e<0)return-1;
return e;
}
function MathTrunc(e){
e=+e;
if(e>0)return %_MathFloor(e);
if(e<0)return-%_MathFloor(-e);
return e;
}
function MathTanh(e){
e=((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e));
if(e===0)return e;
if(!(%_IsSmi(%IS_VAR(e))||((e==e)&&(e!=1/0)&&(e!=-1/0))))return MathSign(e);
var p=MathExp(e);
var q=MathExp(-e);
return(p-q)/(p+q);
}
function MathAsinh(e){
e=((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e));
if(e===0||!(%_IsSmi(%IS_VAR(e))||((e==e)&&(e!=1/0)&&(e!=-1/0))))return e;
if(e>0)return MathLog(e+%_MathSqrt(e*e+1));
return-MathLog(-e+%_MathSqrt(e*e+1));
}
function MathAcosh(e){
e=((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e));
if(e<1)return $NaN;
if(!(%_IsSmi(%IS_VAR(e))||((e==e)&&(e!=1/0)&&(e!=-1/0))))return e;
return MathLog(e+%_MathSqrt(e+1)*%_MathSqrt(e-1));
}
function MathAtanh(e){
e=((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e));
if(e===0)return e;
if(!(%_IsSmi(%IS_VAR(e))||((e==e)&&(e!=1/0)&&(e!=-1/0))))return $NaN;
return 0.5*MathLog((1+e)/(1-e));
}
function MathHypot(e,g){
var j=%_ArgumentsLength();
var r=new InternalArray(j);
var t=0;
for(var l=0;l<j;l++){
var m=%_Arguments(l);
m=((typeof(%IS_VAR(m))==='number')?m:$nonNumberToNumber(m));
if(m===(1/0)||m===-(1/0))return(1/0);
m=MathAbs(m);
if(m>t)t=m;
r[l]=m;
}
if(t===0)t=1;
var u=0;
var v=0;
for(var l=0;l<j;l++){
var m=r[l]/t;
var w=m*m-v;
var x=u+w;
v=(x-u)-w;
u=x;
}
return %_MathSqrt(u)*t;
}
function MathFroundJS(e){
return %MathFround(((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e)));
}
function MathClz32JS(e){
return %_MathClz32(e>>>0);
}
function MathCbrt(e){
e=((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e));
if(e==0||!(%_IsSmi(%IS_VAR(e))||((e==e)&&(e!=1/0)&&(e!=-1/0))))return e;
return e>=0?CubeRoot(e):-CubeRoot(-e);
}
function CubeRoot(e){
var y=MathFloorJS(%_DoubleHi(e)/3)+0x2A9F7893;
var z=%_ConstructDouble(y,0);
z=(1.0/3.0)*(e/(z*z)+2*z);
;
z=(1.0/3.0)*(e/(z*z)+2*z);
;
z=(1.0/3.0)*(e/(z*z)+2*z);
;
return(1.0/3.0)*(e/(z*z)+2*z);
;
}
function MathConstructor(){}
var A=new MathConstructor();
%InternalSetPrototype(A,d.prototype);
%AddNamedProperty(a,"Math",A,2);
%FunctionSetInstanceClassName(MathConstructor,'Math');
%AddNamedProperty(A,symbolToStringTag,"Math",1|2);
$installConstants(A,[
"E",2.7182818284590452354,
"LN10",2.302585092994046,
"LN2",0.6931471805599453,
"LOG2E",1.4426950408889634,
"LOG10E",0.4342944819032518,
"PI",3.1415926535897932,
"SQRT1_2",0.7071067811865476,
"SQRT2",1.4142135623730951
]);
$installFunctions(A,2,[
"random",MathRandom,
"abs",MathAbs,
"acos",MathAcosJS,
"asin",MathAsinJS,
"atan",MathAtanJS,
"ceil",MathCeil,
"exp",MathExp,
"floor",MathFloorJS,
"log",MathLog,
"round",MathRound,
"sqrt",MathSqrtJS,
"atan2",MathAtan2JS,
"pow",MathPowJS,
"max",MathMax,
"min",MathMin,
"imul",MathImul,
"sign",MathSign,
"trunc",MathTrunc,
"tanh",MathTanh,
"asinh",MathAsinh,
"acosh",MathAcosh,
"atanh",MathAtanh,
"hypot",MathHypot,
"fround",MathFroundJS,
"clz32",MathClz32JS,
"cbrt",MathCbrt
]);
%SetInlineBuiltinFlag(MathAbs);
%SetInlineBuiltinFlag(MathAcosJS);
%SetInlineBuiltinFlag(MathAsinJS);
%SetInlineBuiltinFlag(MathAtanJS);
%SetInlineBuiltinFlag(MathAtan2JS);
%SetInlineBuiltinFlag(MathCeil);
%SetInlineBuiltinFlag(MathClz32JS);
%SetInlineBuiltinFlag(MathFloorJS);
%SetInlineBuiltinFlag(MathRandom);
%SetInlineBuiltinFlag(MathSign);
%SetInlineBuiltinFlag(MathSqrtJS);
%SetInlineBuiltinFlag(MathTrunc);
$abs=MathAbs;
$exp=MathExp;
$floor=MathFloorJS;
$max=MathMax;
$min=MathMin;
})

fdlibmù§
var kMath;
var rempio2result;
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Math;





















function KernelTan(e,g,h){
var i;
var j;
var k=%_DoubleHi(e);
var l=k&0x7fffffff;
if(l<0x3e300000){
if(((l|%_DoubleLo(e))|(h+1))==0){
return 1/$abs(e);
}else{
if(h==1){
return e;
}else{
var j=e+g;
var i=%_ConstructDouble(%_DoubleHi(j),0);
var m=g-(i-e);
var n=-1/j;
var o=%_ConstructDouble(%_DoubleHi(n),0);
var p=1+o*i;
return o+n*(p+o*m);
}
}
}
if(l>=0x3fe59428){
if(e<0){
e=-e;
g=-g;
}
i=kMath[32]-e;
j=kMath[33]-g;
e=i+j;
g=0;
}
i=e*e;
j=i*i;
var q=kMath[19+1]
+j*(kMath[19+3]
+j*(kMath[19+5]
+
j*(kMath[19+7]
+j*(kMath[19+9]
+j*kMath[19+11]
))));
var m=i*(kMath[19+2]
+j*(kMath[19+4]
+j*(kMath[19+6]
+
j*(kMath[19+8]
+j*(kMath[19+10]
+j*kMath[19+12]
)))));
var p=i*e;
q=g+i*(p*(q+m)+g);
q=q+kMath[19+0]
*p;
j=e+q;
if(l>=0x3fe59428){
return(1-((k>>30)&2))*
(h-2.0*(e-(j*j/(j+h)-q)));
}
if(h==1){
return j;
}else{
i=%_ConstructDouble(%_DoubleHi(j),0);
m=q-(i-e);
var n=-1/j;
var o=%_ConstructDouble(%_DoubleHi(n),0);
p=1+o*i;
return o+n*(p+o*m);
}
}
function MathSinSlow(e){
var r,t,u;
var k=%_DoubleHi(e);
var l=k&0x7fffffff;
if(l<0x4002d97c){
if(k>0){
var i=e-kMath[1];
if(l!=0x3ff921fb){
t=i-kMath[2];
u=(i-t)-kMath[2];
}else{
i-=kMath[3];
t=i-kMath[4];
u=(i-t)-kMath[4];
}
r=1;
}else{
var i=e+kMath[1];
if(l!=0x3ff921fb){
t=i+kMath[2];
u=(i-t)+kMath[2];
}else{
i+=kMath[3];
t=i+kMath[4];
u=(i-t)+kMath[4];
}
r=-1;
}
}else if(l<=0x413921fb){
var o=$abs(e);
r=(o*kMath[0]+0.5)|0;
var q=o-r*kMath[1];
var j=r*kMath[2];
t=q-j;
if(l-(%_DoubleHi(t)&0x7ff00000)>0x1000000){
o=q;
j=r*kMath[3];
q=o-j;
j=r*kMath[4]-((o-q)-j);
t=q-j;
if(l-(%_DoubleHi(t)&0x7ff00000)>0x3100000){
o=q;
j=r*kMath[5];
q=o-j;
j=r*kMath[6]-((o-q)-j);
t=q-j;
}
}
u=(q-t)-j;
if(k<0){
r=-r;
t=-t;
u=-u;
}
}else{
r=%RemPiO2(e,rempio2result);
t=rempio2result[0];
u=rempio2result[1];
}
;
var v=1-(r&2);
if(r&1){
var l=%_DoubleHi(t)&0x7fffffff;
var i=t*t;
var q=i*(4.16666666666666019037e-02+i*(-1.38888888888741095749e-03+i*(2.48015872894767294178e-05+i*(-2.75573143513906633035e-07+i*(2.08757232129817482790e-09+i*-1.13596475577881948265e-11)))));
if(l<0x3fd33333){
return(1-(0.5*i-(i*q-t*u)))*v;
}else{
var w;
if(l>0x3fe90000){
w=0.28125;
}else{
w=%_ConstructDouble(%_DoubleHi(0.25*t),0);
}
var x=0.5*i-w;
return(1-w-(x-(i*q-t*u)))*v;
}
;
}else{
var i=t*t;
var m=i*t;
var q=8.33333333332248946124e-03+i*(-1.98412698298579493134e-04+i*(2.75573137070700676789e-06+i*(-2.50507602534068634195e-08+i*1.58969099521155010221e-10)));
return(t-((i*(0.5*u-m*q)-u)-m*-1.66666666666666324348e-01))*v;
;
}
}
function MathCosSlow(e){
var r,t,u;
var k=%_DoubleHi(e);
var l=k&0x7fffffff;
if(l<0x4002d97c){
if(k>0){
var i=e-kMath[1];
if(l!=0x3ff921fb){
t=i-kMath[2];
u=(i-t)-kMath[2];
}else{
i-=kMath[3];
t=i-kMath[4];
u=(i-t)-kMath[4];
}
r=1;
}else{
var i=e+kMath[1];
if(l!=0x3ff921fb){
t=i+kMath[2];
u=(i-t)+kMath[2];
}else{
i+=kMath[3];
t=i+kMath[4];
u=(i-t)+kMath[4];
}
r=-1;
}
}else if(l<=0x413921fb){
var o=$abs(e);
r=(o*kMath[0]+0.5)|0;
var q=o-r*kMath[1];
var j=r*kMath[2];
t=q-j;
if(l-(%_DoubleHi(t)&0x7ff00000)>0x1000000){
o=q;
j=r*kMath[3];
q=o-j;
j=r*kMath[4]-((o-q)-j);
t=q-j;
if(l-(%_DoubleHi(t)&0x7ff00000)>0x3100000){
o=q;
j=r*kMath[5];
q=o-j;
j=r*kMath[6]-((o-q)-j);
t=q-j;
}
}
u=(q-t)-j;
if(k<0){
r=-r;
t=-t;
u=-u;
}
}else{
r=%RemPiO2(e,rempio2result);
t=rempio2result[0];
u=rempio2result[1];
}
;
if(r&1){
var v=(r&2)-1;
var i=t*t;
var m=i*t;
var q=8.33333333332248946124e-03+i*(-1.98412698298579493134e-04+i*(2.75573137070700676789e-06+i*(-2.50507602534068634195e-08+i*1.58969099521155010221e-10)));
return(t-((i*(0.5*u-m*q)-u)-m*-1.66666666666666324348e-01))*v;
;
}else{
var v=1-(r&2);
var l=%_DoubleHi(t)&0x7fffffff;
var i=t*t;
var q=i*(4.16666666666666019037e-02+i*(-1.38888888888741095749e-03+i*(2.48015872894767294178e-05+i*(-2.75573143513906633035e-07+i*(2.08757232129817482790e-09+i*-1.13596475577881948265e-11)))));
if(l<0x3fd33333){
return(1-(0.5*i-(i*q-t*u)))*v;
}else{
var w;
if(l>0x3fe90000){
w=0.28125;
}else{
w=%_ConstructDouble(%_DoubleHi(0.25*t),0);
}
var x=0.5*i-w;
return(1-w-(x-(i*q-t*u)))*v;
}
;
}
}
function MathSin(e){
e=+e;
if((%_DoubleHi(e)&0x7fffffff)<=0x3fe921fb){
var i=e*e;
var m=i*e;
var q=8.33333333332248946124e-03+i*(-1.98412698298579493134e-04+i*(2.75573137070700676789e-06+i*(-2.50507602534068634195e-08+i*1.58969099521155010221e-10)));
return(e-((i*(0.5*0-m*q)-0)-m*-1.66666666666666324348e-01));
;
}
return+MathSinSlow(e);
}
function MathCos(e){
e=+e;
if((%_DoubleHi(e)&0x7fffffff)<=0x3fe921fb){
var l=%_DoubleHi(e)&0x7fffffff;
var i=e*e;
var q=i*(4.16666666666666019037e-02+i*(-1.38888888888741095749e-03+i*(2.48015872894767294178e-05+i*(-2.75573143513906633035e-07+i*(2.08757232129817482790e-09+i*-1.13596475577881948265e-11)))));
if(l<0x3fd33333){
return(1-(0.5*i-(i*q-e*0)));
}else{
var w;
if(l>0x3fe90000){
w=0.28125;
}else{
w=%_ConstructDouble(%_DoubleHi(0.25*e),0);
}
var x=0.5*i-w;
return(1-w-(x-(i*q-e*0)));
}
;
}
return+MathCosSlow(e);
}
function MathTan(e){
e=e*1;
if((%_DoubleHi(e)&0x7fffffff)<=0x3fe921fb){
return KernelTan(e,0,1);
}
var r,t,u;
var k=%_DoubleHi(e);
var l=k&0x7fffffff;
if(l<0x4002d97c){
if(k>0){
var i=e-kMath[1];
if(l!=0x3ff921fb){
t=i-kMath[2];
u=(i-t)-kMath[2];
}else{
i-=kMath[3];
t=i-kMath[4];
u=(i-t)-kMath[4];
}
r=1;
}else{
var i=e+kMath[1];
if(l!=0x3ff921fb){
t=i+kMath[2];
u=(i-t)+kMath[2];
}else{
i+=kMath[3];
t=i+kMath[4];
u=(i-t)+kMath[4];
}
r=-1;
}
}else if(l<=0x413921fb){
var o=$abs(e);
r=(o*kMath[0]+0.5)|0;
var q=o-r*kMath[1];
var j=r*kMath[2];
t=q-j;
if(l-(%_DoubleHi(t)&0x7ff00000)>0x1000000){
o=q;
j=r*kMath[3];
q=o-j;
j=r*kMath[4]-((o-q)-j);
t=q-j;
if(l-(%_DoubleHi(t)&0x7ff00000)>0x3100000){
o=q;
j=r*kMath[5];
q=o-j;
j=r*kMath[6]-((o-q)-j);
t=q-j;
}
}
u=(q-t)-j;
if(k<0){
r=-r;
t=-t;
u=-u;
}
}else{
r=%RemPiO2(e,rempio2result);
t=rempio2result[0];
u=rempio2result[1];
}
;
return KernelTan(t,u,(r&1)?-1:1);
}




function MathLog1p(e){
e=e*1;
var k=%_DoubleHi(e);
var y=k&0x7fffffff;
var z=1;
var A=e;
var B=1;
var C=0;
var D=e;
if(k<0x3fda827a){
if(y>=0x3ff00000){
if(e===-1){
return-(1/0);
}else{
return $NaN;
}
}else if(y<0x3c900000){
return e;
}else if(y<0x3e200000){
return e-e*e*0.5;
}
if((k>0)||(k<=-0x402D413D)){
z=0;
}
}
if(k>=0x7ff00000)return e;
if(z!==0){
if(k<0x43400000){
D=1+e;
B=%_DoubleHi(D);
z=(B>>20)-1023;
C=(z>0)?1-(D-e):e-(D-1);
C=C/D;
}else{
B=%_DoubleHi(D);
z=(B>>20)-1023;
}
B=B&0xfffff;
if(B<0x6a09e){
D=%_ConstructDouble(B|0x3ff00000,%_DoubleLo(D));
}else{
++z;
D=%_ConstructDouble(B|0x3fe00000,%_DoubleLo(D));
B=(0x00100000-B)>>2;
}
A=D-1;
}
var E=0.5*A*A;
if(B===0){
if(A===0){
if(z===0){
return 0.0;
}else{
return z*kMath[34]+(C+z*kMath[35]);
}
}
var F=E*(1-kMath[36]*A);
if(z===0){
return A-F;
}else{
return z*kMath[34]-((F-(z*kMath[35]+C))-A);
}
}
var p=A/(2+A);
var i=p*p;
var F=i*((kMath[37+0])
+i*((kMath[37+1])
+i*
((kMath[37+2])
+i*((kMath[37+3])
+i*
((kMath[37+4])
+i*((kMath[37+5])
+i*(kMath[37+6])
))))));
if(z===0){
return A-(E-p*(E+F));
}else{
return z*kMath[34]-((E-(p*(E+F)+(z*kMath[35]+C)))-A);
}
}


function MathExpm1(e){
e=e*1;
var g;
var G;
var H;
var z;
var o;
var C;
var k=%_DoubleHi(e);
var I=k&0x80000000;
var g=(I===0)?e:-e;
k&=0x7fffffff;
if(k>=0x4043687a){
if(k>=0x40862e42){
if(k>=0x7ff00000){
return(e===-(1/0))?-1:e;
}
if(e>kMath[44])return(1/0);
}
if(I!=0)return-1;
}
if(k>0x3fd62e42){
if(k<0x3ff0a2b2){
if(I===0){
G=e-kMath[34];
H=kMath[35];
z=1;
}else{
G=e+kMath[34];
H=-kMath[35];
z=-1;
}
}else{
z=(kMath[45]*e+((I===0)?0.5:-0.5))|0;
o=z;
G=e-o*kMath[34];
H=o*kMath[35];
}
e=G-H;
C=(G-e)-H;
}else if(k<0x3c900000){
return e;
}else{
z=0;
}
var J=0.5*e;
var K=e*J;
var L=1+K*((kMath[46+0])
+K*((kMath[46+1])
+K*
((kMath[46+2])
+K*((kMath[46+3])
+K*(kMath[46+4])
))));
o=3-L*J;
var M=K*((L-o)/(6-e*o));
if(z===0){
return e-(e*M-K);
}else{
M=(e*(M-C)-C);
M-=K;
if(z===-1)return 0.5*(e-M)-0.5;
if(z===1){
if(e<-0.25)return-2*(M-(e+0.5));
return 1+2*(e-M);
}
if(z<=-2||z>56){
g=1-(M-e);
g=%_ConstructDouble(%_DoubleHi(g)+(z<<20),%_DoubleLo(g));
return g-1;
}
if(z<20){
o=%_ConstructDouble(0x3ff00000-(0x200000>>z),0);
g=o-(M-e);
g=%_ConstructDouble(%_DoubleHi(g)+(z<<20),%_DoubleLo(g));
}else{
o=%_ConstructDouble((0x3ff-z)<<20,0);
g=e-(M+o);
g+=1;
g=%_ConstructDouble(%_DoubleHi(g)+(z<<20),%_DoubleLo(g));
}
}
return g;
}



function MathSinh(e){
e=e*1;
var N=(e<0)?-0.5:0.5;
var y=$abs(e);
if(y<22){
if(y<3.725290298461914e-9)return e;
var o=MathExpm1(y);
if(y<1)return N*(2*o-o*o/(o+1));
return N*(o+o/(o+1));
}
if(y<709.7822265625)return N*$exp(y);
if(y<=kMath[51]){
var j=$exp(0.5*y);
var o=N*j;
return o*j;
}
return e*(1/0);
}

function MathCosh(e){
e=e*1;
var l=%_DoubleHi(e)&0x7fffffff;
if(l<0x3fd62e43){
var o=MathExpm1($abs(e));
var j=1+o;
if(l<0x3c800000)return j;
return 1+(o*o)/(j+j);
}
if(l<0x40360000){
var o=$exp($abs(e));
return 0.5*o+0.5/o;
}
if(l<0x40862e42)return 0.5*$exp($abs(e));
if($abs(e)<=kMath[51]){
var j=$exp(0.5*$abs(e));
var o=0.5*j;
return o*j;
}
if((!%_IsSmi(%IS_VAR(e))&&!(e==e)))return e;
return(1/0);
}



function MathLog10(e){
e=e*1;
var k=%_DoubleHi(e);
var O=%_DoubleLo(e);
var z=0;
if(k<0x00100000){
if(((k&0x7fffffff)|O)===0)return-(1/0);
if(k<0)return $NaN;
z-=54;
e*=18014398509481984;
k=%_DoubleHi(e);
O=%_DoubleLo(e);
}
if(k>=0x7ff00000)return e;
z+=(k>>20)-1023;
var P=(z&0x80000000)>>>31;
k=(k&0x000fffff)|((0x3ff-P)<<20);
var g=z+P;
e=%_ConstructDouble(k,O);
var i=g*kMath[54]+kMath[52]*%_MathLogRT(e);
return i+g*kMath[53];
}






function MathLog2(e){
e=e*1;
var y=$abs(e);
var k=%_DoubleHi(e);
var O=%_DoubleLo(e);
var l=k&0x7fffffff;
if((l|O)==0)return-(1/0);
if(k<0)return $NaN;
if(l>=0x7ff00000)return e;
var r=0;
if(l<0x00100000){
y*=9007199254740992;
r-=53;
l=%_DoubleHi(y);
}
r+=(l>>20)-0x3ff;
var Q=l&0x000fffff;
l=Q|0x3ff00000;
var R=1;
var S=0;
var T=0;
if(Q>0x3988e){
if(Q<0xbb67a){
R=1.5;
S=kMath[64];
T=kMath[65];
}else{
r+=1;
l-=0x00100000;
}
}
y=%_ConstructDouble(l,%_DoubleLo(y));
var D=y-R;
var m=1/(y+R);
var U=D*m;
var V=%_ConstructDouble(%_DoubleHi(U),0);
var W=%_ConstructDouble(%_DoubleHi(y+R),0)
var X=y-(W-R);
var Y=m*((D-V*W)-V*X);
var Z=U*U;
var q=Z*Z*((kMath[55+0])
+Z*((kMath[55+1])
+Z*((kMath[55+2])
+Z*(
(kMath[55+3])
+Z*((kMath[55+4])
+Z*(kMath[55+5])
)))));
q+=Y*(V+U);
Z=V*V;
W=%_ConstructDouble(%_DoubleHi(3.0+Z+q),0);
X=q-((W-3.0)-Z);
D=V*W;
m=Y*W+X*U;
p_h=%_ConstructDouble(%_DoubleHi(D+m),0);
p_l=m-(p_h-D);
z_h=kMath[62]*p_h;
z_l=kMath[63]*p_h+p_l*kMath[61]+T;
var o=r;
var aa=%_ConstructDouble(%_DoubleHi(((z_h+z_l)+S)+o),0);
var ab=z_l-(((aa-o)-S)-z_h);
return aa+ab;
}
$installFunctions(d,2,[
"cos",MathCos,
"sin",MathSin,
"tan",MathTan,
"sinh",MathSinh,
"cosh",MathCosh,
"log10",MathLog10,
"log2",MathLog2,
"log1p",MathLog1p,
"expm1",MathExpm1
]);
%SetInlineBuiltinFlag(MathSin);
%SetInlineBuiltinFlag(MathCos);
})

dateÕä
var $createDate;
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Date;
var e=$NaN;
var g;
function LocalTimezone(h){
if((!%_IsSmi(%IS_VAR(h))&&!(h==h)))return"";
CheckDateCacheCurrent();
if(h==e){
return g;
}
var i=%DateLocalTimezone(h);
e=h;
g=i;
return i;
}
function UTC(j){
if((!%_IsSmi(%IS_VAR(j))&&!(j==j)))return j;
return %DateToUTC(j);
}
function MakeTime(k,l,m,n){
if(!$isFinite(k))return $NaN;
if(!$isFinite(l))return $NaN;
if(!$isFinite(m))return $NaN;
if(!$isFinite(n))return $NaN;
return(%_IsSmi(%IS_VAR(k))?k:%NumberToInteger($toNumber(k)))*3600000
+(%_IsSmi(%IS_VAR(l))?l:%NumberToInteger($toNumber(l)))*60000
+(%_IsSmi(%IS_VAR(m))?m:%NumberToInteger($toNumber(m)))*1000
+(%_IsSmi(%IS_VAR(n))?n:%NumberToInteger($toNumber(n)));
}
function TimeInYear(o){
return DaysInYear(o)*86400000;
}
function MakeDay(o,p,q){
if(!$isFinite(o)||!$isFinite(p)||!$isFinite(q))return $NaN;
o=(%_IsSmi(%IS_VAR(o))?o:%NumberToIntegerMapMinusZero($toNumber(o)));
p=(%_IsSmi(%IS_VAR(p))?p:%NumberToIntegerMapMinusZero($toNumber(p)));
q=(%_IsSmi(%IS_VAR(q))?q:%NumberToIntegerMapMinusZero($toNumber(q)));
if(o<-1000000||o>1000000||
p<-10000000||p>10000000){
return $NaN;
}
return %DateMakeDay(o|0,p|0)+q-1;
}
function MakeDate(r,j){
var j=r*86400000+j;
if($abs(j)>8640002592000000)return $NaN;
return j;
}
function TimeClip(j){
if(!$isFinite(j))return $NaN;
if($abs(j)>8640000000000000)return $NaN;
return(%_IsSmi(%IS_VAR(j))?j:%NumberToInteger($toNumber(j)));
}
var t={
time:0,
string:null
};
function DateConstructor(o,p,q,u,v,w,n){
if(!%_IsConstructCall()){
return(new d()).toString();
}
var x=%_ArgumentsLength();
var y;
if(x==0){
y=%DateCurrentTime();
(%DateSetValue(this,y,1));
}else if(x==1){
if((typeof(o)==='number')){
y=o;
}else if((typeof(o)==='string')){
CheckDateCacheCurrent();
var z=t;
if(z.string===o){
y=z.time;
}else{
y=DateParse(o);
if(!(!%_IsSmi(%IS_VAR(y))&&!(y==y))){
z.time=y;
z.string=o;
}
}
}else{
var j=$toPrimitive(o,1);
y=(typeof(j)==='string')?DateParse(j):$toNumber(j);
}
(%DateSetValue(this,y,1));
}else{
o=$toNumber(o);
p=$toNumber(p);
q=x>2?$toNumber(q):1;
u=x>3?$toNumber(u):0;
v=x>4?$toNumber(v):0;
w=x>5?$toNumber(w):0;
n=x>6?$toNumber(n):0;
o=(!(!%_IsSmi(%IS_VAR(o))&&!(o==o))&&
0<=(%_IsSmi(%IS_VAR(o))?o:%NumberToInteger($toNumber(o)))&&
(%_IsSmi(%IS_VAR(o))?o:%NumberToInteger($toNumber(o)))<=99)?1900+(%_IsSmi(%IS_VAR(o))?o:%NumberToInteger($toNumber(o))):o;
var r=MakeDay(o,p,q);
var j=MakeTime(u,v,w,n);
y=MakeDate(r,j);
(%DateSetValue(this,y,0));
}
}
var A=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
var B=['Jan','Feb','Mar','Apr','May','Jun',
'Jul','Aug','Sep','Oct','Nov','Dec'];
function TwoDigitString(y){
return y<10?"0"+y:""+y;
}
function DateString(q){
return A[(%_DateField(q,4))]+' '
+B[(%_DateField(q,2))]+' '
+TwoDigitString((%_DateField(q,3)))+' '
+(%_DateField(q,1));
}
var C=['Sunday','Monday','Tuesday','Wednesday',
'Thursday','Friday','Saturday'];
var D=['January','February','March','April','May','June',
'July','August','September','October','November','December'];
function LongDateString(q){
return C[(%_DateField(q,4))]+', '
+D[(%_DateField(q,2))]+' '
+TwoDigitString((%_DateField(q,3)))+', '
+(%_DateField(q,1));
}
function TimeString(q){
return TwoDigitString((%_DateField(q,5)))+':'
+TwoDigitString((%_DateField(q,6)))+':'
+TwoDigitString((%_DateField(q,7)));
}
function TimeStringUTC(q){
return TwoDigitString((%_DateField(q,15)))+':'
+TwoDigitString((%_DateField(q,16)))+':'
+TwoDigitString((%_DateField(q,17)));
}
function LocalTimezoneString(q){
var i=LocalTimezone((%_DateField(q,0)));
var E=-(%_DateField(q,21));
var F=(E>=0)?1:-1;
var u=$floor((F*E)/60);
var l=$floor((F*E)%60);
var G=' GMT'+((F==1)?'+':'-')+
TwoDigitString(u)+TwoDigitString(l);
return G+' ('+i+')';
}
function DatePrintString(q){
return DateString(q)+' '+TimeString(q);
}
var H=new InternalArray(8);
function DateParse(I){
var J=%DateParseString($toString(I),H);
if((J===null))return $NaN;
var r=MakeDay(J[0],J[1],J[2]);
var j=MakeTime(J[3],J[4],J[5],J[6]);
var q=MakeDate(r,j);
if((J[7]===null)){
return TimeClip(UTC(q));
}else{
return TimeClip(q-J[7]*1000);
}
}
function DateUTC(o,p,q,u,v,w,n){
o=$toNumber(o);
p=$toNumber(p);
var x=%_ArgumentsLength();
q=x>2?$toNumber(q):1;
u=x>3?$toNumber(u):0;
v=x>4?$toNumber(v):0;
w=x>5?$toNumber(w):0;
n=x>6?$toNumber(n):0;
o=(!(!%_IsSmi(%IS_VAR(o))&&!(o==o))&&
0<=(%_IsSmi(%IS_VAR(o))?o:%NumberToInteger($toNumber(o)))&&
(%_IsSmi(%IS_VAR(o))?o:%NumberToInteger($toNumber(o)))<=99)?1900+(%_IsSmi(%IS_VAR(o))?o:%NumberToInteger($toNumber(o))):o;
var r=MakeDay(o,p,q);
var j=MakeTime(u,v,w,n);
return TimeClip(MakeDate(r,j));
}
function DateNow(){
return %DateCurrentTime();
}
function DateToString(){
var h=(%_DateField(this,0))
if((!%_IsSmi(%IS_VAR(h))&&!(h==h)))return'Invalid Date';
var K=LocalTimezoneString(this)
return DatePrintString(this)+K;
}
function DateToDateString(){
var h=(%_DateField(this,0));
if((!%_IsSmi(%IS_VAR(h))&&!(h==h)))return'Invalid Date';
return DateString(this);
}
function DateToTimeString(){
var h=(%_DateField(this,0));
if((!%_IsSmi(%IS_VAR(h))&&!(h==h)))return'Invalid Date';
var K=LocalTimezoneString(this);
return TimeString(this)+K;
}
function DateToLocaleString(){
return %_CallFunction(this,DateToString);
}
function DateToLocaleDateString(){
var h=(%_DateField(this,0));
if((!%_IsSmi(%IS_VAR(h))&&!(h==h)))return'Invalid Date';
return LongDateString(this);
}
function DateToLocaleTimeString(){
var h=(%_DateField(this,0));
if((!%_IsSmi(%IS_VAR(h))&&!(h==h)))return'Invalid Date';
return TimeString(this);
}
function DateValueOf(){
return(%_DateField(this,0));
}
function DateGetTime(){
return(%_DateField(this,0));
}
function DateGetFullYear(){
return(%_DateField(this,1));
}
function DateGetUTCFullYear(){
return(%_DateField(this,11));
}
function DateGetMonth(){
return(%_DateField(this,2));
}
function DateGetUTCMonth(){
return(%_DateField(this,12));
}
function DateGetDate(){
return(%_DateField(this,3));
}
function DateGetUTCDate(){
return(%_DateField(this,13));
}
function DateGetDay(){
return(%_DateField(this,4));
}
function DateGetUTCDay(){
return(%_DateField(this,14));
}
function DateGetHours(){
return(%_DateField(this,5));
}
function DateGetUTCHours(){
return(%_DateField(this,15));
}
function DateGetMinutes(){
return(%_DateField(this,6));
}
function DateGetUTCMinutes(){
return(%_DateField(this,16));
}
function DateGetSeconds(){
return(%_DateField(this,7));
}
function DateGetUTCSeconds(){
return(%_DateField(this,17))
}
function DateGetMilliseconds(){
return(%_DateField(this,8));
}
function DateGetUTCMilliseconds(){
return(%_DateField(this,18));
}
function DateGetTimezoneOffset(){
return(%_DateField(this,21));
}
function DateSetTime(n){
if(%_ClassOf(this)!=='Date')throw MakeTypeError(17);
(%DateSetValue(this,$toNumber(n),1));
return(%_DateField(this,0));
}
function DateSetMilliseconds(n){
var h=(%_DateField(this,0)+%_DateField(this,21));
n=$toNumber(n);
var j=MakeTime((%_DateField(this,5)),(%_DateField(this,6)),(%_DateField(this,7)),n);
return(%DateSetValue(this,MakeDate((%_DateField(this,9)),j),0));
}
function DateSetUTCMilliseconds(n){
var h=(%_DateField(this,0));
n=$toNumber(n);
var j=MakeTime((%_DateField(this,15)),
(%_DateField(this,16)),
(%_DateField(this,17)),
n);
return(%DateSetValue(this,MakeDate((%_DateField(this,19)),j),1));
}
function DateSetSeconds(m,n){
var h=(%_DateField(this,0)+%_DateField(this,21));
m=$toNumber(m);
n=%_ArgumentsLength()<2?(%_DateField(this,8)):$toNumber(n);
var j=MakeTime((%_DateField(this,5)),(%_DateField(this,6)),m,n);
return(%DateSetValue(this,MakeDate((%_DateField(this,9)),j),0));
}
function DateSetUTCSeconds(m,n){
var h=(%_DateField(this,0));
m=$toNumber(m);
n=%_ArgumentsLength()<2?(%_DateField(this,18)):$toNumber(n);
var j=MakeTime((%_DateField(this,15)),(%_DateField(this,16)),m,n);
return(%DateSetValue(this,MakeDate((%_DateField(this,19)),j),1));
}
function DateSetMinutes(l,m,n){
var h=(%_DateField(this,0)+%_DateField(this,21));
l=$toNumber(l);
var x=%_ArgumentsLength();
m=x<2?(%_DateField(this,7)):$toNumber(m);
n=x<3?(%_DateField(this,8)):$toNumber(n);
var j=MakeTime((%_DateField(this,5)),l,m,n);
return(%DateSetValue(this,MakeDate((%_DateField(this,9)),j),0));
}
function DateSetUTCMinutes(l,m,n){
var h=(%_DateField(this,0));
l=$toNumber(l);
var x=%_ArgumentsLength();
m=x<2?(%_DateField(this,17)):$toNumber(m);
n=x<3?(%_DateField(this,18)):$toNumber(n);
var j=MakeTime((%_DateField(this,15)),l,m,n);
return(%DateSetValue(this,MakeDate((%_DateField(this,19)),j),1));
}
function DateSetHours(k,l,m,n){
var h=(%_DateField(this,0)+%_DateField(this,21));
k=$toNumber(k);
var x=%_ArgumentsLength();
l=x<2?(%_DateField(this,6)):$toNumber(l);
m=x<3?(%_DateField(this,7)):$toNumber(m);
n=x<4?(%_DateField(this,8)):$toNumber(n);
var j=MakeTime(k,l,m,n);
return(%DateSetValue(this,MakeDate((%_DateField(this,9)),j),0));
}
function DateSetUTCHours(k,l,m,n){
var h=(%_DateField(this,0));
k=$toNumber(k);
var x=%_ArgumentsLength();
l=x<2?(%_DateField(this,16)):$toNumber(l);
m=x<3?(%_DateField(this,17)):$toNumber(m);
n=x<4?(%_DateField(this,18)):$toNumber(n);
var j=MakeTime(k,l,m,n);
return(%DateSetValue(this,MakeDate((%_DateField(this,19)),j),1));
}
function DateSetDate(q){
var h=(%_DateField(this,0)+%_DateField(this,21));
q=$toNumber(q);
var r=MakeDay((%_DateField(this,1)),(%_DateField(this,2)),q);
return(%DateSetValue(this,MakeDate(r,(%_DateField(this,10))),0));
}
function DateSetUTCDate(q){
var h=(%_DateField(this,0));
q=$toNumber(q);
var r=MakeDay((%_DateField(this,11)),(%_DateField(this,12)),q);
return(%DateSetValue(this,MakeDate(r,(%_DateField(this,20))),1));
}
function DateSetMonth(p,q){
var h=(%_DateField(this,0)+%_DateField(this,21));
p=$toNumber(p);
q=%_ArgumentsLength()<2?(%_DateField(this,3)):$toNumber(q);
var r=MakeDay((%_DateField(this,1)),p,q);
return(%DateSetValue(this,MakeDate(r,(%_DateField(this,10))),0));
}
function DateSetUTCMonth(p,q){
var h=(%_DateField(this,0));
p=$toNumber(p);
q=%_ArgumentsLength()<2?(%_DateField(this,13)):$toNumber(q);
var r=MakeDay((%_DateField(this,11)),p,q);
return(%DateSetValue(this,MakeDate(r,(%_DateField(this,20))),1));
}
function DateSetFullYear(o,p,q){
var h=(%_DateField(this,0)+%_DateField(this,21));
o=$toNumber(o);
var x=%_ArgumentsLength();
var j;
if((!%_IsSmi(%IS_VAR(h))&&!(h==h))){
p=x<2?0:$toNumber(p);
q=x<3?1:$toNumber(q);
j=0;
}else{
p=x<2?(%_DateField(this,2)):$toNumber(p);
q=x<3?(%_DateField(this,3)):$toNumber(q);
j=(%_DateField(this,10));
}
var r=MakeDay(o,p,q);
return(%DateSetValue(this,MakeDate(r,j),0));
}
function DateSetUTCFullYear(o,p,q){
var h=(%_DateField(this,0));
o=$toNumber(o);
var x=%_ArgumentsLength();
var j;
if((!%_IsSmi(%IS_VAR(h))&&!(h==h))){
p=x<2?0:$toNumber(p);
q=x<3?1:$toNumber(q);
j=0;
}else{
p=x<2?(%_DateField(this,12)):$toNumber(p);
q=x<3?(%_DateField(this,13)):$toNumber(q);
j=(%_DateField(this,20));
}
var r=MakeDay(o,p,q);
return(%DateSetValue(this,MakeDate(r,j),1));
}
function DateToUTCString(){
var h=(%_DateField(this,0));
if((!%_IsSmi(%IS_VAR(h))&&!(h==h)))return'Invalid Date';
return A[(%_DateField(this,14))]+', '
+TwoDigitString((%_DateField(this,13)))+' '
+B[(%_DateField(this,12))]+' '
+(%_DateField(this,11))+' '
+TimeStringUTC(this)+' GMT';
}
function DateGetYear(){
return(%_DateField(this,1))-1900;
}
function DateSetYear(o){
if(%_ClassOf(this)!=='Date')throw MakeTypeError(17);
o=$toNumber(o);
if((!%_IsSmi(%IS_VAR(o))&&!(o==o)))return(%DateSetValue(this,$NaN,1));
o=(0<=(%_IsSmi(%IS_VAR(o))?o:%NumberToInteger($toNumber(o)))&&(%_IsSmi(%IS_VAR(o))?o:%NumberToInteger($toNumber(o)))<=99)
?1900+(%_IsSmi(%IS_VAR(o))?o:%NumberToInteger($toNumber(o))):o;
var h=(%_DateField(this,0)+%_DateField(this,21));
var p,q,j;
if((!%_IsSmi(%IS_VAR(h))&&!(h==h))){
p=0;
q=1;
j=0;
}else{
p=(%_DateField(this,2));
q=(%_DateField(this,3));
j=(%_DateField(this,10));
}
var r=MakeDay(o,p,q);
return(%DateSetValue(this,MakeDate(r,j),0));
}
function DateToGMTString(){
return %_CallFunction(this,DateToUTCString);
}
function PadInt(L,M){
if(M==1)return L;
return L<%_MathPow(10,M-1)?'0'+PadInt(L,M-1):L;
}
function DateToISOString(){
var h=(%_DateField(this,0));
if((!%_IsSmi(%IS_VAR(h))&&!(h==h)))throw MakeRangeError(95);
var o=this.getUTCFullYear();
var N;
if(o>=0&&o<=9999){
N=PadInt(o,4);
}else{
if(o<0){
N="-"+PadInt(-o,6);
}else{
N="+"+PadInt(o,6);
}
}
return N+
'-'+PadInt(this.getUTCMonth()+1,2)+
'-'+PadInt(this.getUTCDate(),2)+
'T'+PadInt(this.getUTCHours(),2)+
':'+PadInt(this.getUTCMinutes(),2)+
':'+PadInt(this.getUTCSeconds(),2)+
'.'+PadInt(this.getUTCMilliseconds(),3)+
'Z';
}
function DateToJSON(O){
var P=$toObject(this);
var Q=$defaultNumber(P);
if((typeof(Q)==='number')&&!(%_IsSmi(%IS_VAR(Q))||((Q==Q)&&(Q!=1/0)&&(Q!=-1/0)))){
return null;
}
return P.toISOString();
}
var R;
var S=$NaN;
function CheckDateCacheCurrent(){
if(!R){
R=%DateCacheVersion();
if(!R)return;
}
if(R[0]==S){
return;
}
S=R[0];
e=$NaN;
g=(void 0);
t.time=$NaN;
t.string=null;
}
function CreateDate(j){
var q=new d();
q.setTime(j);
return q;
}
%SetCode(d,DateConstructor);
%FunctionSetPrototype(d,new d($NaN));
$installFunctions(d,2,[
"UTC",DateUTC,
"parse",DateParse,
"now",DateNow
]);
%AddNamedProperty(d.prototype,"constructor",d,2);
$installFunctions(d.prototype,2,[
"toString",DateToString,
"toDateString",DateToDateString,
"toTimeString",DateToTimeString,
"toLocaleString",DateToLocaleString,
"toLocaleDateString",DateToLocaleDateString,
"toLocaleTimeString",DateToLocaleTimeString,
"valueOf",DateValueOf,
"getTime",DateGetTime,
"getFullYear",DateGetFullYear,
"getUTCFullYear",DateGetUTCFullYear,
"getMonth",DateGetMonth,
"getUTCMonth",DateGetUTCMonth,
"getDate",DateGetDate,
"getUTCDate",DateGetUTCDate,
"getDay",DateGetDay,
"getUTCDay",DateGetUTCDay,
"getHours",DateGetHours,
"getUTCHours",DateGetUTCHours,
"getMinutes",DateGetMinutes,
"getUTCMinutes",DateGetUTCMinutes,
"getSeconds",DateGetSeconds,
"getUTCSeconds",DateGetUTCSeconds,
"getMilliseconds",DateGetMilliseconds,
"getUTCMilliseconds",DateGetUTCMilliseconds,
"getTimezoneOffset",DateGetTimezoneOffset,
"setTime",DateSetTime,
"setMilliseconds",DateSetMilliseconds,
"setUTCMilliseconds",DateSetUTCMilliseconds,
"setSeconds",DateSetSeconds,
"setUTCSeconds",DateSetUTCSeconds,
"setMinutes",DateSetMinutes,
"setUTCMinutes",DateSetUTCMinutes,
"setHours",DateSetHours,
"setUTCHours",DateSetUTCHours,
"setDate",DateSetDate,
"setUTCDate",DateSetUTCDate,
"setMonth",DateSetMonth,
"setUTCMonth",DateSetUTCMonth,
"setFullYear",DateSetFullYear,
"setUTCFullYear",DateSetUTCFullYear,
"toGMTString",DateToGMTString,
"toUTCString",DateToUTCString,
"getYear",DateGetYear,
"setYear",DateSetYear,
"toISOString",DateToISOString,
"toJSON",DateToJSON
]);
$createDate=CreateDate;
})

regexp]m
var $regexpExec;
var $regexpExecNoTests;
var $regexpLastMatchInfo;
var $regexpLastMatchInfoOverride;
var harmony_regexps=false;
var harmony_unicode_regexps=false;
(function(a,b,c){
%CheckIsBootstrapping();
var d=a.RegExp;
$regexpLastMatchInfo=new InternalPackedArray(
2,
"",
(void 0),
0,
0
);
$regexpLastMatchInfoOverride=null;
function DoConstructRegExp(e,g,h){
if((%_IsRegExp(g))){
if(!(h===(void 0))){
throw MakeTypeError('regexp_flags',[]);
}
h=(g.global?'g':'')
+(g.ignoreCase?'i':'')
+(g.multiline?'m':'');
if(harmony_unicode_regexps)
h+=(g.unicode?'u':'');
if(harmony_regexps)
h+=(g.sticky?'y':'');
g=g.source;
}
g=(g===(void 0))?'':$toString(g);
h=(h===(void 0))?'':$toString(h);
%RegExpInitializeAndCompile(e,g,h);
}
function RegExpConstructor(g,h){
if(%_IsConstructCall()){
DoConstructRegExp(this,g,h);
}else{
if((%_IsRegExp(g))&&(h===(void 0))){
return g;
}
return new d(g,h);
}
}
function RegExpCompileJS(g,h){
if(this==d.prototype){
throw MakeTypeError(23,
'RegExp.prototype.compile',this);
}
if((g===(void 0))&&%_ArgumentsLength()!=0){
DoConstructRegExp(this,'undefined',h);
}else{
DoConstructRegExp(this,g,h);
}
}
function DoRegExpExec(i,j,k){
var l=%_RegExpExec(i,j,k,$regexpLastMatchInfo);
if(l!==null)$regexpLastMatchInfoOverride=null;
return l;
}
function RegExpExecNoTests(i,j,m){
var n=%_RegExpExec(i,j,m,$regexpLastMatchInfo);
if(n!==null){
$regexpLastMatchInfoOverride=null;
var o=((n)[0])>>1;
var m=n[3];
var p=n[4];
var q=%_SubString(j,m,p);
var l=%_RegExpConstructResult(o,m,j);
l[0]=q;
if(o==1)return l;
var r=3+2;
for(var t=1;t<o;t++){
m=n[r++];
if(m!=-1){
p=n[r];
l[t]=%_SubString(j,m,p);
}
r++;
}
return l;
;
}
i.lastIndex=0;
return null;
}
function RegExpExecJS(j){
if(!(%_IsRegExp(this))){
throw MakeTypeError(23,
'RegExp.prototype.exec',this);
}
j=((typeof(%IS_VAR(j))==='string')?j:$nonStringToString(j));
var u=this.lastIndex;
var t=(%_IsSmi(%IS_VAR(u))?u:%NumberToInteger($toNumber(u)));
var v=this.global||(harmony_regexps&&this.sticky);
if(v){
if(t<0||t>j.length){
this.lastIndex=0;
return null;
}
}else{
t=0;
}
var w=%_RegExpExec(this,j,t,$regexpLastMatchInfo);
if((w===null)){
this.lastIndex=0;
return null;
}
$regexpLastMatchInfoOverride=null;
if(v){
this.lastIndex=$regexpLastMatchInfo[4];
}
var o=((w)[0])>>1;
var m=w[3];
var p=w[4];
var q=%_SubString(j,m,p);
var l=%_RegExpConstructResult(o,m,j);
l[0]=q;
if(o==1)return l;
var r=3+2;
for(var t=1;t<o;t++){
m=w[r++];
if(m!=-1){
p=w[r];
l[t]=%_SubString(j,m,p);
}
r++;
}
return l;
;
}
var x;
var y;
function RegExpTest(j){
if(!(%_IsRegExp(this))){
throw MakeTypeError(23,
'RegExp.prototype.test',this);
}
j=((typeof(%IS_VAR(j))==='string')?j:$nonStringToString(j));
var u=this.lastIndex;
var t=(%_IsSmi(%IS_VAR(u))?u:%NumberToInteger($toNumber(u)));
if(this.global||(harmony_regexps&&this.sticky)){
if(t<0||t>j.length){
this.lastIndex=0;
return false;
}
var w=%_RegExpExec(this,j,t,$regexpLastMatchInfo);
if((w===null)){
this.lastIndex=0;
return false;
}
$regexpLastMatchInfoOverride=null;
this.lastIndex=$regexpLastMatchInfo[4];
return true;
}else{
var i=this;
if(i.source.length>=3&&
%_StringCharCodeAt(i.source,0)==46&&
%_StringCharCodeAt(i.source,1)==42&&
%_StringCharCodeAt(i.source,2)!=63){
i=TrimRegExp(i);
}
var w=%_RegExpExec(i,j,0,$regexpLastMatchInfo);
if((w===null)){
this.lastIndex=0;
return false;
}
$regexpLastMatchInfoOverride=null;
return true;
}
}
function TrimRegExp(i){
if(!%_ObjectEquals(x,i)){
x=i;
y=
new d(%_SubString(i.source,2,i.source.length),
(i.ignoreCase?i.multiline?"im":"i"
:i.multiline?"m":""));
}
return y;
}
function RegExpToString(){
if(!(%_IsRegExp(this))){
throw MakeTypeError(23,
'RegExp.prototype.toString',this);
}
var l='/'+this.source+'/';
if(this.global)l+='g';
if(this.ignoreCase)l+='i';
if(this.multiline)l+='m';
if(harmony_unicode_regexps&&this.unicode)l+='u';
if(harmony_regexps&&this.sticky)l+='y';
return l;
}
function RegExpGetLastMatch(){
if($regexpLastMatchInfoOverride!==null){
return(($regexpLastMatchInfoOverride)[0]);
}
var z=(($regexpLastMatchInfo)[1]);
return %_SubString(z,
$regexpLastMatchInfo[3],
$regexpLastMatchInfo[4]);
}
function RegExpGetLastParen(){
if($regexpLastMatchInfoOverride){
var A=$regexpLastMatchInfoOverride;
if(A.length<=3)return'';
return A[A.length-3];
}
var B=(($regexpLastMatchInfo)[0]);
if(B<=2)return'';
var z=(($regexpLastMatchInfo)[1]);
var m=$regexpLastMatchInfo[(3+(B-2))];
var p=$regexpLastMatchInfo[(3+(B-1))];
if(m!=-1&&p!=-1){
return %_SubString(z,m,p);
}
return"";
}
function RegExpGetLeftContext(){
var C;
var D;
if(!$regexpLastMatchInfoOverride){
C=$regexpLastMatchInfo[3];
D=(($regexpLastMatchInfo)[1]);
}else{
var A=$regexpLastMatchInfoOverride;
C=((A)[(A).length-2]);
D=((A)[(A).length-1]);
}
return %_SubString(D,0,C);
}
function RegExpGetRightContext(){
var C;
var D;
if(!$regexpLastMatchInfoOverride){
C=$regexpLastMatchInfo[4];
D=(($regexpLastMatchInfo)[1]);
}else{
var A=$regexpLastMatchInfoOverride;
D=((A)[(A).length-1]);
var E=((A)[0]);
C=((A)[(A).length-2])+E.length;
}
return %_SubString(D,C,D.length);
}
function RegExpMakeCaptureGetter(F){
return function foo(){
if($regexpLastMatchInfoOverride){
if(F<$regexpLastMatchInfoOverride.length-2){
return(($regexpLastMatchInfoOverride)[(F)]);
}
return'';
}
var k=F*2;
if(k>=(($regexpLastMatchInfo)[0]))return'';
var G=$regexpLastMatchInfo[(3+(k))];
var H=$regexpLastMatchInfo[(3+(k+1))];
if(G==-1||H==-1)return'';
return %_SubString((($regexpLastMatchInfo)[1]),G,H);
};
}
%FunctionSetInstanceClassName(d,'RegExp');
%AddNamedProperty(
d.prototype,'constructor',d,2);
%SetCode(d,RegExpConstructor);
$installFunctions(d.prototype,2,[
"exec",RegExpExecJS,
"test",RegExpTest,
"toString",RegExpToString,
"compile",RegExpCompileJS
]);
%FunctionSetLength(d.prototype.compile,1);
var I=function(){
var J=(($regexpLastMatchInfo)[2]);
return(J===(void 0))?"":J;
};
var K=function(j){
(($regexpLastMatchInfo)[2])=$toString(j);
};
%OptimizeObjectForAddingMultipleProperties(d,22);
%DefineAccessorPropertyUnchecked(d,'input',I,
K,4);
%DefineAccessorPropertyUnchecked(d,'$_',I,
K,2|4);
var L=false;
var M=function(){return L;};
var N=function(O){L=O?true:false;};
%DefineAccessorPropertyUnchecked(d,'multiline',M,
N,4);
%DefineAccessorPropertyUnchecked(d,'$*',M,
N,
2|4);
var P=function(Q){};
%DefineAccessorPropertyUnchecked(d,'lastMatch',RegExpGetLastMatch,
P,4);
%DefineAccessorPropertyUnchecked(d,'$&',RegExpGetLastMatch,
P,2|4);
%DefineAccessorPropertyUnchecked(d,'lastParen',RegExpGetLastParen,
P,4);
%DefineAccessorPropertyUnchecked(d,'$+',RegExpGetLastParen,
P,2|4);
%DefineAccessorPropertyUnchecked(d,'leftContext',
RegExpGetLeftContext,P,
4);
%DefineAccessorPropertyUnchecked(d,'$`',RegExpGetLeftContext,
P,2|4);
%DefineAccessorPropertyUnchecked(d,'rightContext',
RegExpGetRightContext,P,
4);
%DefineAccessorPropertyUnchecked(d,"$'",RegExpGetRightContext,
P,2|4);
for(var t=1;t<10;++t){
%DefineAccessorPropertyUnchecked(d,'$'+t,
RegExpMakeCaptureGetter(t),P,
4);
}
%ToFastProperties(d);
$regexpExecNoTests=RegExpExecNoTests;
$regexpExec=DoRegExpExec;
})

,arraybufferq
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.ArrayBuffer;
var e=a.Object;
function ArrayBufferConstructor(g){
if(%_IsConstructCall()){
var h=$toPositiveInteger(g,85);
%ArrayBufferInitialize(this,h);
}else{
throw MakeTypeError(14,"ArrayBuffer");
}
}
function ArrayBufferGetByteLen(){
if(!(%_ClassOf(this)==='ArrayBuffer')){
throw MakeTypeError(23,
'ArrayBuffer.prototype.byteLength',this);
}
return %_ArrayBufferGetByteLength(this);
}
function ArrayBufferSlice(i,j){
if(!(%_ClassOf(this)==='ArrayBuffer')){
throw MakeTypeError(23,
'ArrayBuffer.prototype.slice',this);
}
var k=(%_IsSmi(%IS_VAR(i))?i:%NumberToInteger($toNumber(i)));
if(!(j===(void 0))){
j=(%_IsSmi(%IS_VAR(j))?j:%NumberToInteger($toNumber(j)));
}
var l;
var m=%_ArrayBufferGetByteLength(this);
if(k<0){
l=$max(m+k,0);
}else{
l=$min(k,m);
}
var n=(j===(void 0))?m:j;
var o;
if(n<0){
o=$max(m+n,0);
}else{
o=$min(n,m);
}
if(o<l){
o=l;
}
var p=o-l;
var q=new d(p);
%ArrayBufferSliceImpl(this,q,l);
return q;
}
function ArrayBufferIsViewJS(r){
return %ArrayBufferIsView(r);
}
%SetCode(d,ArrayBufferConstructor);
%FunctionSetPrototype(d,new e());
%AddNamedProperty(
d.prototype,"constructor",d,2);
%AddNamedProperty(d.prototype,
symbolToStringTag,"ArrayBuffer",2|1);
$installGetter(d.prototype,"byteLength",ArrayBufferGetByteLen);
$installFunctions(d,2,[
"isView",ArrayBufferIsViewJS
]);
$installFunctions(d.prototype,2,[
"slice",ArrayBufferSlice
]);
})

(typedarrayB`
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Array;
var e=a.ArrayBuffer;
var g=a.DataView;
var h=a.Object;
var i=a.Uint8Array;

var j=a.Int8Array;

var k=a.Uint16Array;

var l=a.Int16Array;

var m=a.Uint32Array;

var n=a.Int32Array;

var o=a.Float32Array;

var p=a.Float64Array;

var q=a.Uint8ClampedArray;


function Uint8ArrayConstructByArrayBuffer(r,t,u,v){
if(!(u===(void 0))){
u=
$toPositiveInteger(u,97);
}
if(!(v===(void 0))){
v=$toPositiveInteger(v,97);
}
var w=%_ArrayBufferGetByteLength(t);
var x;
if((u===(void 0))){
x=0;
}else{
x=u;
if(x % 1!==0){
throw MakeRangeError(96,
"start offset","Uint8Array",1);
}
if(x>w){
throw MakeRangeError(98);
}
}
var y;
var z;
if((v===(void 0))){
if(w % 1!==0){
throw MakeRangeError(96,
"byte length","Uint8Array",1);
}
y=w-x;
z=y/1;
}else{
var z=v;
y=z*1;
}
if((x+y>w)
||(z>%_MaxSmi())){
throw MakeRangeError(97);
}
%_TypedArrayInitialize(r,1,t,x,y);
}
function Uint8ArrayConstructByLength(r,v){
var A=(v===(void 0))?
0:$toPositiveInteger(v,97);
if(A>%_MaxSmi()){
throw MakeRangeError(97);
}
var B=A*1;
if(B>%_TypedArrayMaxSizeInHeap()){
var t=new e(B);
%_TypedArrayInitialize(r,1,t,0,B);
}else{
%_TypedArrayInitialize(r,1,null,0,B);
}
}
function Uint8ArrayConstructByArrayLike(r,C){
var v=C.length;
var A=$toPositiveInteger(v,97);
if(A>%_MaxSmi()){
throw MakeRangeError(97);
}
if(!%TypedArrayInitializeFromArrayLike(r,1,C,A)){
for(var D=0;D<A;D++){
r[D]=C[D];
}
}
}
function Uint8ArrayConstructor(E,F,G){
if(%_IsConstructCall()){
if((%_ClassOf(E)==='ArrayBuffer')){
Uint8ArrayConstructByArrayBuffer(this,E,F,G);
}else if((typeof(E)==='number')||(typeof(E)==='string')||
(typeof(E)==='boolean')||(E===(void 0))){
Uint8ArrayConstructByLength(this,E);
}else{
Uint8ArrayConstructByArrayLike(this,E);
}
}else{
throw MakeTypeError(14,"Uint8Array")
}
}
function Uint8Array_GetBuffer(){
if(!(%_ClassOf(this)==='Uint8Array')){
throw MakeTypeError(23,"Uint8Array.buffer",this);
}
return %TypedArrayGetBuffer(this);
}
function Uint8Array_GetByteLength(){
if(!(%_ClassOf(this)==='Uint8Array')){
throw MakeTypeError(23,"Uint8Array.byteLength",this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function Uint8Array_GetByteOffset(){
if(!(%_ClassOf(this)==='Uint8Array')){
throw MakeTypeError(23,"Uint8Array.byteOffset",this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function Uint8Array_GetLength(){
if(!(%_ClassOf(this)==='Uint8Array')){
throw MakeTypeError(23,"Uint8Array.length",this);
}
return %_TypedArrayGetLength(this);
}
function Uint8ArraySubArray(H,I){
if(!(%_ClassOf(this)==='Uint8Array')){
throw MakeTypeError(23,"Uint8Array.subarray",this);
}
var J=(%_IsSmi(%IS_VAR(H))?H:%NumberToInteger($toNumber(H)));
if(!(I===(void 0))){
I=(%_IsSmi(%IS_VAR(I))?I:%NumberToInteger($toNumber(I)));
}
var K=%_TypedArrayGetLength(this);
if(J<0){
J=$max(0,K+J);
}else{
J=$min(K,J);
}
var L=(I===(void 0))?K:I;
if(L<0){
L=$max(0,K+L);
}else{
L=$min(L,K);
}
if(L<J){
L=J;
}
var z=L-J;
var M=
%_ArrayBufferViewGetByteOffset(this)+J*1;
return new i(%TypedArrayGetBuffer(this),
M,z);
}

function Int8ArrayConstructByArrayBuffer(r,t,u,v){
if(!(u===(void 0))){
u=
$toPositiveInteger(u,97);
}
if(!(v===(void 0))){
v=$toPositiveInteger(v,97);
}
var w=%_ArrayBufferGetByteLength(t);
var x;
if((u===(void 0))){
x=0;
}else{
x=u;
if(x % 1!==0){
throw MakeRangeError(96,
"start offset","Int8Array",1);
}
if(x>w){
throw MakeRangeError(98);
}
}
var y;
var z;
if((v===(void 0))){
if(w % 1!==0){
throw MakeRangeError(96,
"byte length","Int8Array",1);
}
y=w-x;
z=y/1;
}else{
var z=v;
y=z*1;
}
if((x+y>w)
||(z>%_MaxSmi())){
throw MakeRangeError(97);
}
%_TypedArrayInitialize(r,2,t,x,y);
}
function Int8ArrayConstructByLength(r,v){
var A=(v===(void 0))?
0:$toPositiveInteger(v,97);
if(A>%_MaxSmi()){
throw MakeRangeError(97);
}
var B=A*1;
if(B>%_TypedArrayMaxSizeInHeap()){
var t=new e(B);
%_TypedArrayInitialize(r,2,t,0,B);
}else{
%_TypedArrayInitialize(r,2,null,0,B);
}
}
function Int8ArrayConstructByArrayLike(r,C){
var v=C.length;
var A=$toPositiveInteger(v,97);
if(A>%_MaxSmi()){
throw MakeRangeError(97);
}
if(!%TypedArrayInitializeFromArrayLike(r,2,C,A)){
for(var D=0;D<A;D++){
r[D]=C[D];
}
}
}
function Int8ArrayConstructor(E,F,G){
if(%_IsConstructCall()){
if((%_ClassOf(E)==='ArrayBuffer')){
Int8ArrayConstructByArrayBuffer(this,E,F,G);
}else if((typeof(E)==='number')||(typeof(E)==='string')||
(typeof(E)==='boolean')||(E===(void 0))){
Int8ArrayConstructByLength(this,E);
}else{
Int8ArrayConstructByArrayLike(this,E);
}
}else{
throw MakeTypeError(14,"Int8Array")
}
}
function Int8Array_GetBuffer(){
if(!(%_ClassOf(this)==='Int8Array')){
throw MakeTypeError(23,"Int8Array.buffer",this);
}
return %TypedArrayGetBuffer(this);
}
function Int8Array_GetByteLength(){
if(!(%_ClassOf(this)==='Int8Array')){
throw MakeTypeError(23,"Int8Array.byteLength",this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function Int8Array_GetByteOffset(){
if(!(%_ClassOf(this)==='Int8Array')){
throw MakeTypeError(23,"Int8Array.byteOffset",this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function Int8Array_GetLength(){
if(!(%_ClassOf(this)==='Int8Array')){
throw MakeTypeError(23,"Int8Array.length",this);
}
return %_TypedArrayGetLength(this);
}
function Int8ArraySubArray(H,I){
if(!(%_ClassOf(this)==='Int8Array')){
throw MakeTypeError(23,"Int8Array.subarray",this);
}
var J=(%_IsSmi(%IS_VAR(H))?H:%NumberToInteger($toNumber(H)));
if(!(I===(void 0))){
I=(%_IsSmi(%IS_VAR(I))?I:%NumberToInteger($toNumber(I)));
}
var K=%_TypedArrayGetLength(this);
if(J<0){
J=$max(0,K+J);
}else{
J=$min(K,J);
}
var L=(I===(void 0))?K:I;
if(L<0){
L=$max(0,K+L);
}else{
L=$min(L,K);
}
if(L<J){
L=J;
}
var z=L-J;
var M=
%_ArrayBufferViewGetByteOffset(this)+J*1;
return new j(%TypedArrayGetBuffer(this),
M,z);
}

function Uint16ArrayConstructByArrayBuffer(r,t,u,v){
if(!(u===(void 0))){
u=
$toPositiveInteger(u,97);
}
if(!(v===(void 0))){
v=$toPositiveInteger(v,97);
}
var w=%_ArrayBufferGetByteLength(t);
var x;
if((u===(void 0))){
x=0;
}else{
x=u;
if(x % 2!==0){
throw MakeRangeError(96,
"start offset","Uint16Array",2);
}
if(x>w){
throw MakeRangeError(98);
}
}
var y;
var z;
if((v===(void 0))){
if(w % 2!==0){
throw MakeRangeError(96,
"byte length","Uint16Array",2);
}
y=w-x;
z=y/2;
}else{
var z=v;
y=z*2;
}
if((x+y>w)
||(z>%_MaxSmi())){
throw MakeRangeError(97);
}
%_TypedArrayInitialize(r,3,t,x,y);
}
function Uint16ArrayConstructByLength(r,v){
var A=(v===(void 0))?
0:$toPositiveInteger(v,97);
if(A>%_MaxSmi()){
throw MakeRangeError(97);
}
var B=A*2;
if(B>%_TypedArrayMaxSizeInHeap()){
var t=new e(B);
%_TypedArrayInitialize(r,3,t,0,B);
}else{
%_TypedArrayInitialize(r,3,null,0,B);
}
}
function Uint16ArrayConstructByArrayLike(r,C){
var v=C.length;
var A=$toPositiveInteger(v,97);
if(A>%_MaxSmi()){
throw MakeRangeError(97);
}
if(!%TypedArrayInitializeFromArrayLike(r,3,C,A)){
for(var D=0;D<A;D++){
r[D]=C[D];
}
}
}
function Uint16ArrayConstructor(E,F,G){
if(%_IsConstructCall()){
if((%_ClassOf(E)==='ArrayBuffer')){
Uint16ArrayConstructByArrayBuffer(this,E,F,G);
}else if((typeof(E)==='number')||(typeof(E)==='string')||
(typeof(E)==='boolean')||(E===(void 0))){
Uint16ArrayConstructByLength(this,E);
}else{
Uint16ArrayConstructByArrayLike(this,E);
}
}else{
throw MakeTypeError(14,"Uint16Array")
}
}
function Uint16Array_GetBuffer(){
if(!(%_ClassOf(this)==='Uint16Array')){
throw MakeTypeError(23,"Uint16Array.buffer",this);
}
return %TypedArrayGetBuffer(this);
}
function Uint16Array_GetByteLength(){
if(!(%_ClassOf(this)==='Uint16Array')){
throw MakeTypeError(23,"Uint16Array.byteLength",this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function Uint16Array_GetByteOffset(){
if(!(%_ClassOf(this)==='Uint16Array')){
throw MakeTypeError(23,"Uint16Array.byteOffset",this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function Uint16Array_GetLength(){
if(!(%_ClassOf(this)==='Uint16Array')){
throw MakeTypeError(23,"Uint16Array.length",this);
}
return %_TypedArrayGetLength(this);
}
function Uint16ArraySubArray(H,I){
if(!(%_ClassOf(this)==='Uint16Array')){
throw MakeTypeError(23,"Uint16Array.subarray",this);
}
var J=(%_IsSmi(%IS_VAR(H))?H:%NumberToInteger($toNumber(H)));
if(!(I===(void 0))){
I=(%_IsSmi(%IS_VAR(I))?I:%NumberToInteger($toNumber(I)));
}
var K=%_TypedArrayGetLength(this);
if(J<0){
J=$max(0,K+J);
}else{
J=$min(K,J);
}
var L=(I===(void 0))?K:I;
if(L<0){
L=$max(0,K+L);
}else{
L=$min(L,K);
}
if(L<J){
L=J;
}
var z=L-J;
var M=
%_ArrayBufferViewGetByteOffset(this)+J*2;
return new k(%TypedArrayGetBuffer(this),
M,z);
}

function Int16ArrayConstructByArrayBuffer(r,t,u,v){
if(!(u===(void 0))){
u=
$toPositiveInteger(u,97);
}
if(!(v===(void 0))){
v=$toPositiveInteger(v,97);
}
var w=%_ArrayBufferGetByteLength(t);
var x;
if((u===(void 0))){
x=0;
}else{
x=u;
if(x % 2!==0){
throw MakeRangeError(96,
"start offset","Int16Array",2);
}
if(x>w){
throw MakeRangeError(98);
}
}
var y;
var z;
if((v===(void 0))){
if(w % 2!==0){
throw MakeRangeError(96,
"byte length","Int16Array",2);
}
y=w-x;
z=y/2;
}else{
var z=v;
y=z*2;
}
if((x+y>w)
||(z>%_MaxSmi())){
throw MakeRangeError(97);
}
%_TypedArrayInitialize(r,4,t,x,y);
}
function Int16ArrayConstructByLength(r,v){
var A=(v===(void 0))?
0:$toPositiveInteger(v,97);
if(A>%_MaxSmi()){
throw MakeRangeError(97);
}
var B=A*2;
if(B>%_TypedArrayMaxSizeInHeap()){
var t=new e(B);
%_TypedArrayInitialize(r,4,t,0,B);
}else{
%_TypedArrayInitialize(r,4,null,0,B);
}
}
function Int16ArrayConstructByArrayLike(r,C){
var v=C.length;
var A=$toPositiveInteger(v,97);
if(A>%_MaxSmi()){
throw MakeRangeError(97);
}
if(!%TypedArrayInitializeFromArrayLike(r,4,C,A)){
for(var D=0;D<A;D++){
r[D]=C[D];
}
}
}
function Int16ArrayConstructor(E,F,G){
if(%_IsConstructCall()){
if((%_ClassOf(E)==='ArrayBuffer')){
Int16ArrayConstructByArrayBuffer(this,E,F,G);
}else if((typeof(E)==='number')||(typeof(E)==='string')||
(typeof(E)==='boolean')||(E===(void 0))){
Int16ArrayConstructByLength(this,E);
}else{
Int16ArrayConstructByArrayLike(this,E);
}
}else{
throw MakeTypeError(14,"Int16Array")
}
}
function Int16Array_GetBuffer(){
if(!(%_ClassOf(this)==='Int16Array')){
throw MakeTypeError(23,"Int16Array.buffer",this);
}
return %TypedArrayGetBuffer(this);
}
function Int16Array_GetByteLength(){
if(!(%_ClassOf(this)==='Int16Array')){
throw MakeTypeError(23,"Int16Array.byteLength",this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function Int16Array_GetByteOffset(){
if(!(%_ClassOf(this)==='Int16Array')){
throw MakeTypeError(23,"Int16Array.byteOffset",this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function Int16Array_GetLength(){
if(!(%_ClassOf(this)==='Int16Array')){
throw MakeTypeError(23,"Int16Array.length",this);
}
return %_TypedArrayGetLength(this);
}
function Int16ArraySubArray(H,I){
if(!(%_ClassOf(this)==='Int16Array')){
throw MakeTypeError(23,"Int16Array.subarray",this);
}
var J=(%_IsSmi(%IS_VAR(H))?H:%NumberToInteger($toNumber(H)));
if(!(I===(void 0))){
I=(%_IsSmi(%IS_VAR(I))?I:%NumberToInteger($toNumber(I)));
}
var K=%_TypedArrayGetLength(this);
if(J<0){
J=$max(0,K+J);
}else{
J=$min(K,J);
}
var L=(I===(void 0))?K:I;
if(L<0){
L=$max(0,K+L);
}else{
L=$min(L,K);
}
if(L<J){
L=J;
}
var z=L-J;
var M=
%_ArrayBufferViewGetByteOffset(this)+J*2;
return new l(%TypedArrayGetBuffer(this),
M,z);
}

function Uint32ArrayConstructByArrayBuffer(r,t,u,v){
if(!(u===(void 0))){
u=
$toPositiveInteger(u,97);
}
if(!(v===(void 0))){
v=$toPositiveInteger(v,97);
}
var w=%_ArrayBufferGetByteLength(t);
var x;
if((u===(void 0))){
x=0;
}else{
x=u;
if(x % 4!==0){
throw MakeRangeError(96,
"start offset","Uint32Array",4);
}
if(x>w){
throw MakeRangeError(98);
}
}
var y;
var z;
if((v===(void 0))){
if(w % 4!==0){
throw MakeRangeError(96,
"byte length","Uint32Array",4);
}
y=w-x;
z=y/4;
}else{
var z=v;
y=z*4;
}
if((x+y>w)
||(z>%_MaxSmi())){
throw MakeRangeError(97);
}
%_TypedArrayInitialize(r,5,t,x,y);
}
function Uint32ArrayConstructByLength(r,v){
var A=(v===(void 0))?
0:$toPositiveInteger(v,97);
if(A>%_MaxSmi()){
throw MakeRangeError(97);
}
var B=A*4;
if(B>%_TypedArrayMaxSizeInHeap()){
var t=new e(B);
%_TypedArrayInitialize(r,5,t,0,B);
}else{
%_TypedArrayInitialize(r,5,null,0,B);
}
}
function Uint32ArrayConstructByArrayLike(r,C){
var v=C.length;
var A=$toPositiveInteger(v,97);
if(A>%_MaxSmi()){
throw MakeRangeError(97);
}
if(!%TypedArrayInitializeFromArrayLike(r,5,C,A)){
for(var D=0;D<A;D++){
r[D]=C[D];
}
}
}
function Uint32ArrayConstructor(E,F,G){
if(%_IsConstructCall()){
if((%_ClassOf(E)==='ArrayBuffer')){
Uint32ArrayConstructByArrayBuffer(this,E,F,G);
}else if((typeof(E)==='number')||(typeof(E)==='string')||
(typeof(E)==='boolean')||(E===(void 0))){
Uint32ArrayConstructByLength(this,E);
}else{
Uint32ArrayConstructByArrayLike(this,E);
}
}else{
throw MakeTypeError(14,"Uint32Array")
}
}
function Uint32Array_GetBuffer(){
if(!(%_ClassOf(this)==='Uint32Array')){
throw MakeTypeError(23,"Uint32Array.buffer",this);
}
return %TypedArrayGetBuffer(this);
}
function Uint32Array_GetByteLength(){
if(!(%_ClassOf(this)==='Uint32Array')){
throw MakeTypeError(23,"Uint32Array.byteLength",this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function Uint32Array_GetByteOffset(){
if(!(%_ClassOf(this)==='Uint32Array')){
throw MakeTypeError(23,"Uint32Array.byteOffset",this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function Uint32Array_GetLength(){
if(!(%_ClassOf(this)==='Uint32Array')){
throw MakeTypeError(23,"Uint32Array.length",this);
}
return %_TypedArrayGetLength(this);
}
function Uint32ArraySubArray(H,I){
if(!(%_ClassOf(this)==='Uint32Array')){
throw MakeTypeError(23,"Uint32Array.subarray",this);
}
var J=(%_IsSmi(%IS_VAR(H))?H:%NumberToInteger($toNumber(H)));
if(!(I===(void 0))){
I=(%_IsSmi(%IS_VAR(I))?I:%NumberToInteger($toNumber(I)));
}
var K=%_TypedArrayGetLength(this);
if(J<0){
J=$max(0,K+J);
}else{
J=$min(K,J);
}
var L=(I===(void 0))?K:I;
if(L<0){
L=$max(0,K+L);
}else{
L=$min(L,K);
}
if(L<J){
L=J;
}
var z=L-J;
var M=
%_ArrayBufferViewGetByteOffset(this)+J*4;
return new m(%TypedArrayGetBuffer(this),
M,z);
}

function Int32ArrayConstructByArrayBuffer(r,t,u,v){
if(!(u===(void 0))){
u=
$toPositiveInteger(u,97);
}
if(!(v===(void 0))){
v=$toPositiveInteger(v,97);
}
var w=%_ArrayBufferGetByteLength(t);
var x;
if((u===(void 0))){
x=0;
}else{
x=u;
if(x % 4!==0){
throw MakeRangeError(96,
"start offset","Int32Array",4);
}
if(x>w){
throw MakeRangeError(98);
}
}
var y;
var z;
if((v===(void 0))){
if(w % 4!==0){
throw MakeRangeError(96,
"byte length","Int32Array",4);
}
y=w-x;
z=y/4;
}else{
var z=v;
y=z*4;
}
if((x+y>w)
||(z>%_MaxSmi())){
throw MakeRangeError(97);
}
%_TypedArrayInitialize(r,6,t,x,y);
}
function Int32ArrayConstructByLength(r,v){
var A=(v===(void 0))?
0:$toPositiveInteger(v,97);
if(A>%_MaxSmi()){
throw MakeRangeError(97);
}
var B=A*4;
if(B>%_TypedArrayMaxSizeInHeap()){
var t=new e(B);
%_TypedArrayInitialize(r,6,t,0,B);
}else{
%_TypedArrayInitialize(r,6,null,0,B);
}
}
function Int32ArrayConstructByArrayLike(r,C){
var v=C.length;
var A=$toPositiveInteger(v,97);
if(A>%_MaxSmi()){
throw MakeRangeError(97);
}
if(!%TypedArrayInitializeFromArrayLike(r,6,C,A)){
for(var D=0;D<A;D++){
r[D]=C[D];
}
}
}
function Int32ArrayConstructor(E,F,G){
if(%_IsConstructCall()){
if((%_ClassOf(E)==='ArrayBuffer')){
Int32ArrayConstructByArrayBuffer(this,E,F,G);
}else if((typeof(E)==='number')||(typeof(E)==='string')||
(typeof(E)==='boolean')||(E===(void 0))){
Int32ArrayConstructByLength(this,E);
}else{
Int32ArrayConstructByArrayLike(this,E);
}
}else{
throw MakeTypeError(14,"Int32Array")
}
}
function Int32Array_GetBuffer(){
if(!(%_ClassOf(this)==='Int32Array')){
throw MakeTypeError(23,"Int32Array.buffer",this);
}
return %TypedArrayGetBuffer(this);
}
function Int32Array_GetByteLength(){
if(!(%_ClassOf(this)==='Int32Array')){
throw MakeTypeError(23,"Int32Array.byteLength",this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function Int32Array_GetByteOffset(){
if(!(%_ClassOf(this)==='Int32Array')){
throw MakeTypeError(23,"Int32Array.byteOffset",this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function Int32Array_GetLength(){
if(!(%_ClassOf(this)==='Int32Array')){
throw MakeTypeError(23,"Int32Array.length",this);
}
return %_TypedArrayGetLength(this);
}
function Int32ArraySubArray(H,I){
if(!(%_ClassOf(this)==='Int32Array')){
throw MakeTypeError(23,"Int32Array.subarray",this);
}
var J=(%_IsSmi(%IS_VAR(H))?H:%NumberToInteger($toNumber(H)));
if(!(I===(void 0))){
I=(%_IsSmi(%IS_VAR(I))?I:%NumberToInteger($toNumber(I)));
}
var K=%_TypedArrayGetLength(this);
if(J<0){
J=$max(0,K+J);
}else{
J=$min(K,J);
}
var L=(I===(void 0))?K:I;
if(L<0){
L=$max(0,K+L);
}else{
L=$min(L,K);
}
if(L<J){
L=J;
}
var z=L-J;
var M=
%_ArrayBufferViewGetByteOffset(this)+J*4;
return new n(%TypedArrayGetBuffer(this),
M,z);
}

function Float32ArrayConstructByArrayBuffer(r,t,u,v){
if(!(u===(void 0))){
u=
$toPositiveInteger(u,97);
}
if(!(v===(void 0))){
v=$toPositiveInteger(v,97);
}
var w=%_ArrayBufferGetByteLength(t);
var x;
if((u===(void 0))){
x=0;
}else{
x=u;
if(x % 4!==0){
throw MakeRangeError(96,
"start offset","Float32Array",4);
}
if(x>w){
throw MakeRangeError(98);
}
}
var y;
var z;
if((v===(void 0))){
if(w % 4!==0){
throw MakeRangeError(96,
"byte length","Float32Array",4);
}
y=w-x;
z=y/4;
}else{
var z=v;
y=z*4;
}
if((x+y>w)
||(z>%_MaxSmi())){
throw MakeRangeError(97);
}
%_TypedArrayInitialize(r,7,t,x,y);
}
function Float32ArrayConstructByLength(r,v){
var A=(v===(void 0))?
0:$toPositiveInteger(v,97);
if(A>%_MaxSmi()){
throw MakeRangeError(97);
}
var B=A*4;
if(B>%_TypedArrayMaxSizeInHeap()){
var t=new e(B);
%_TypedArrayInitialize(r,7,t,0,B);
}else{
%_TypedArrayInitialize(r,7,null,0,B);
}
}
function Float32ArrayConstructByArrayLike(r,C){
var v=C.length;
var A=$toPositiveInteger(v,97);
if(A>%_MaxSmi()){
throw MakeRangeError(97);
}
if(!%TypedArrayInitializeFromArrayLike(r,7,C,A)){
for(var D=0;D<A;D++){
r[D]=C[D];
}
}
}
function Float32ArrayConstructor(E,F,G){
if(%_IsConstructCall()){
if((%_ClassOf(E)==='ArrayBuffer')){
Float32ArrayConstructByArrayBuffer(this,E,F,G);
}else if((typeof(E)==='number')||(typeof(E)==='string')||
(typeof(E)==='boolean')||(E===(void 0))){
Float32ArrayConstructByLength(this,E);
}else{
Float32ArrayConstructByArrayLike(this,E);
}
}else{
throw MakeTypeError(14,"Float32Array")
}
}
function Float32Array_GetBuffer(){
if(!(%_ClassOf(this)==='Float32Array')){
throw MakeTypeError(23,"Float32Array.buffer",this);
}
return %TypedArrayGetBuffer(this);
}
function Float32Array_GetByteLength(){
if(!(%_ClassOf(this)==='Float32Array')){
throw MakeTypeError(23,"Float32Array.byteLength",this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function Float32Array_GetByteOffset(){
if(!(%_ClassOf(this)==='Float32Array')){
throw MakeTypeError(23,"Float32Array.byteOffset",this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function Float32Array_GetLength(){
if(!(%_ClassOf(this)==='Float32Array')){
throw MakeTypeError(23,"Float32Array.length",this);
}
return %_TypedArrayGetLength(this);
}
function Float32ArraySubArray(H,I){
if(!(%_ClassOf(this)==='Float32Array')){
throw MakeTypeError(23,"Float32Array.subarray",this);
}
var J=(%_IsSmi(%IS_VAR(H))?H:%NumberToInteger($toNumber(H)));
if(!(I===(void 0))){
I=(%_IsSmi(%IS_VAR(I))?I:%NumberToInteger($toNumber(I)));
}
var K=%_TypedArrayGetLength(this);
if(J<0){
J=$max(0,K+J);
}else{
J=$min(K,J);
}
var L=(I===(void 0))?K:I;
if(L<0){
L=$max(0,K+L);
}else{
L=$min(L,K);
}
if(L<J){
L=J;
}
var z=L-J;
var M=
%_ArrayBufferViewGetByteOffset(this)+J*4;
return new o(%TypedArrayGetBuffer(this),
M,z);
}

function Float64ArrayConstructByArrayBuffer(r,t,u,v){
if(!(u===(void 0))){
u=
$toPositiveInteger(u,97);
}
if(!(v===(void 0))){
v=$toPositiveInteger(v,97);
}
var w=%_ArrayBufferGetByteLength(t);
var x;
if((u===(void 0))){
x=0;
}else{
x=u;
if(x % 8!==0){
throw MakeRangeError(96,
"start offset","Float64Array",8);
}
if(x>w){
throw MakeRangeError(98);
}
}
var y;
var z;
if((v===(void 0))){
if(w % 8!==0){
throw MakeRangeError(96,
"byte length","Float64Array",8);
}
y=w-x;
z=y/8;
}else{
var z=v;
y=z*8;
}
if((x+y>w)
||(z>%_MaxSmi())){
throw MakeRangeError(97);
}
%_TypedArrayInitialize(r,8,t,x,y);
}
function Float64ArrayConstructByLength(r,v){
var A=(v===(void 0))?
0:$toPositiveInteger(v,97);
if(A>%_MaxSmi()){
throw MakeRangeError(97);
}
var B=A*8;
if(B>%_TypedArrayMaxSizeInHeap()){
var t=new e(B);
%_TypedArrayInitialize(r,8,t,0,B);
}else{
%_TypedArrayInitialize(r,8,null,0,B);
}
}
function Float64ArrayConstructByArrayLike(r,C){
var v=C.length;
var A=$toPositiveInteger(v,97);
if(A>%_MaxSmi()){
throw MakeRangeError(97);
}
if(!%TypedArrayInitializeFromArrayLike(r,8,C,A)){
for(var D=0;D<A;D++){
r[D]=C[D];
}
}
}
function Float64ArrayConstructor(E,F,G){
if(%_IsConstructCall()){
if((%_ClassOf(E)==='ArrayBuffer')){
Float64ArrayConstructByArrayBuffer(this,E,F,G);
}else if((typeof(E)==='number')||(typeof(E)==='string')||
(typeof(E)==='boolean')||(E===(void 0))){
Float64ArrayConstructByLength(this,E);
}else{
Float64ArrayConstructByArrayLike(this,E);
}
}else{
throw MakeTypeError(14,"Float64Array")
}
}
function Float64Array_GetBuffer(){
if(!(%_ClassOf(this)==='Float64Array')){
throw MakeTypeError(23,"Float64Array.buffer",this);
}
return %TypedArrayGetBuffer(this);
}
function Float64Array_GetByteLength(){
if(!(%_ClassOf(this)==='Float64Array')){
throw MakeTypeError(23,"Float64Array.byteLength",this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function Float64Array_GetByteOffset(){
if(!(%_ClassOf(this)==='Float64Array')){
throw MakeTypeError(23,"Float64Array.byteOffset",this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function Float64Array_GetLength(){
if(!(%_ClassOf(this)==='Float64Array')){
throw MakeTypeError(23,"Float64Array.length",this);
}
return %_TypedArrayGetLength(this);
}
function Float64ArraySubArray(H,I){
if(!(%_ClassOf(this)==='Float64Array')){
throw MakeTypeError(23,"Float64Array.subarray",this);
}
var J=(%_IsSmi(%IS_VAR(H))?H:%NumberToInteger($toNumber(H)));
if(!(I===(void 0))){
I=(%_IsSmi(%IS_VAR(I))?I:%NumberToInteger($toNumber(I)));
}
var K=%_TypedArrayGetLength(this);
if(J<0){
J=$max(0,K+J);
}else{
J=$min(K,J);
}
var L=(I===(void 0))?K:I;
if(L<0){
L=$max(0,K+L);
}else{
L=$min(L,K);
}
if(L<J){
L=J;
}
var z=L-J;
var M=
%_ArrayBufferViewGetByteOffset(this)+J*8;
return new p(%TypedArrayGetBuffer(this),
M,z);
}

function Uint8ClampedArrayConstructByArrayBuffer(r,t,u,v){
if(!(u===(void 0))){
u=
$toPositiveInteger(u,97);
}
if(!(v===(void 0))){
v=$toPositiveInteger(v,97);
}
var w=%_ArrayBufferGetByteLength(t);
var x;
if((u===(void 0))){
x=0;
}else{
x=u;
if(x % 1!==0){
throw MakeRangeError(96,
"start offset","Uint8ClampedArray",1);
}
if(x>w){
throw MakeRangeError(98);
}
}
var y;
var z;
if((v===(void 0))){
if(w % 1!==0){
throw MakeRangeError(96,
"byte length","Uint8ClampedArray",1);
}
y=w-x;
z=y/1;
}else{
var z=v;
y=z*1;
}
if((x+y>w)
||(z>%_MaxSmi())){
throw MakeRangeError(97);
}
%_TypedArrayInitialize(r,9,t,x,y);
}
function Uint8ClampedArrayConstructByLength(r,v){
var A=(v===(void 0))?
0:$toPositiveInteger(v,97);
if(A>%_MaxSmi()){
throw MakeRangeError(97);
}
var B=A*1;
if(B>%_TypedArrayMaxSizeInHeap()){
var t=new e(B);
%_TypedArrayInitialize(r,9,t,0,B);
}else{
%_TypedArrayInitialize(r,9,null,0,B);
}
}
function Uint8ClampedArrayConstructByArrayLike(r,C){
var v=C.length;
var A=$toPositiveInteger(v,97);
if(A>%_MaxSmi()){
throw MakeRangeError(97);
}
if(!%TypedArrayInitializeFromArrayLike(r,9,C,A)){
for(var D=0;D<A;D++){
r[D]=C[D];
}
}
}
function Uint8ClampedArrayConstructor(E,F,G){
if(%_IsConstructCall()){
if((%_ClassOf(E)==='ArrayBuffer')){
Uint8ClampedArrayConstructByArrayBuffer(this,E,F,G);
}else if((typeof(E)==='number')||(typeof(E)==='string')||
(typeof(E)==='boolean')||(E===(void 0))){
Uint8ClampedArrayConstructByLength(this,E);
}else{
Uint8ClampedArrayConstructByArrayLike(this,E);
}
}else{
throw MakeTypeError(14,"Uint8ClampedArray")
}
}
function Uint8ClampedArray_GetBuffer(){
if(!(%_ClassOf(this)==='Uint8ClampedArray')){
throw MakeTypeError(23,"Uint8ClampedArray.buffer",this);
}
return %TypedArrayGetBuffer(this);
}
function Uint8ClampedArray_GetByteLength(){
if(!(%_ClassOf(this)==='Uint8ClampedArray')){
throw MakeTypeError(23,"Uint8ClampedArray.byteLength",this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function Uint8ClampedArray_GetByteOffset(){
if(!(%_ClassOf(this)==='Uint8ClampedArray')){
throw MakeTypeError(23,"Uint8ClampedArray.byteOffset",this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function Uint8ClampedArray_GetLength(){
if(!(%_ClassOf(this)==='Uint8ClampedArray')){
throw MakeTypeError(23,"Uint8ClampedArray.length",this);
}
return %_TypedArrayGetLength(this);
}
function Uint8ClampedArraySubArray(H,I){
if(!(%_ClassOf(this)==='Uint8ClampedArray')){
throw MakeTypeError(23,"Uint8ClampedArray.subarray",this);
}
var J=(%_IsSmi(%IS_VAR(H))?H:%NumberToInteger($toNumber(H)));
if(!(I===(void 0))){
I=(%_IsSmi(%IS_VAR(I))?I:%NumberToInteger($toNumber(I)));
}
var K=%_TypedArrayGetLength(this);
if(J<0){
J=$max(0,K+J);
}else{
J=$min(K,J);
}
var L=(I===(void 0))?K:I;
if(L<0){
L=$max(0,K+L);
}else{
L=$min(L,K);
}
if(L<J){
L=J;
}
var z=L-J;
var M=
%_ArrayBufferViewGetByteOffset(this)+J*1;
return new q(%TypedArrayGetBuffer(this),
M,z);
}


function TypedArraySetFromArrayLike(N,O,P,x){
if(x>0){
for(var D=0;D<P;D++){
N[x+D]=O[D];
}
}
else{
for(var D=0;D<P;D++){
N[D]=O[D];
}
}
}
function TypedArraySetFromOverlappingTypedArray(N,O,x){
var Q=O.BYTES_PER_ELEMENT;
var R=N.BYTES_PER_ELEMENT;
var P=O.length;
function CopyLeftPart(){
var S=N.byteOffset+(x+1)*R;
var T=O.byteOffset;
for(var U=0;
U<P&&S<=T;
U++){
N[x+U]=O[U];
S+=R;
T+=Q;
}
return U;
}
var U=CopyLeftPart();
function CopyRightPart(){
var S=
N.byteOffset+(x+P-1)*R;
var T=
O.byteOffset+P*Q;
for(var V=P-1;
V>=U&&S>=T;
V--){
N[x+V]=O[V];
S-=R;
T-=Q;
}
return V;
}
var V=CopyRightPart();
var W=new d(V+1-U);
for(var D=U;D<=V;D++){
W[D-U]=O[D];
}
for(D=U;D<=V;D++){
N[x+D]=W[D-U];
}
}
function TypedArraySet(r,x){
var X=(x===(void 0))?0:(%_IsSmi(%IS_VAR(x))?x:%NumberToInteger($toNumber(x)));
if(X<0)throw MakeTypeError(106);
if(X>%_MaxSmi()){
throw MakeRangeError(107);
}
switch(%TypedArraySetFastCases(this,r,X)){
case 0:
return;
case 1:
TypedArraySetFromOverlappingTypedArray(this,r,X);
return;
case 2:
TypedArraySetFromArrayLike(this,r,r.length,X);
return;
case 3:
var A=r.length;
if((A===(void 0))){
if((typeof(r)==='number')){
throw MakeTypeError(26);
}
return;
}
if(X+A>this.length){
throw MakeRangeError(107);
}
TypedArraySetFromArrayLike(this,r,A,X);
return;
}
}
function TypedArrayGetToStringTag(){
if(!%IsTypedArray(this))return;
var Y=%_ClassOf(this);
if((Y===(void 0)))return;
return Y;
}
%SetCode(i,Uint8ArrayConstructor);
%FunctionSetPrototype(i,new h());
%AddNamedProperty(i,"BYTES_PER_ELEMENT",1,
1|2|4);
%AddNamedProperty(i.prototype,
"constructor",a.Uint8Array,2);
%AddNamedProperty(i.prototype,
"BYTES_PER_ELEMENT",1,
1|2|4);
$installGetter(i.prototype,"buffer",Uint8Array_GetBuffer);
$installGetter(i.prototype,"byteOffset",Uint8Array_GetByteOffset,
2|4);
$installGetter(i.prototype,"byteLength",Uint8Array_GetByteLength,
2|4);
$installGetter(i.prototype,"length",Uint8Array_GetLength,
2|4);
$installGetter(i.prototype,symbolToStringTag,
TypedArrayGetToStringTag);
$installFunctions(i.prototype,2,[
"subarray",Uint8ArraySubArray,
"set",TypedArraySet
]);

%SetCode(j,Int8ArrayConstructor);
%FunctionSetPrototype(j,new h());
%AddNamedProperty(j,"BYTES_PER_ELEMENT",1,
1|2|4);
%AddNamedProperty(j.prototype,
"constructor",a.Int8Array,2);
%AddNamedProperty(j.prototype,
"BYTES_PER_ELEMENT",1,
1|2|4);
$installGetter(j.prototype,"buffer",Int8Array_GetBuffer);
$installGetter(j.prototype,"byteOffset",Int8Array_GetByteOffset,
2|4);
$installGetter(j.prototype,"byteLength",Int8Array_GetByteLength,
2|4);
$installGetter(j.prototype,"length",Int8Array_GetLength,
2|4);
$installGetter(j.prototype,symbolToStringTag,
TypedArrayGetToStringTag);
$installFunctions(j.prototype,2,[
"subarray",Int8ArraySubArray,
"set",TypedArraySet
]);

%SetCode(k,Uint16ArrayConstructor);
%FunctionSetPrototype(k,new h());
%AddNamedProperty(k,"BYTES_PER_ELEMENT",2,
1|2|4);
%AddNamedProperty(k.prototype,
"constructor",a.Uint16Array,2);
%AddNamedProperty(k.prototype,
"BYTES_PER_ELEMENT",2,
1|2|4);
$installGetter(k.prototype,"buffer",Uint16Array_GetBuffer);
$installGetter(k.prototype,"byteOffset",Uint16Array_GetByteOffset,
2|4);
$installGetter(k.prototype,"byteLength",Uint16Array_GetByteLength,
2|4);
$installGetter(k.prototype,"length",Uint16Array_GetLength,
2|4);
$installGetter(k.prototype,symbolToStringTag,
TypedArrayGetToStringTag);
$installFunctions(k.prototype,2,[
"subarray",Uint16ArraySubArray,
"set",TypedArraySet
]);

%SetCode(l,Int16ArrayConstructor);
%FunctionSetPrototype(l,new h());
%AddNamedProperty(l,"BYTES_PER_ELEMENT",2,
1|2|4);
%AddNamedProperty(l.prototype,
"constructor",a.Int16Array,2);
%AddNamedProperty(l.prototype,
"BYTES_PER_ELEMENT",2,
1|2|4);
$installGetter(l.prototype,"buffer",Int16Array_GetBuffer);
$installGetter(l.prototype,"byteOffset",Int16Array_GetByteOffset,
2|4);
$installGetter(l.prototype,"byteLength",Int16Array_GetByteLength,
2|4);
$installGetter(l.prototype,"length",Int16Array_GetLength,
2|4);
$installGetter(l.prototype,symbolToStringTag,
TypedArrayGetToStringTag);
$installFunctions(l.prototype,2,[
"subarray",Int16ArraySubArray,
"set",TypedArraySet
]);

%SetCode(m,Uint32ArrayConstructor);
%FunctionSetPrototype(m,new h());
%AddNamedProperty(m,"BYTES_PER_ELEMENT",4,
1|2|4);
%AddNamedProperty(m.prototype,
"constructor",a.Uint32Array,2);
%AddNamedProperty(m.prototype,
"BYTES_PER_ELEMENT",4,
1|2|4);
$installGetter(m.prototype,"buffer",Uint32Array_GetBuffer);
$installGetter(m.prototype,"byteOffset",Uint32Array_GetByteOffset,
2|4);
$installGetter(m.prototype,"byteLength",Uint32Array_GetByteLength,
2|4);
$installGetter(m.prototype,"length",Uint32Array_GetLength,
2|4);
$installGetter(m.prototype,symbolToStringTag,
TypedArrayGetToStringTag);
$installFunctions(m.prototype,2,[
"subarray",Uint32ArraySubArray,
"set",TypedArraySet
]);

%SetCode(n,Int32ArrayConstructor);
%FunctionSetPrototype(n,new h());
%AddNamedProperty(n,"BYTES_PER_ELEMENT",4,
1|2|4);
%AddNamedProperty(n.prototype,
"constructor",a.Int32Array,2);
%AddNamedProperty(n.prototype,
"BYTES_PER_ELEMENT",4,
1|2|4);
$installGetter(n.prototype,"buffer",Int32Array_GetBuffer);
$installGetter(n.prototype,"byteOffset",Int32Array_GetByteOffset,
2|4);
$installGetter(n.prototype,"byteLength",Int32Array_GetByteLength,
2|4);
$installGetter(n.prototype,"length",Int32Array_GetLength,
2|4);
$installGetter(n.prototype,symbolToStringTag,
TypedArrayGetToStringTag);
$installFunctions(n.prototype,2,[
"subarray",Int32ArraySubArray,
"set",TypedArraySet
]);

%SetCode(o,Float32ArrayConstructor);
%FunctionSetPrototype(o,new h());
%AddNamedProperty(o,"BYTES_PER_ELEMENT",4,
1|2|4);
%AddNamedProperty(o.prototype,
"constructor",a.Float32Array,2);
%AddNamedProperty(o.prototype,
"BYTES_PER_ELEMENT",4,
1|2|4);
$installGetter(o.prototype,"buffer",Float32Array_GetBuffer);
$installGetter(o.prototype,"byteOffset",Float32Array_GetByteOffset,
2|4);
$installGetter(o.prototype,"byteLength",Float32Array_GetByteLength,
2|4);
$installGetter(o.prototype,"length",Float32Array_GetLength,
2|4);
$installGetter(o.prototype,symbolToStringTag,
TypedArrayGetToStringTag);
$installFunctions(o.prototype,2,[
"subarray",Float32ArraySubArray,
"set",TypedArraySet
]);

%SetCode(p,Float64ArrayConstructor);
%FunctionSetPrototype(p,new h());
%AddNamedProperty(p,"BYTES_PER_ELEMENT",8,
1|2|4);
%AddNamedProperty(p.prototype,
"constructor",a.Float64Array,2);
%AddNamedProperty(p.prototype,
"BYTES_PER_ELEMENT",8,
1|2|4);
$installGetter(p.prototype,"buffer",Float64Array_GetBuffer);
$installGetter(p.prototype,"byteOffset",Float64Array_GetByteOffset,
2|4);
$installGetter(p.prototype,"byteLength",Float64Array_GetByteLength,
2|4);
$installGetter(p.prototype,"length",Float64Array_GetLength,
2|4);
$installGetter(p.prototype,symbolToStringTag,
TypedArrayGetToStringTag);
$installFunctions(p.prototype,2,[
"subarray",Float64ArraySubArray,
"set",TypedArraySet
]);

%SetCode(q,Uint8ClampedArrayConstructor);
%FunctionSetPrototype(q,new h());
%AddNamedProperty(q,"BYTES_PER_ELEMENT",1,
1|2|4);
%AddNamedProperty(q.prototype,
"constructor",a.Uint8ClampedArray,2);
%AddNamedProperty(q.prototype,
"BYTES_PER_ELEMENT",1,
1|2|4);
$installGetter(q.prototype,"buffer",Uint8ClampedArray_GetBuffer);
$installGetter(q.prototype,"byteOffset",Uint8ClampedArray_GetByteOffset,
2|4);
$installGetter(q.prototype,"byteLength",Uint8ClampedArray_GetByteLength,
2|4);
$installGetter(q.prototype,"length",Uint8ClampedArray_GetLength,
2|4);
$installGetter(q.prototype,symbolToStringTag,
TypedArrayGetToStringTag);
$installFunctions(q.prototype,2,[
"subarray",Uint8ClampedArraySubArray,
"set",TypedArraySet
]);


function DataViewConstructor(t,u,B){
if(%_IsConstructCall()){
if(!(%_ClassOf(t)==='ArrayBuffer'))throw MakeTypeError(16);
if(!(u===(void 0))){
u=$toPositiveInteger(u,92);
}
if(!(B===(void 0))){
B=(%_IsSmi(%IS_VAR(B))?B:%NumberToInteger($toNumber(B)));
}
var w=%_ArrayBufferGetByteLength(t);
var x=(u===(void 0))?0:u;
if(x>w)throw MakeRangeError(92);
var v=(B===(void 0))
?w-x
:B;
if(v<0||x+v>w){
throw new MakeRangeError(91);
}
%_DataViewInitialize(this,t,x,v);
}else{
throw MakeTypeError(14,"DataView");
}
}
function DataViewGetBufferJS(){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(23,'DataView.buffer',this);
}
return %DataViewGetBuffer(this);
}
function DataViewGetByteOffset(){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(23,
'DataView.byteOffset',this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function DataViewGetByteLength(){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(23,
'DataView.byteLength',this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function DataViewGetInt8JS(x,Z){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(23,
'DataView.getInt8',this);
}
if(%_ArgumentsLength()<1)throw MakeTypeError(26);
x=$toPositiveInteger(x,90);
return %DataViewGetInt8(this,x,!!Z);
}
function DataViewSetInt8JS(x,aa,Z){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(23,
'DataView.setInt8',this);
}
if(%_ArgumentsLength()<2)throw MakeTypeError(26);
x=$toPositiveInteger(x,90);
%DataViewSetInt8(this,x,((typeof(%IS_VAR(aa))==='number')?aa:$nonNumberToNumber(aa)),!!Z);
}

function DataViewGetUint8JS(x,Z){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(23,
'DataView.getUint8',this);
}
if(%_ArgumentsLength()<1)throw MakeTypeError(26);
x=$toPositiveInteger(x,90);
return %DataViewGetUint8(this,x,!!Z);
}
function DataViewSetUint8JS(x,aa,Z){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(23,
'DataView.setUint8',this);
}
if(%_ArgumentsLength()<2)throw MakeTypeError(26);
x=$toPositiveInteger(x,90);
%DataViewSetUint8(this,x,((typeof(%IS_VAR(aa))==='number')?aa:$nonNumberToNumber(aa)),!!Z);
}

function DataViewGetInt16JS(x,Z){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(23,
'DataView.getInt16',this);
}
if(%_ArgumentsLength()<1)throw MakeTypeError(26);
x=$toPositiveInteger(x,90);
return %DataViewGetInt16(this,x,!!Z);
}
function DataViewSetInt16JS(x,aa,Z){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(23,
'DataView.setInt16',this);
}
if(%_ArgumentsLength()<2)throw MakeTypeError(26);
x=$toPositiveInteger(x,90);
%DataViewSetInt16(this,x,((typeof(%IS_VAR(aa))==='number')?aa:$nonNumberToNumber(aa)),!!Z);
}

function DataViewGetUint16JS(x,Z){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(23,
'DataView.getUint16',this);
}
if(%_ArgumentsLength()<1)throw MakeTypeError(26);
x=$toPositiveInteger(x,90);
return %DataViewGetUint16(this,x,!!Z);
}
function DataViewSetUint16JS(x,aa,Z){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(23,
'DataView.setUint16',this);
}
if(%_ArgumentsLength()<2)throw MakeTypeError(26);
x=$toPositiveInteger(x,90);
%DataViewSetUint16(this,x,((typeof(%IS_VAR(aa))==='number')?aa:$nonNumberToNumber(aa)),!!Z);
}

function DataViewGetInt32JS(x,Z){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(23,
'DataView.getInt32',this);
}
if(%_ArgumentsLength()<1)throw MakeTypeError(26);
x=$toPositiveInteger(x,90);
return %DataViewGetInt32(this,x,!!Z);
}
function DataViewSetInt32JS(x,aa,Z){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(23,
'DataView.setInt32',this);
}
if(%_ArgumentsLength()<2)throw MakeTypeError(26);
x=$toPositiveInteger(x,90);
%DataViewSetInt32(this,x,((typeof(%IS_VAR(aa))==='number')?aa:$nonNumberToNumber(aa)),!!Z);
}

function DataViewGetUint32JS(x,Z){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(23,
'DataView.getUint32',this);
}
if(%_ArgumentsLength()<1)throw MakeTypeError(26);
x=$toPositiveInteger(x,90);
return %DataViewGetUint32(this,x,!!Z);
}
function DataViewSetUint32JS(x,aa,Z){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(23,
'DataView.setUint32',this);
}
if(%_ArgumentsLength()<2)throw MakeTypeError(26);
x=$toPositiveInteger(x,90);
%DataViewSetUint32(this,x,((typeof(%IS_VAR(aa))==='number')?aa:$nonNumberToNumber(aa)),!!Z);
}

function DataViewGetFloat32JS(x,Z){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(23,
'DataView.getFloat32',this);
}
if(%_ArgumentsLength()<1)throw MakeTypeError(26);
x=$toPositiveInteger(x,90);
return %DataViewGetFloat32(this,x,!!Z);
}
function DataViewSetFloat32JS(x,aa,Z){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(23,
'DataView.setFloat32',this);
}
if(%_ArgumentsLength()<2)throw MakeTypeError(26);
x=$toPositiveInteger(x,90);
%DataViewSetFloat32(this,x,((typeof(%IS_VAR(aa))==='number')?aa:$nonNumberToNumber(aa)),!!Z);
}

function DataViewGetFloat64JS(x,Z){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(23,
'DataView.getFloat64',this);
}
if(%_ArgumentsLength()<1)throw MakeTypeError(26);
x=$toPositiveInteger(x,90);
return %DataViewGetFloat64(this,x,!!Z);
}
function DataViewSetFloat64JS(x,aa,Z){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(23,
'DataView.setFloat64',this);
}
if(%_ArgumentsLength()<2)throw MakeTypeError(26);
x=$toPositiveInteger(x,90);
%DataViewSetFloat64(this,x,((typeof(%IS_VAR(aa))==='number')?aa:$nonNumberToNumber(aa)),!!Z);
}


%SetCode(g,DataViewConstructor);
%FunctionSetPrototype(g,new h);
%AddNamedProperty(g.prototype,"constructor",g,
2);
%AddNamedProperty(g.prototype,symbolToStringTag,"DataView",
1|2);
$installGetter(g.prototype,"buffer",DataViewGetBufferJS);
$installGetter(g.prototype,"byteOffset",DataViewGetByteOffset);
$installGetter(g.prototype,"byteLength",DataViewGetByteLength);
$installFunctions(g.prototype,2,[
"getInt8",DataViewGetInt8JS,
"setInt8",DataViewSetInt8JS,
"getUint8",DataViewGetUint8JS,
"setUint8",DataViewSetUint8JS,
"getInt16",DataViewGetInt16JS,
"setInt16",DataViewSetInt16JS,
"getUint16",DataViewGetUint16JS,
"setUint16",DataViewSetUint16JS,
"getInt32",DataViewGetInt32JS,
"setInt32",DataViewSetInt32JS,
"getUint32",DataViewGetUint32JS,
"setUint32",DataViewSetUint32JS,
"getFloat32",DataViewGetFloat32JS,
"setFloat32",DataViewSetFloat32JS,
"getFloat64",DataViewGetFloat64JS,
"setFloat64",DataViewSetFloat64JS
]);
})

$generator
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Function;
function GeneratorObjectNext(e){
if(!(%_ClassOf(this)==='Generator')){
throw MakeTypeError(23,
'[Generator].prototype.next',this);
}
var g=%GeneratorGetContinuation(this);
if(g>0){
if((%_DebugIsActive()!=0))%DebugPrepareStepInIfStepping(this);
try{
return %_GeneratorNext(this,e);
}catch(e){
%GeneratorClose(this);
throw e;
}
}else if(g==0){
return{value:void 0,done:true};
}else{
throw MakeTypeError(22);
}
}
function GeneratorObjectThrow(h){
if(!(%_ClassOf(this)==='Generator')){
throw MakeTypeError(23,
'[Generator].prototype.throw',this);
}
var g=%GeneratorGetContinuation(this);
if(g>0){
try{
return %_GeneratorThrow(this,h);
}catch(e){
%GeneratorClose(this);
throw e;
}
}else if(g==0){
throw h;
}else{
throw MakeTypeError(22);
}
}
function GeneratorObjectIterator(){
return this;
}
function GeneratorFunctionConstructor(i){
var j=$newFunctionString(arguments,'function*');
var k=%GlobalProxy(GeneratorFunctionConstructor);
var l=%_CallFunction(k,%CompileString(j,true));
%FunctionMarkNameShouldPrintAsAnonymous(l);
return l;
}
%NeverOptimizeFunction(GeneratorObjectNext);
%NeverOptimizeFunction(GeneratorObjectThrow);
var m=GeneratorFunctionPrototype.prototype;
$installFunctions(m,
2,
["next",GeneratorObjectNext,
"throw",GeneratorObjectThrow]);
$setFunctionName(GeneratorObjectIterator,symbolIterator);
%AddNamedProperty(m,symbolIterator,
GeneratorObjectIterator,2|4|1);
%AddNamedProperty(m,"constructor",
GeneratorFunctionPrototype,2|1);
%AddNamedProperty(m,
symbolToStringTag,"Generator",2|1);
%InternalSetPrototype(GeneratorFunctionPrototype,d.prototype);
%AddNamedProperty(GeneratorFunctionPrototype,
symbolToStringTag,"GeneratorFunction",2|1);
%AddNamedProperty(GeneratorFunctionPrototype,"constructor",
GeneratorFunction,2|1);
%InternalSetPrototype(GeneratorFunction,d);
%SetCode(GeneratorFunction,GeneratorFunctionConstructor);
})

8object-observe	­
var $observeNotifyChange;
var $observeEnqueueSpliceRecord;
var $observeBeginPerformSplice;
var $observeEndPerformSplice;
var $observeNativeObjectObserve;
var $observeNativeObjectGetNotifier;
var $observeNativeObjectNotifierPerformChange;
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Array;
var e=a.Object;
var g;
var h={};
function GetObservationStateJS(){
if((g===(void 0))){
g=%GetObservationState();
}
if((g.callbackInfoMap===(void 0))){
g.callbackInfoMap=%ObservationWeakMapCreate();
g.objectInfoMap=%ObservationWeakMapCreate();
g.notifierObjectInfoMap=%ObservationWeakMapCreate();
g.pendingObservers=null;
g.nextCallbackPriority=0;
g.lastMicrotaskId=0;
}
return g;
}
function GetPendingObservers(){
return GetObservationStateJS().pendingObservers;
}
function SetPendingObservers(i){
GetObservationStateJS().pendingObservers=i;
}
function GetNextCallbackPriority(){
return GetObservationStateJS().nextCallbackPriority++;
}
function nullProtoObject(){
return{__proto__:null};
}
function TypeMapCreate(){
return nullProtoObject();
}
function TypeMapAddType(j,k,l){
j[k]=l?1:(j[k]||0)+1;
}
function TypeMapRemoveType(j,k){
j[k]--;
}
function TypeMapCreateFromList(m,n){
var j=TypeMapCreate();
for(var o=0;o<n;o++){
TypeMapAddType(j,m[o],true);
}
return j;
}
function TypeMapHasType(j,k){
return!!j[k];
}
function TypeMapIsDisjointFrom(p,q){
if(!p||!q)
return true;
for(var k in p){
if(TypeMapHasType(p,k)&&TypeMapHasType(q,k))
return false;
}
return true;
}
var r=(function(){
var t=[
'add',
'update',
'delete',
'setPrototype',
'reconfigure',
'preventExtensions'
];
return TypeMapCreateFromList(t,t.length);
})();
function ObserverCreate(u,v){
if((v===(void 0)))
return u;
var w=nullProtoObject();
w.callback=u;
w.accept=v;
return w;
}
function ObserverGetCallback(w){
return(%_ClassOf(w)==='Function')?w:w.callback;
}
function ObserverGetAcceptTypes(w){
return(%_ClassOf(w)==='Function')?r:w.accept;
}
function ObserverIsActive(w,x){
return TypeMapIsDisjointFrom(ObjectInfoGetPerformingTypes(x),
ObserverGetAcceptTypes(w));
}
function ObjectInfoGetOrCreate(y){
var x=ObjectInfoGet(y);
if((x===(void 0))){
if(!%_IsJSProxy(y)){
%SetIsObserved(y);
}
x={
object:y,
changeObservers:null,
notifier:null,
performing:null,
performingCount:0,
};
%WeakCollectionSet(GetObservationStateJS().objectInfoMap,
y,x);
}
return x;
}
function ObjectInfoGet(y){
return %WeakCollectionGet(GetObservationStateJS().objectInfoMap,y);
}
function ObjectInfoGetFromNotifier(z){
return %WeakCollectionGet(GetObservationStateJS().notifierObjectInfoMap,
z);
}
function ObjectInfoGetNotifier(x){
if((x.notifier===null)){
x.notifier={__proto__:h};
%WeakCollectionSet(GetObservationStateJS().notifierObjectInfoMap,
x.notifier,x);
}
return x.notifier;
}
function ChangeObserversIsOptimized(A){
return(%_ClassOf(A)==='Function')||
(%_ClassOf(A.callback)==='Function');
}
function ObjectInfoNormalizeChangeObservers(x){
if(ChangeObserversIsOptimized(x.changeObservers)){
var w=x.changeObservers;
var u=ObserverGetCallback(w);
var B=CallbackInfoGet(u);
var C=CallbackInfoGetPriority(B);
x.changeObservers=nullProtoObject();
x.changeObservers[C]=w;
}
}
function ObjectInfoAddObserver(x,u,v){
var B=CallbackInfoGetOrCreate(u);
var w=ObserverCreate(u,v);
if(!x.changeObservers){
x.changeObservers=w;
return;
}
ObjectInfoNormalizeChangeObservers(x);
var C=CallbackInfoGetPriority(B);
x.changeObservers[C]=w;
}
function ObjectInfoRemoveObserver(x,u){
if(!x.changeObservers)
return;
if(ChangeObserversIsOptimized(x.changeObservers)){
if(u===ObserverGetCallback(x.changeObservers))
x.changeObservers=null;
return;
}
var B=CallbackInfoGet(u);
var C=CallbackInfoGetPriority(B);
x.changeObservers[C]=null;
}
function ObjectInfoHasActiveObservers(x){
if((x===(void 0))||!x.changeObservers)
return false;
if(ChangeObserversIsOptimized(x.changeObservers))
return ObserverIsActive(x.changeObservers,x);
for(var C in x.changeObservers){
var w=x.changeObservers[C];
if(!(w===null)&&ObserverIsActive(w,x))
return true;
}
return false;
}
function ObjectInfoAddPerformingType(x,k){
x.performing=x.performing||TypeMapCreate();
TypeMapAddType(x.performing,k);
x.performingCount++;
}
function ObjectInfoRemovePerformingType(x,k){
x.performingCount--;
TypeMapRemoveType(x.performing,k);
}
function ObjectInfoGetPerformingTypes(x){
return x.performingCount>0?x.performing:null;
}
function ConvertAcceptListToTypeMap(D){
if((D===(void 0)))
return D;
if(!(%_IsSpecObject(D)))throw MakeTypeError(46);
var E=$toInteger(D.length);
if(E<0)E=0;
return TypeMapCreateFromList(D,E);
}
function CallbackInfoGet(u){
return %WeakCollectionGet(GetObservationStateJS().callbackInfoMap,u);
}
function CallbackInfoSet(u,B){
%WeakCollectionSet(GetObservationStateJS().callbackInfoMap,
u,B);
}
function CallbackInfoGetOrCreate(u){
var B=CallbackInfoGet(u);
if(!(B===(void 0)))
return B;
var C=GetNextCallbackPriority();
CallbackInfoSet(u,C);
return C;
}
function CallbackInfoGetPriority(B){
if((typeof(B)==='number'))
return B;
else
return B.priority;
}
function CallbackInfoNormalize(u){
var B=CallbackInfoGet(u);
if((typeof(B)==='number')){
var C=B;
B=new InternalArray;
B.priority=C;
CallbackInfoSet(u,B);
}
return B;
}
function ObjectObserve(y,u,v){
if(!(%_IsSpecObject(y)))
throw MakeTypeError(48,"observe","observe");
if(%IsJSGlobalProxy(y))
throw MakeTypeError(45,"observe");
if(!(%_ClassOf(u)==='Function'))
throw MakeTypeError(47,"observe");
if($objectIsFrozen(u))
throw MakeTypeError(44);
var F=%GetObjectContextObjectObserve(y);
return F(y,u,v);
}
function NativeObjectObserve(y,u,v){
var x=ObjectInfoGetOrCreate(y);
var m=ConvertAcceptListToTypeMap(v);
ObjectInfoAddObserver(x,u,m);
return y;
}
function ObjectUnobserve(y,u){
if(!(%_IsSpecObject(y)))
throw MakeTypeError(48,"unobserve","unobserve");
if(%IsJSGlobalProxy(y))
throw MakeTypeError(45,"unobserve");
if(!(%_ClassOf(u)==='Function'))
throw MakeTypeError(47,"unobserve");
var x=ObjectInfoGet(y);
if((x===(void 0)))
return y;
ObjectInfoRemoveObserver(x,u);
return y;
}
function ArrayObserve(y,u){
return ObjectObserve(y,u,['add',
'update',
'delete',
'splice']);
}
function ArrayUnobserve(y,u){
return ObjectUnobserve(y,u);
}
function ObserverEnqueueIfActive(w,x,G){
if(!ObserverIsActive(w,x)||
!TypeMapHasType(ObserverGetAcceptTypes(w),G.type)){
return;
}
var u=ObserverGetCallback(w);
if(!%ObserverObjectAndRecordHaveSameOrigin(u,G.object,
G)){
return;
}
var B=CallbackInfoNormalize(u);
if((GetPendingObservers()===null)){
SetPendingObservers(nullProtoObject());
if((%_DebugIsActive()!=0)){
var H=++GetObservationStateJS().lastMicrotaskId;
var I="Object.observe";
%EnqueueMicrotask(function(){
%DebugAsyncTaskEvent({type:"willHandle",id:H,name:I});
ObserveMicrotaskRunner();
%DebugAsyncTaskEvent({type:"didHandle",id:H,name:I});
});
%DebugAsyncTaskEvent({type:"enqueue",id:H,name:I});
}else{
%EnqueueMicrotask(ObserveMicrotaskRunner);
}
}
GetPendingObservers()[B.priority]=u;
B.push(G);
}
function ObjectInfoEnqueueExternalChangeRecord(x,G,k){
if(!ObjectInfoHasActiveObservers(x))
return;
var J=!(k===(void 0));
var K=J?
{object:x.object,type:k}:
{object:x.object};
for(var L in G){
if(L==='object'||(J&&L==='type'))continue;
%DefineDataPropertyUnchecked(
K,L,G[L],1+4);
}
$objectFreeze(K);
ObjectInfoEnqueueInternalChangeRecord(x,K);
}
function ObjectInfoEnqueueInternalChangeRecord(x,G){
if((typeof(G.name)==='symbol'))return;
if(ChangeObserversIsOptimized(x.changeObservers)){
var w=x.changeObservers;
ObserverEnqueueIfActive(w,x,G);
return;
}
for(var C in x.changeObservers){
var w=x.changeObservers[C];
if((w===null))
continue;
ObserverEnqueueIfActive(w,x,G);
}
}
function BeginPerformSplice(M){
var x=ObjectInfoGet(M);
if(!(x===(void 0)))
ObjectInfoAddPerformingType(x,'splice');
}
function EndPerformSplice(M){
var x=ObjectInfoGet(M);
if(!(x===(void 0)))
ObjectInfoRemovePerformingType(x,'splice');
}
function EnqueueSpliceRecord(M,N,O,P){
var x=ObjectInfoGet(M);
if(!ObjectInfoHasActiveObservers(x))
return;
var G={
type:'splice',
object:M,
index:N,
removed:O,
addedCount:P
};
$objectFreeze(G);
$objectFreeze(G.removed);
ObjectInfoEnqueueInternalChangeRecord(x,G);
}
function NotifyChange(k,y,I,Q){
var x=ObjectInfoGet(y);
if(!ObjectInfoHasActiveObservers(x))
return;
var G;
if(arguments.length==2){
G={type:k,object:y};
}else if(arguments.length==3){
G={type:k,object:y,name:I};
}else{
G={
type:k,
object:y,
name:I,
oldValue:Q
};
}
$objectFreeze(G);
ObjectInfoEnqueueInternalChangeRecord(x,G);
}
function ObjectNotifierNotify(G){
if(!(%_IsSpecObject(this)))
throw MakeTypeError(10,"notify");
var x=ObjectInfoGetFromNotifier(this);
if((x===(void 0)))
throw MakeTypeError(49);
if(!(typeof(G.type)==='string'))
throw MakeTypeError(52);
ObjectInfoEnqueueExternalChangeRecord(x,G);
}
function ObjectNotifierPerformChange(R,S){
if(!(%_IsSpecObject(this)))
throw MakeTypeError(10,"performChange");
var x=ObjectInfoGetFromNotifier(this);
if((x===(void 0)))
throw MakeTypeError(49);
if(!(typeof(R)==='string'))
throw MakeTypeError(51);
if(!(%_ClassOf(S)==='Function'))
throw MakeTypeError(50);
var T=%GetObjectContextNotifierPerformChange(x);
T(x,R,S);
}
function NativeObjectNotifierPerformChange(x,R,S){
ObjectInfoAddPerformingType(x,R);
var G;
try{
G=%_CallFunction((void 0),S);
}finally{
ObjectInfoRemovePerformingType(x,R);
}
if((%_IsSpecObject(G)))
ObjectInfoEnqueueExternalChangeRecord(x,G,R);
}
function ObjectGetNotifier(y){
if(!(%_IsSpecObject(y)))
throw MakeTypeError(48,"getNotifier","getNotifier");
if(%IsJSGlobalProxy(y))
throw MakeTypeError(45,"getNotifier");
if($objectIsFrozen(y))return null;
if(!%ObjectWasCreatedInCurrentOrigin(y))return null;
var U=%GetObjectContextObjectGetNotifier(y);
return U(y);
}
function NativeObjectGetNotifier(y){
var x=ObjectInfoGetOrCreate(y);
return ObjectInfoGetNotifier(x);
}
function CallbackDeliverPending(u){
var B=CallbackInfoGet(u);
if((B===(void 0))||(typeof(B)==='number'))
return false;
var C=B.priority;
CallbackInfoSet(u,C);
var i=GetPendingObservers();
if(!(i===null))
delete i[C];
var V=[];
%MoveArrayContents(B,V);
%DeliverObservationChangeRecords(u,V);
return true;
}
function ObjectDeliverChangeRecords(u){
if(!(%_ClassOf(u)==='Function'))
throw MakeTypeError(47,"deliverChangeRecords");
while(CallbackDeliverPending(u)){}
}
function ObserveMicrotaskRunner(){
var i=GetPendingObservers();
if(!(i===null)){
SetPendingObservers(null);
for(var o in i){
CallbackDeliverPending(i[o]);
}
}
}
$installFunctions(e,2,[
"deliverChangeRecords",ObjectDeliverChangeRecords,
"getNotifier",ObjectGetNotifier,
"observe",ObjectObserve,
"unobserve",ObjectUnobserve
]);
$installFunctions(d,2,[
"observe",ArrayObserve,
"unobserve",ArrayUnobserve
]);
$installFunctions(h,2,[
"notify",ObjectNotifierNotify,
"performChange",ObjectNotifierPerformChange
]);
$observeNotifyChange=NotifyChange;
$observeEnqueueSpliceRecord=EnqueueSpliceRecord;
$observeBeginPerformSplice=BeginPerformSplice;
$observeEndPerformSplice=EndPerformSplice;
$observeNativeObjectObserve=NativeObjectObserve;
$observeNativeObjectGetNotifier=NativeObjectGetNotifier;
$observeNativeObjectNotifierPerformChange=NativeObjectNotifierPerformChange;
})

(collection%{
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Map;
var e=a.Object;
var g=a.Set;
function HashToEntry(h,i,j){
var k=(i&((j)-1));
return((%_FixedArrayGet(h,(3+(k))|0)));
}
%SetInlineBuiltinFlag(HashToEntry);
function SetFindEntry(h,j,l,i){
var m=$numberIsNaN(l);
for(var n=HashToEntry(h,i,j);
n!==-1;
n=((%_FixedArrayGet(h,((3+(j)+((n)<<1))+1)|0)))){
var o=((%_FixedArrayGet(h,((3+(j)+((n)<<1)))|0)));
if(l===o){
return n;
}
if(m&&$numberIsNaN(o)){
return n;
}
}
return-1;
}
%SetInlineBuiltinFlag(SetFindEntry);
function MapFindEntry(h,j,l,i){
var m=$numberIsNaN(l);
for(var n=HashToEntry(h,i,j);
n!==-1;
n=((%_FixedArrayGet(h,((3+(j)+((n)*3))+2)|0)))){
var o=((%_FixedArrayGet(h,((3+(j)+((n)*3)))|0)));
if(l===o){
return n;
}
if(m&&$numberIsNaN(o)){
return n;
}
}
return-1;
}
%SetInlineBuiltinFlag(MapFindEntry);
function ComputeIntegerHash(l,p){
var i=l;
i=i^p;
i=~i+(i<<15);
i=i^(i>>>12);
i=i+(i<<2);
i=i^(i>>>4);
i=(i*2057)|0;
i=i^(i>>>16);
return i;
}
%SetInlineBuiltinFlag(ComputeIntegerHash);
function GetHash(l){
if(%_IsSmi(l)){
return ComputeIntegerHash(l,0);
}
if((typeof(l)==='string')){
var q=%_StringGetRawHashField(l);
if((q&1)===0){
return q>>>2;
}
}
return %GenericHash(l);
}
%SetInlineBuiltinFlag(GetHash);
function SetConstructor(r){
if(!%_IsConstructCall()){
throw MakeTypeError(14,"Set");
}
%_SetInitialize(this);
if(!(r==null)){
var t=this.add;
if(!(%_ClassOf(t)==='Function')){
throw MakeTypeError(56,'add',this);
}
for(var u of r){
%_CallFunction(this,u,t);
}
}
}
function SetAdd(l){
if(!(%_ClassOf(this)==='Set')){
throw MakeTypeError(23,'Set.prototype.add',this);
}
if(l===0){
l=0;
}
var h=%_JSCollectionGetTable(this);
var j=((%_FixedArrayGet(h,(0)|0)));
var i=GetHash(l);
if(SetFindEntry(h,j,l,i)!==-1)return this;
var v=((%_FixedArrayGet(h,(1)|0)));
var w=((%_FixedArrayGet(h,(2)|0)));
var x=j<<1;
if((v+w)>=x){
%SetGrow(this);
h=%_JSCollectionGetTable(this);
j=((%_FixedArrayGet(h,(0)|0)));
v=((%_FixedArrayGet(h,(1)|0)));
w=((%_FixedArrayGet(h,(2)|0)));
}
var n=v+w;
var y=(3+(j)+((n)<<1));
var k=(i&((j)-1));
var z=((%_FixedArrayGet(h,(3+(k))|0)));
((%_FixedArraySet(h,(3+(k))|0,n)));
(((%_FixedArraySet(h,(1)|0,(v+1)|0))));
(%_FixedArraySet(h,(y)|0,l));
((%_FixedArraySet(h,(y+1)|0,(z)|0)));
return this;
}
function SetHas(l){
if(!(%_ClassOf(this)==='Set')){
throw MakeTypeError(23,'Set.prototype.has',this);
}
var h=%_JSCollectionGetTable(this);
var j=((%_FixedArrayGet(h,(0)|0)));
var i=GetHash(l);
return SetFindEntry(h,j,l,i)!==-1;
}
function SetDelete(l){
if(!(%_ClassOf(this)==='Set')){
throw MakeTypeError(23,
'Set.prototype.delete',this);
}
var h=%_JSCollectionGetTable(this);
var j=((%_FixedArrayGet(h,(0)|0)));
var i=GetHash(l);
var n=SetFindEntry(h,j,l,i);
if(n===-1)return false;
var v=((%_FixedArrayGet(h,(1)|0)))-1;
var w=((%_FixedArrayGet(h,(2)|0)))+1;
var y=(3+(j)+((n)<<1));
(%_FixedArraySet(h,(y)|0,%_TheHole()));
(((%_FixedArraySet(h,(1)|0,(v)|0))));
(((%_FixedArraySet(h,(2)|0,(w)|0))));
if(v<(j>>>1))%SetShrink(this);
return true;
}
function SetGetSize(){
if(!(%_ClassOf(this)==='Set')){
throw MakeTypeError(23,
'Set.prototype.size',this);
}
var h=%_JSCollectionGetTable(this);
return((%_FixedArrayGet(h,(1)|0)));
}
function SetClearJS(){
if(!(%_ClassOf(this)==='Set')){
throw MakeTypeError(23,
'Set.prototype.clear',this);
}
%_SetClear(this);
}
function SetForEach(A,B){
if(!(%_ClassOf(this)==='Set')){
throw MakeTypeError(23,
'Set.prototype.forEach',this);
}
if(!(%_ClassOf(A)==='Function'))throw MakeTypeError(9,A);
var C=false;
if((B===null)){
if(%IsSloppyModeFunction(A))B=(void 0);
}else if(!(B===(void 0))){
C=(!(%_IsSpecObject(B))&&%IsSloppyModeFunction(A));
}
var D=new SetIterator(this,2);
var l;
var E=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(A);
var F=[(void 0)];
while(%SetIteratorNext(D,F)){
if(E)%DebugPrepareStepInIfStepping(A);
l=F[0];
var G=C?$toObject(B):B;
%_CallFunction(G,l,l,this,A);
}
}
%SetCode(g,SetConstructor);
%FunctionSetLength(g,0);
%FunctionSetPrototype(g,new e());
%AddNamedProperty(g.prototype,"constructor",g,2);
%AddNamedProperty(g.prototype,symbolToStringTag,"Set",
2|1);
%FunctionSetLength(SetForEach,1);
$installGetter(g.prototype,"size",SetGetSize);
$installFunctions(g.prototype,2,[
"add",SetAdd,
"has",SetHas,
"delete",SetDelete,
"clear",SetClearJS,
"forEach",SetForEach
]);
function MapConstructor(r){
if(!%_IsConstructCall()){
throw MakeTypeError(14,"Map");
}
%_MapInitialize(this);
if(!(r==null)){
var t=this.set;
if(!(%_ClassOf(t)==='Function')){
throw MakeTypeError(56,'set',this);
}
for(var H of r){
if(!(%_IsSpecObject(H))){
throw MakeTypeError(29,H);
}
%_CallFunction(this,H[0],H[1],t);
}
}
}
function MapGet(l){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(23,
'Map.prototype.get',this);
}
var h=%_JSCollectionGetTable(this);
var j=((%_FixedArrayGet(h,(0)|0)));
var i=GetHash(l);
var n=MapFindEntry(h,j,l,i);
if(n===-1)return(void 0);
return((%_FixedArrayGet(h,((3+(j)+((n)*3))+1)|0)));
}
function MapSet(l,u){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(23,
'Map.prototype.set',this);
}
if(l===0){
l=0;
}
var h=%_JSCollectionGetTable(this);
var j=((%_FixedArrayGet(h,(0)|0)));
var i=GetHash(l);
var n=MapFindEntry(h,j,l,i);
if(n!==-1){
var I=(3+(j)+((n)*3));
(%_FixedArraySet(h,(I+1)|0,u));
return this;
}
var v=((%_FixedArrayGet(h,(1)|0)));
var w=((%_FixedArrayGet(h,(2)|0)));
var x=j<<1;
if((v+w)>=x){
%MapGrow(this);
h=%_JSCollectionGetTable(this);
j=((%_FixedArrayGet(h,(0)|0)));
v=((%_FixedArrayGet(h,(1)|0)));
w=((%_FixedArrayGet(h,(2)|0)));
}
n=v+w;
var y=(3+(j)+((n)*3));
var k=(i&((j)-1));
var z=((%_FixedArrayGet(h,(3+(k))|0)));
((%_FixedArraySet(h,(3+(k))|0,n)));
(((%_FixedArraySet(h,(1)|0,(v+1)|0))));
(%_FixedArraySet(h,(y)|0,l));
(%_FixedArraySet(h,(y+1)|0,u));
(%_FixedArraySet(h,(y+2)|0,z));
return this;
}
function MapHas(l){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(23,
'Map.prototype.has',this);
}
var h=%_JSCollectionGetTable(this);
var j=((%_FixedArrayGet(h,(0)|0)));
var i=GetHash(l);
return MapFindEntry(h,j,l,i)!==-1;
}
function MapDelete(l){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(23,
'Map.prototype.delete',this);
}
var h=%_JSCollectionGetTable(this);
var j=((%_FixedArrayGet(h,(0)|0)));
var i=GetHash(l);
var n=MapFindEntry(h,j,l,i);
if(n===-1)return false;
var v=((%_FixedArrayGet(h,(1)|0)))-1;
var w=((%_FixedArrayGet(h,(2)|0)))+1;
var y=(3+(j)+((n)*3));
(%_FixedArraySet(h,(y)|0,%_TheHole()));
(%_FixedArraySet(h,(y+1)|0,%_TheHole()));
(((%_FixedArraySet(h,(1)|0,(v)|0))));
(((%_FixedArraySet(h,(2)|0,(w)|0))));
if(v<(j>>>1))%MapShrink(this);
return true;
}
function MapGetSize(){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(23,
'Map.prototype.size',this);
}
var h=%_JSCollectionGetTable(this);
return((%_FixedArrayGet(h,(1)|0)));
}
function MapClearJS(){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(23,
'Map.prototype.clear',this);
}
%_MapClear(this);
}
function MapForEach(A,B){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(23,
'Map.prototype.forEach',this);
}
if(!(%_ClassOf(A)==='Function'))throw MakeTypeError(9,A);
var C=false;
if((B===null)){
if(%IsSloppyModeFunction(A))B=(void 0);
}else if(!(B===(void 0))){
C=(!(%_IsSpecObject(B))&&%IsSloppyModeFunction(A));
}
var D=new MapIterator(this,3);
var E=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(A);
var F=[(void 0),(void 0)];
while(%MapIteratorNext(D,F)){
if(E)%DebugPrepareStepInIfStepping(A);
var G=C?$toObject(B):B;
%_CallFunction(G,F[1],F[0],this,A);
}
}
%SetCode(d,MapConstructor);
%FunctionSetLength(d,0);
%FunctionSetPrototype(d,new e());
%AddNamedProperty(d.prototype,"constructor",d,2);
%AddNamedProperty(
d.prototype,symbolToStringTag,"Map",2|1);
%FunctionSetLength(MapForEach,1);
$installGetter(d.prototype,"size",MapGetSize);
$installFunctions(d.prototype,2,[
"get",MapGet,
"set",MapSet,
"has",MapHas,
"delete",MapDelete,
"clear",MapClearJS,
"forEach",MapForEach
]);
})

<weak-collection),
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Object;
var e=a.WeakMap;
var g=a.WeakSet;
function WeakMapConstructor(h){
if(!%_IsConstructCall()){
throw MakeTypeError(14,"WeakMap");
}
%WeakCollectionInitialize(this);
if(!(h==null)){
var i=this.set;
if(!(%_ClassOf(i)==='Function')){
throw MakeTypeError(56,'set',this);
}
for(var j of h){
if(!(%_IsSpecObject(j))){
throw MakeTypeError(29,j);
}
%_CallFunction(this,j[0],j[1],i);
}
}
}
function WeakMapGet(k){
if(!(%_ClassOf(this)==='WeakMap')){
throw MakeTypeError(23,
'WeakMap.prototype.get',this);
}
if(!(%_IsSpecObject(k)))return(void 0);
return %WeakCollectionGet(this,k);
}
function WeakMapSet(k,l){
if(!(%_ClassOf(this)==='WeakMap')){
throw MakeTypeError(23,
'WeakMap.prototype.set',this);
}
if(!(%_IsSpecObject(k))){
throw %MakeTypeError('invalid_weakmap_key',[this,k]);
}
return %WeakCollectionSet(this,k,l);
}
function WeakMapHas(k){
if(!(%_ClassOf(this)==='WeakMap')){
throw MakeTypeError(23,
'WeakMap.prototype.has',this);
}
if(!(%_IsSpecObject(k)))return false;
return %WeakCollectionHas(this,k);
}
function WeakMapDelete(k){
if(!(%_ClassOf(this)==='WeakMap')){
throw MakeTypeError(23,
'WeakMap.prototype.delete',this);
}
if(!(%_IsSpecObject(k)))return false;
return %WeakCollectionDelete(this,k);
}
%SetCode(e,WeakMapConstructor);
%FunctionSetLength(e,0);
%FunctionSetPrototype(e,new d());
%AddNamedProperty(e.prototype,"constructor",e,
2);
%AddNamedProperty(e.prototype,symbolToStringTag,"WeakMap",
2|1);
$installFunctions(e.prototype,2,[
"get",WeakMapGet,
"set",WeakMapSet,
"has",WeakMapHas,
"delete",WeakMapDelete
]);
function WeakSetConstructor(h){
if(!%_IsConstructCall()){
throw MakeTypeError(14,"WeakSet");
}
%WeakCollectionInitialize(this);
if(!(h==null)){
var i=this.add;
if(!(%_ClassOf(i)==='Function')){
throw MakeTypeError(56,'add',this);
}
for(var l of h){
%_CallFunction(this,l,i);
}
}
}
function WeakSetAdd(l){
if(!(%_ClassOf(this)==='WeakSet')){
throw MakeTypeError(23,
'WeakSet.prototype.add',this);
}
if(!(%_IsSpecObject(l))){
throw %MakeTypeError('invalid_weakset_value',[this,l]);
}
return %WeakCollectionSet(this,l,true);
}
function WeakSetHas(l){
if(!(%_ClassOf(this)==='WeakSet')){
throw MakeTypeError(23,
'WeakSet.prototype.has',this);
}
if(!(%_IsSpecObject(l)))return false;
return %WeakCollectionHas(this,l);
}
function WeakSetDelete(l){
if(!(%_ClassOf(this)==='WeakSet')){
throw MakeTypeError(23,
'WeakSet.prototype.delete',this);
}
if(!(%_IsSpecObject(l)))return false;
return %WeakCollectionDelete(this,l);
}
%SetCode(g,WeakSetConstructor);
%FunctionSetLength(g,0);
%FunctionSetPrototype(g,new d());
%AddNamedProperty(g.prototype,"constructor",g,
2);
%AddNamedProperty(g.prototype,symbolToStringTag,"WeakSet",
2|1);
$installFunctions(g.prototype,2,[
"add",WeakSetAdd,
"has",WeakSetHas,
"delete",WeakSetDelete
]);
})

Lcollection-iterator]1
var $mapEntries;
var $mapIteratorNext;
var $setIteratorNext;
var $setValues;
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Map;
var e=a.Object;
var g=a.Set;
function SetIteratorConstructor(h,i){
%SetIteratorInitialize(this,h,i);
}
function SetIteratorNextJS(){
if(!(%_ClassOf(this)==='Set Iterator')){
throw MakeTypeError(23,
'Set Iterator.prototype.next',this);
}
var j=[(void 0),(void 0)];
var k={value:j,done:false};
switch(%SetIteratorNext(this,j)){
case 0:
k.value=(void 0);
k.done=true;
break;
case 2:
k.value=j[0];
break;
case 3:
j[1]=j[0];
break;
}
return k;
}
function SetIteratorSymbolIterator(){
return this;
}
function SetEntries(){
if(!(%_ClassOf(this)==='Set')){
throw MakeTypeError(23,
'Set.prototype.entries',this);
}
return new SetIterator(this,3);
}
function SetValues(){
if(!(%_ClassOf(this)==='Set')){
throw MakeTypeError(23,
'Set.prototype.values',this);
}
return new SetIterator(this,2);
}
%SetCode(SetIterator,SetIteratorConstructor);
%FunctionSetPrototype(SetIterator,new e());
%FunctionSetInstanceClassName(SetIterator,'Set Iterator');
$installFunctions(SetIterator.prototype,2,[
'next',SetIteratorNextJS
]);
$setFunctionName(SetIteratorSymbolIterator,symbolIterator);
%AddNamedProperty(SetIterator.prototype,symbolIterator,
SetIteratorSymbolIterator,2);
%AddNamedProperty(SetIterator.prototype,symbolToStringTag,
"Set Iterator",1|2);
$installFunctions(g.prototype,2,[
'entries',SetEntries,
'keys',SetValues,
'values',SetValues
]);
%AddNamedProperty(g.prototype,symbolIterator,SetValues,2);
$setIteratorNext=SetIteratorNextJS;
$setValues=SetValues;
function MapIteratorConstructor(l,i){
%MapIteratorInitialize(this,l,i);
}
function MapIteratorSymbolIterator(){
return this;
}
function MapIteratorNextJS(){
if(!(%_ClassOf(this)==='Map Iterator')){
throw MakeTypeError(23,
'Map Iterator.prototype.next',this);
}
var j=[(void 0),(void 0)];
var k={value:j,done:false};
switch(%MapIteratorNext(this,j)){
case 0:
k.value=(void 0);
k.done=true;
break;
case 1:
k.value=j[0];
break;
case 2:
k.value=j[1];
break;
}
return k;
}
function MapEntries(){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(23,
'Map.prototype.entries',this);
}
return new MapIterator(this,3);
}
function MapKeys(){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(23,
'Map.prototype.keys',this);
}
return new MapIterator(this,1);
}
function MapValues(){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(23,
'Map.prototype.values',this);
}
return new MapIterator(this,2);
}
%SetCode(MapIterator,MapIteratorConstructor);
%FunctionSetPrototype(MapIterator,new e());
%FunctionSetInstanceClassName(MapIterator,'Map Iterator');
$installFunctions(MapIterator.prototype,2,[
'next',MapIteratorNextJS
]);
$setFunctionName(MapIteratorSymbolIterator,symbolIterator);
%AddNamedProperty(MapIterator.prototype,symbolIterator,
MapIteratorSymbolIterator,2);
%AddNamedProperty(MapIterator.prototype,symbolToStringTag,
"Map Iterator",1|2);
$installFunctions(d.prototype,2,[
'entries',MapEntries,
'keys',MapKeys,
'values',MapValues
]);
%AddNamedProperty(d.prototype,symbolIterator,MapEntries,2);
$mapEntries=MapEntries;
$mapIteratorNext=MapIteratorNextJS;
})

promise=e
var $promiseCreate;
var $promiseResolve;
var $promiseReject;
var $promiseChain;
var $promiseCatch;
var $promiseThen;
var $promiseHasUserDefinedRejectHandler;
var $promiseStatus;
var $promiseValue;
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=(%CreateGlobalPrivateOwnSymbol("Promise#status"));
var e=(%CreateGlobalPrivateOwnSymbol("Promise#value"));
var g=(%CreateGlobalPrivateOwnSymbol("Promise#onResolve"));
var h=(%CreateGlobalPrivateOwnSymbol("Promise#onReject"));
var i=(%CreateGlobalPrivateOwnSymbol("Promise#raw"));
var j=%PromiseHasHandlerSymbol();
var k=0;
var l=function Promise(m){
if(m===i)return;
if(!%_IsConstructCall())throw MakeTypeError(35,this);
if(!(%_ClassOf(m)==='Function'))
throw MakeTypeError(71,m);
var n=PromiseInit(this);
try{
%DebugPushPromise(n,Promise);
m(function(o){PromiseResolve(n,o)},
function(p){PromiseReject(n,p)});
}catch(e){
PromiseReject(n,e);
}finally{
%DebugPopPromise();
}
}
function PromiseSet(n,q,r,t,u){
(n[d]=q);
(n[e]=r);
(n[g]=t);
(n[h]=u);
if((%_DebugIsActive()!=0)){
%DebugPromiseEvent({promise:n,status:q,value:r});
}
return n;
}
function PromiseCreateAndSet(q,r){
var n=new l(i);
if((%_DebugIsActive()!=0))PromiseSet(n,0,(void 0));
return PromiseSet(n,q,r);
}
function PromiseInit(n){
return PromiseSet(
n,0,(void 0),new InternalArray,new InternalArray)
}
function PromiseDone(n,q,r,v){
if((n[d])===0){
var w=(n[v]);
if(w.length)PromiseEnqueue(r,w,q);
PromiseSet(n,q,r);
}
}
function PromiseCoerce(x,o){
if(!IsPromise(o)&&(%_IsSpecObject(o))){
var y;
try{
y=o.then;
}catch(p){
return %_CallFunction(x,p,PromiseRejected);
}
if((%_ClassOf(y)==='Function')){
var z=%_CallFunction(x,PromiseDeferred);
try{
%_CallFunction(o,z.resolve,z.reject,y);
}catch(p){
z.reject(p);
}
return z.promise;
}
}
return o;
}
function PromiseHandle(r,A,z){
try{
%DebugPushPromise(z.promise,PromiseHandle);
if((%_DebugIsActive()!=0&&%DebugCallbackSupportsStepping(A)))%DebugPrepareStepInIfStepping(A);
var B=A(r);
if(B===z.promise)
throw MakeTypeError(54,B);
else if(IsPromise(B))
%_CallFunction(B,z.resolve,z.reject,PromiseChain);
else
z.resolve(B);
}catch(exception){
try{z.reject(exception);}catch(e){}
}finally{
%DebugPopPromise();
}
}
function PromiseEnqueue(r,w,q){
var C,D,E=(%_DebugIsActive()!=0);
%EnqueueMicrotask(function(){
if(E){
%DebugAsyncTaskEvent({type:"willHandle",id:C,name:D});
}
for(var F=0;F<w.length;F+=2){
PromiseHandle(r,w[F],w[F+1])
}
if(E){
%DebugAsyncTaskEvent({type:"didHandle",id:C,name:D});
}
});
if(E){
C=++k;
D=q>0?"Promise.resolve":"Promise.reject";
%DebugAsyncTaskEvent({type:"enqueue",id:C,name:D});
}
}
function PromiseIdResolveHandler(o){return o}
function PromiseIdRejectHandler(p){throw p}
function PromiseNopResolver(){}
function IsPromise(o){
return(%_IsSpecObject(o))&&(!(o[d]===(void 0)));
}
function PromiseCreate(){
return new l(PromiseNopResolver)
}
function PromiseResolve(n,o){
PromiseDone(n,+1,o,g)
}
function PromiseReject(n,p){
if((n[d])==0){
var G=(%_DebugIsActive()!=0);
if(G||!(!(n[j]===(void 0)))){
%PromiseRejectEvent(n,p,G);
}
}
PromiseDone(n,-1,p,h)
}
function PromiseDeferred(){
if(this===l){
var n=PromiseInit(new l(i));
return{
promise:n,
resolve:function(o){PromiseResolve(n,o)},
reject:function(p){PromiseReject(n,p)}
};
}else{
var B={};
B.promise=new this(function(H,I){
B.resolve=H;
B.reject=I;
})
return B;
}
}
function PromiseResolved(o){
if(this===l){
return PromiseCreateAndSet(+1,o);
}else{
return new this(function(H,I){H(o)});
}
}
function PromiseRejected(p){
var n;
if(this===l){
n=PromiseCreateAndSet(-1,p);
%PromiseRejectEvent(n,p,false);
}else{
n=new this(function(H,I){I(p)});
}
return n;
}
function PromiseChain(t,u){
t=(t===(void 0))?PromiseIdResolveHandler:t;
u=(u===(void 0))?PromiseIdRejectHandler:u;
var z=%_CallFunction(this.constructor,PromiseDeferred);
switch((this[d])){
case(void 0):
throw MakeTypeError(35,this);
case 0:
(this[g]).push(t,z);
(this[h]).push(u,z);
break;
case+1:
PromiseEnqueue((this[e]),
[t,z],
+1);
break;
case-1:
if(!(!(this[j]===(void 0)))){
%PromiseRevokeReject(this);
}
PromiseEnqueue((this[e]),
[u,z],
-1);
break;
}
(this[j]=true);
if((%_DebugIsActive()!=0)){
%DebugPromiseEvent({promise:z.promise,parentPromise:this});
}
return z.promise;
}
function PromiseCatch(u){
return this.then((void 0),u);
}
function PromiseThen(t,u){
t=(%_ClassOf(t)==='Function')?t
:PromiseIdResolveHandler;
u=(%_ClassOf(u)==='Function')?u
:PromiseIdRejectHandler;
var J=this;
var x=this.constructor;
return %_CallFunction(
this,
function(o){
o=PromiseCoerce(x,o);
if(o===J){
if((%_DebugIsActive()!=0&&%DebugCallbackSupportsStepping(u)))%DebugPrepareStepInIfStepping(u);
return u(MakeTypeError(54,o));
}else if(IsPromise(o)){
return o.then(t,u);
}else{
if((%_DebugIsActive()!=0&&%DebugCallbackSupportsStepping(t)))%DebugPrepareStepInIfStepping(t);
return t(o);
}
},
u,
PromiseChain
);
}
function PromiseCast(o){
return IsPromise(o)?o:new this(function(H){H(o)});
}
function PromiseAll(K){
var z=%_CallFunction(this,PromiseDeferred);
var L=[];
try{
var M=0;
var F=0;
for(var r of K){
this.resolve(r).then(
(function(F){
return function(o){
L[F]=o;
if(--M===0)z.resolve(L);
}
})(F),
function(p){z.reject(p);});
++F;
++M;
}
if(M===0){
z.resolve(L);
}
}catch(e){
z.reject(e)
}
return z.promise;
}
function PromiseRace(K){
var z=%_CallFunction(this,PromiseDeferred);
try{
for(var r of K){
this.resolve(r).then(
function(o){z.resolve(o)},
function(p){z.reject(p)});
}
}catch(e){
z.reject(e)
}
return z.promise;
}
function PromiseHasUserDefinedRejectHandlerRecursive(n){
var N=(n[h]);
if((N===(void 0)))return false;
for(var F=0;F<N.length;F+=2){
if(N[F]!=PromiseIdRejectHandler)return true;
if(PromiseHasUserDefinedRejectHandlerRecursive(N[F+1].promise)){
return true;
}
}
return false;
}
function PromiseHasUserDefinedRejectHandler(){
return PromiseHasUserDefinedRejectHandlerRecursive(this);
};
%AddNamedProperty(a,'Promise',l,2);
%AddNamedProperty(l.prototype,symbolToStringTag,"Promise",
2|1);
$installFunctions(l,2,[
"defer",PromiseDeferred,
"accept",PromiseResolved,
"reject",PromiseRejected,
"all",PromiseAll,
"race",PromiseRace,
"resolve",PromiseCast
]);
$installFunctions(l.prototype,2,[
"chain",PromiseChain,
"then",PromiseThen,
"catch",PromiseCatch
]);
$promiseCreate=PromiseCreate;
$promiseResolve=PromiseResolve;
$promiseReject=PromiseReject;
$promiseChain=PromiseChain;
$promiseCatch=PromiseCatch;
$promiseThen=PromiseThen;
$promiseHasUserDefinedRejectHandler=PromiseHasUserDefinedRejectHandler;
$promiseStatus=d;
$promiseValue=e;
})

 messages¦Œ
var $errorToString;
var $formatMessage;
var $getStackTraceLine;
var $messageGetPositionInLine;
var $messageGetLineNumber;
var $messageGetSourceLine;
var $stackOverflowBoilerplate;
var $stackTraceSymbol;
var $toDetailString;
var $Error;
var $EvalError;
var $RangeError;
var $ReferenceError;
var $SyntaxError;
var $TypeError;
var $URIError;
var MakeError;
var MakeEvalError;
var MakeRangeError;
var MakeReferenceError;
var MakeSyntaxError;
var MakeTypeError;
var MakeURIError;
var MakeReferenceErrorEmbedded;
var MakeSyntaxErrorEmbedded;
var MakeTypeErrorEmbedded;
(function(a,b,c){
%CheckIsBootstrapping();
var d=a.Object;
var e;
var g;
var h;
var i;
var j;
var k;
var l;
var m={
constructor_is_generator:["Class constructor may not be a generator"],
constructor_is_accessor:["Class constructor may not be an accessor"],
unexpected_token:["Unexpected token ","%0"],
unexpected_token_number:["Unexpected number"],
unexpected_token_string:["Unexpected string"],
unexpected_token_identifier:["Unexpected identifier"],
unexpected_reserved:["Unexpected reserved word"],
unexpected_strict_reserved:["Unexpected strict mode reserved word"],
unexpected_eos:["Unexpected end of input"],
unexpected_template_string:["Unexpected template string"],
malformed_regexp:["Invalid regular expression: /","%0","/: ","%1"],
malformed_regexp_flags:["Invalid regular expression flags"],
unterminated_regexp:["Invalid regular expression: missing /"],
unterminated_template:["Unterminated template literal"],
unterminated_template_expr:["Missing } in template expression"],
unterminated_arg_list:["missing ) after argument list"],
regexp_flags:["Cannot supply flags when constructing one RegExp from another"],
multiple_defaults_in_switch:["More than one default clause in switch statement"],
newline_after_throw:["Illegal newline after throw"],
label_redeclaration:["Label '","%0","' has already been declared"],
var_redeclaration:["Identifier '","%0","' has already been declared"],
duplicate_template_property:["Object template has duplicate property '","%0","'"],
no_catch_or_finally:["Missing catch or finally after try"],
unknown_label:["Undefined label '","%0","'"],
uncaught_exception:["Uncaught ","%0"],
undefined_method:["Object ","%1"," has no method '","%0","'"],
non_object_property_load:["Cannot read property '","%0","' of ","%1"],
non_object_property_store:["Cannot set property '","%0","' of ","%1"],
illegal_invocation:["Illegal invocation"],
no_setter_in_callback:["Cannot set property ","%0"," of ","%1"," which has only a getter"],
value_and_accessor:["Invalid property.  A property cannot both have accessors and be writable or have a value, ","%0"],
proto_object_or_null:["Object prototype may only be an Object or null: ","%0"],
non_extensible_proto:["%0"," is not extensible"],
invalid_weakmap_key:["Invalid value used as weak map key"],
invalid_weakset_value:["Invalid value used in weak set"],
not_date_object:["this is not a Date object."],
not_a_symbol:["%0"," is not a symbol"],
invalid_lhs_in_assignment:["Invalid left-hand side in assignment"],
invalid_lhs_in_for:["Invalid left-hand side in for-loop"],
invalid_lhs_in_postfix_op:["Invalid left-hand side expression in postfix operation"],
invalid_lhs_in_prefix_op:["Invalid left-hand side expression in prefix operation"],
not_isvar:["builtin %IS_VAR: not a variable"],
single_function_literal:["Single function literal required"],
invalid_regexp_flags:["Invalid flags supplied to RegExp constructor '","%0","'"],
invalid_regexp:["Invalid RegExp pattern /","%0","/"],
illegal_break:["Illegal break statement"],
illegal_continue:["Illegal continue statement"],
illegal_return:["Illegal return statement"],
error_loading_debugger:["Error loading debugger"],
circular_structure:["Converting circular structure to JSON"],
array_indexof_not_defined:["Array.getIndexOf: Argument undefined"],
object_not_extensible:["Can't add property ","%0",", object is not extensible"],
illegal_access:["Illegal access"],
static_prototype:["Classes may not have static property named prototype"],
strict_mode_with:["Strict mode code may not include a with statement"],
strict_eval_arguments:["Unexpected eval or arguments in strict mode"],
too_many_arguments:["Too many arguments in function call (only 65535 allowed)"],
too_many_parameters:["Too many parameters in function definition (only 65535 allowed)"],
too_many_variables:["Too many variables declared (only 4194303 allowed)"],
strict_param_dupe:["Strict mode function may not have duplicate parameter names"],
strict_octal_literal:["Octal literals are not allowed in strict mode."],
template_octal_literal:["Octal literals are not allowed in template strings."],
strict_delete:["Delete of an unqualified identifier in strict mode."],
strict_delete_property:["Cannot delete property '","%0","' of ","%1"],
strict_function:["In strict mode code, functions can only be declared at top level or immediately within another function."],
strict_read_only_property:["Cannot assign to read only property '","%0","' of ","%1"],
strict_cannot_assign:["Cannot assign to read only '","%0","' in strict mode"],
restricted_function_properties:["'caller' and 'arguments' are restricted function properties and cannot be accessed in this context."],
strict_poison_pill:["'caller', 'callee', and 'arguments' properties may not be accessed on strict mode functions or the arguments objects for calls to them"],
strict_caller:["Illegal access to a strict mode caller function."],
strong_ellision:["In strong mode, arrays with holes are deprecated, use maps instead"],
strong_arguments:["In strong mode, 'arguments' is deprecated, use '...args' instead"],
strong_undefined:["In strong mode, binding or assigning to 'undefined' is deprecated"],
strong_implicit_cast:["In strong mode, implicit conversions are deprecated"],
strong_direct_eval:["In strong mode, direct calls to eval are deprecated"],
strong_switch_fallthrough:["In strong mode, switch fall-through is deprecated, terminate each case with 'break', 'continue', 'return' or 'throw'"],
strong_equal:["In strong mode, '==' and '!=' are deprecated, use '===' and '!==' instead"],
strong_delete:["In strong mode, 'delete' is deprecated, use maps or sets instead"],
strong_var:["In strong mode, 'var' is deprecated, use 'let' or 'const' instead"],
strong_for_in:["In strong mode, 'for'-'in' loops are deprecated, use 'for'-'of' instead"],
strong_empty:["In strong mode, empty sub-statements are deprecated, make them explicit with '{}' instead"],
strong_use_before_declaration:["In strong mode, declaring variable '","%0","' before its use is required"],
strong_unbound_global:["In strong mode, using an undeclared global variable '","%0","' is not allowed"],
strong_super_call_missing:["In strong mode, invoking the super constructor in a subclass is required"],
strong_super_call_duplicate:["In strong mode, invoking the super constructor multiple times is deprecated"],
strong_super_call_misplaced:["In strong mode, the super constructor must be invoked before any assignment to 'this'"],
strong_constructor_super:["In strong mode, 'super' can only be used to invoke the super constructor, and cannot be nested inside another statement or expression"],
strong_constructor_this:["In strong mode, 'this' can only be used to initialize properties, and cannot be nested inside another statement or expression"],
strong_constructor_return_value:["In strong mode, returning a value from a constructor is deprecated"],
strong_constructor_return_misplaced:["In strong mode, returning from a constructor before its super constructor invocation or all assignments to 'this' is deprecated"],
sloppy_lexical:["Block-scoped declarations (let, const, function, class) not yet supported outside strict mode"],
malformed_arrow_function_parameter_list:["Malformed arrow function parameter list"],
cant_prevent_ext_external_array_elements:["Cannot prevent extension of an object with external array elements"],
redef_external_array_element:["Cannot redefine a property of an object with external array elements"],
const_assign:["Assignment to constant variable."],
module_export_undefined:["Export '","%0","' is not defined in module"],
duplicate_export:["Duplicate export of '","%0","'"],
unexpected_super:["'super' keyword unexpected here"],
extends_value_not_a_function:["Class extends value ","%0"," is not a function or null"],
extends_value_generator:["Class extends value ","%0"," may not be a generator function"],
prototype_parent_not_an_object:["Class extends value does not have valid prototype property ","%0"],
duplicate_constructor:["A class may only have one constructor"],
super_constructor_call:["A 'super' constructor call may only appear as the first statement of a function, and its arguments may not access 'this'. Other forms are not yet supported."],
duplicate_proto:["Duplicate __proto__ fields are not allowed in object literals"],
param_after_rest:["Rest parameter must be last formal parameter"],
derived_constructor_return:["Derived constructors may only return object or undefined"],
for_in_loop_initializer:["for-in loop variable declaration may not have an initializer."],
for_of_loop_initializer:["for-of loop variable declaration may not have an initializer."],
for_inof_loop_multi_bindings:["Invalid left-hand side in ","%0"," loop: Must have a single binding."],
bad_getter_arity:["Getter must not have any formal parameters."],
bad_setter_arity:["Setter must have exactly one formal parameter."],
this_formal_parameter:["'this' is not a valid formal parameter name"],
duplicate_arrow_function_formal_parameter:["Arrow function may not have duplicate parameter names"]
};
function FormatString(n,o){
var p="";
var q=0;
for(var r=0;r<n.length;r++){
var t=n[r];
if(t.length==2&&%_StringCharCodeAt(t,0)==0x25){
var q=(%_StringCharCodeAt(t,1)-0x30)>>>0;
if(q<4){
try{
t=NoSideEffectToString(o[q]);
}catch(e){
if(%IsJSModule(o[q]))
t="module";
else if((%_IsSpecObject(o[q])))
t="object";
else
t="#<error>";
}
}
}
p+=t;
}
return p;
}
function NoSideEffectsObjectToString(){
if((this===(void 0))&&!(%_IsUndetectableObject(this)))return"[object Undefined]";
if((this===null))return"[object Null]";
return"[object "+%_ClassOf(((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this)))+"]";
}
function NoSideEffectToString(u){
if((typeof(u)==='string'))return u;
if((typeof(u)==='number'))return %_NumberToString(u);
if((typeof(u)==='boolean'))return u?'true':'false';
if((u===(void 0)))return'undefined';
if((u===null))return'null';
if((%_IsFunction(u))){
var t=%_CallFunction(u,u,$functionSourceString);
if(t.length>128){
t=%_SubString(t,0,111)+"...<omitted>..."+
%_SubString(t,t.length-2,t.length);
}
return t;
}
if((typeof(u)==='symbol'))return %_CallFunction(u,$symbolToString);
if((%_IsObject(u))
&&%GetDataProperty(u,"toString")===$objectToString){
var v=%GetDataProperty(u,"constructor");
if(typeof v=="function"){
var w=v.name;
if((typeof(w)==='string')&&w!==""){
return"#<"+w+">";
}
}
}
if(CanBeSafelyTreatedAsAnErrorObject(u)){
return %_CallFunction(u,ErrorToString);
}
return %_CallFunction(u,NoSideEffectsObjectToString);
}
function CanBeSafelyTreatedAsAnErrorObject(u){
switch(%_ClassOf(u)){
case'Error':
case'EvalError':
case'RangeError':
case'ReferenceError':
case'SyntaxError':
case'TypeError':
case'URIError':
return true;
}
var x=%GetDataProperty(u,"toString");
return u instanceof e&&x===ErrorToString;
}
function ToStringCheckErrorObject(u){
if(CanBeSafelyTreatedAsAnErrorObject(u)){
return %_CallFunction(u,ErrorToString);
}else{
return $toString(u);
}
}
function ToDetailString(u){
if(u!=null&&(%_IsObject(u))&&u.toString===$objectToString){
var v=u.constructor;
if(typeof v=="function"){
var w=v.name;
if((typeof(w)==='string')&&w!==""){
return"#<"+w+">";
}
}
}
return ToStringCheckErrorObject(u);
}
function MakeGenericError(v,y,z,A,B){
if((z===(void 0))&&(typeof(y)==='string'))z=[];
return new v(FormatMessage(y,z,A,B));
}
%FunctionSetInstanceClassName(Script,'Script');
%AddNamedProperty(Script.prototype,'constructor',Script,
2|4|1);
%SetCode(Script,function(C){
throw MakeError(2);
});
function FormatMessage(y,z,A,B){
if((typeof(y)==='number')){
var z=NoSideEffectToString(z);
var A=NoSideEffectToString(A);
var B=NoSideEffectToString(B);
try{
return %FormatMessageString(y,z,A,B);
}catch(e){
return"";
}
}
var n=m[y];
if(!n)return"<unknown message "+y+">";
return FormatString(n,z);
}
function GetLineNumber(D){
var E=%MessageGetStartPosition(D);
if(E==-1)return 0;
var F=%MessageGetScript(D);
var G=F.locationFromPosition(E,true);
if(G==null)return 0;
return G.line+1;
}
function GetSourceLine(D){
var F=%MessageGetScript(D);
var E=%MessageGetStartPosition(D);
var G=F.locationFromPosition(E,true);
if(G==null)return"";
return G.sourceText();
}
function ScriptLineFromPosition(H){
var I=0;
var J=this.lineCount()-1;
var K=this.line_ends;
if(H>K[J]){
return-1;
}
if(H<=K[0]){
return 0;
}
while(J>=1){
var r=(I+J)>>1;
if(H>K[r]){
I=r+1;
}else if(H<=K[r-1]){
J=r-1;
}else{
return r;
}
}
return-1;
}
function ScriptLocationFromPosition(H,
include_resource_offset){
var L=this.lineFromPosition(H);
if(L==-1)return null;
var K=this.line_ends;
var M=L==0?0:K[L-1]+1;
var N=K[L];
if(N>0&&%_CallFunction(this.source,N-1,$stringCharAt)=='\r'){
N--;
}
var O=H-M;
if(include_resource_offset){
L+=this.line_offset;
if(L==this.line_offset){
O+=this.column_offset;
}
}
return new SourceLocation(this,H,L,O,M,N);
}
function ScriptLocationFromLine(P,Q,R){
var L=0;
if(!(P===(void 0))){
L=P-this.line_offset;
}
var O=Q||0;
if(L==0){
O-=this.column_offset;
}
var S=R||0;
if(L<0||O<0||S<0)return null;
if(L==0){
return this.locationFromPosition(S+O,false);
}else{
var T=this.lineFromPosition(S);
if(T==-1||T+L>=this.lineCount()){
return null;
}
return this.locationFromPosition(
this.line_ends[T+L-1]+1+O);
}
}
function ScriptSourceSlice(U,V){
var W=(U===(void 0))?this.line_offset
:U;
var X=(V===(void 0))?this.line_offset+this.lineCount()
:V;
W-=this.line_offset;
X-=this.line_offset;
if(W<0)W=0;
if(X>this.lineCount())X=this.lineCount();
if(W>=this.lineCount()||
X<0||
W>X){
return null;
}
var K=this.line_ends;
var Y=W==0?0:K[W-1]+1;
var Z=X==0?0:K[X-1]+1;
return new SourceSlice(this,
W+this.line_offset,
X+this.line_offset,
Y,Z);
}
function ScriptSourceLine(P){
var L=0;
if(!(P===(void 0))){
L=P-this.line_offset;
}
if(L<0||this.lineCount()<=L){
return null;
}
var K=this.line_ends;
var M=L==0?0:K[L-1]+1;
var N=K[L];
return %_CallFunction(this.source,M,N,$stringSubstring);
}
function ScriptLineCount(){
return this.line_ends.length;
}
function ScriptNameOrSourceURL(){
if(this.source_url)return this.source_url;
return this.name;
}
$setUpLockedPrototype(Script,[
"source",
"name",
"source_url",
"source_mapping_url",
"line_ends",
"line_offset",
"column_offset"
],[
"lineFromPosition",ScriptLineFromPosition,
"locationFromPosition",ScriptLocationFromPosition,
"locationFromLine",ScriptLocationFromLine,
"sourceSlice",ScriptSourceSlice,
"sourceLine",ScriptSourceLine,
"lineCount",ScriptLineCount,
"nameOrSourceURL",ScriptNameOrSourceURL
]
);
function SourceLocation(F,H,L,O,M,N){
this.script=F;
this.position=H;
this.line=L;
this.column=O;
this.start=M;
this.end=N;
}
function SourceLocationSourceText(){
return %_CallFunction(this.script.source,
this.start,
this.end,
$stringSubstring);
}
$setUpLockedPrototype(SourceLocation,
["script","position","line","column","start","end"],
["sourceText",SourceLocationSourceText]
);
function SourceSlice(F,W,X,Y,Z){
this.script=F;
this.from_line=W;
this.to_line=X;
this.from_position=Y;
this.to_position=Z;
}
function SourceSliceSourceText(){
return %_CallFunction(this.script.source,
this.from_position,
this.to_position,
$stringSubstring);
}
$setUpLockedPrototype(SourceSlice,
["script","from_line","to_line","from_position","to_position"],
["sourceText",SourceSliceSourceText]
);
function GetPositionInLine(D){
var F=%MessageGetScript(D);
var E=%MessageGetStartPosition(D);
var G=F.locationFromPosition(E,false);
if(G==null)return-1;
return E-G.start;
}
function GetStackTraceLine(aa,ab,ac,ad){
return new CallSite(aa,ab,ac,false).toString();
}
var ae=(%CreatePrivateOwnSymbol("CallSite#receiver"));
var af=(%CreatePrivateOwnSymbol("CallSite#function"));
var ag=(%CreatePrivateOwnSymbol("CallSite#position"));
var ah=(%CreatePrivateOwnSymbol("CallSite#strict_mode"));
function CallSite(ai,ab,ac,aj){
(this[ae]=ai);
(this[af]=ab);
(this[ag]=ac);
(this[ah]=aj);
}
function CallSiteGetThis(){
return(this[ah])
?(void 0):(this[ae]);
}
function CallSiteGetFunction(){
return(this[ah])
?(void 0):(this[af]);
}
function CallSiteGetPosition(){
return(this[ag]);
}
function CallSiteGetTypeName(){
return GetTypeName((this[ae]),false);
}
function CallSiteIsToplevel(){
var ai=(this[ae]);
var ab=(this[af]);
var ac=(this[ag]);
return %CallSiteIsToplevelRT(ai,ab,ac);
}
function CallSiteIsEval(){
var ai=(this[ae]);
var ab=(this[af]);
var ac=(this[ag]);
return %CallSiteIsEvalRT(ai,ab,ac);
}
function CallSiteGetEvalOrigin(){
var F=%FunctionGetScript((this[af]));
return FormatEvalOrigin(F);
}
function CallSiteGetScriptNameOrSourceURL(){
var ai=(this[ae]);
var ab=(this[af]);
var ac=(this[ag]);
return %CallSiteGetScriptNameOrSourceUrlRT(ai,ab,ac);
}
function CallSiteGetFunctionName(){
var ai=(this[ae]);
var ab=(this[af]);
var ac=(this[ag]);
return %CallSiteGetFunctionNameRT(ai,ab,ac);
}
function CallSiteGetMethodName(){
var ai=(this[ae]);
var ab=(this[af]);
var ac=(this[ag]);
return %CallSiteGetMethodNameRT(ai,ab,ac);
}
function CallSiteGetFileName(){
var ai=(this[ae]);
var ab=(this[af]);
var ac=(this[ag]);
return %CallSiteGetFileNameRT(ai,ab,ac);
}
function CallSiteGetLineNumber(){
var ai=(this[ae]);
var ab=(this[af]);
var ac=(this[ag]);
return %CallSiteGetLineNumberRT(ai,ab,ac);
}
function CallSiteGetColumnNumber(){
var ai=(this[ae]);
var ab=(this[af]);
var ac=(this[ag]);
return %CallSiteGetColumnNumberRT(ai,ab,ac);
}
function CallSiteIsNative(){
var ai=(this[ae]);
var ab=(this[af]);
var ac=(this[ag]);
return %CallSiteIsNativeRT(ai,ab,ac);
}
function CallSiteIsConstructor(){
var ai=(this[ae]);
var ab=(this[af]);
var ac=(this[ag]);
return %CallSiteIsConstructorRT(ai,ab,ac);
}
function CallSiteToString(){
var ak;
var al="";
if(this.isNative()){
al="native";
}else{
ak=this.getScriptNameOrSourceURL();
if(!ak&&this.isEval()){
al=this.getEvalOrigin();
al+=", ";
}
if(ak){
al+=ak;
}else{
al+="<anonymous>";
}
var am=this.getLineNumber();
if(am!=null){
al+=":"+am;
var an=this.getColumnNumber();
if(an){
al+=":"+an;
}
}
}
var L="";
var ao=this.getFunctionName();
var ap=true;
var aq=this.isConstructor();
var ar=!(this.isToplevel()||aq);
if(ar){
var as=GetTypeName((this[ae]),true);
var at=this.getMethodName();
if(ao){
if(as&&
%_CallFunction(ao,as,$stringIndexOf)!=0){
L+=as+".";
}
L+=ao;
if(at&&
(%_CallFunction(ao,"."+at,$stringIndexOf)!=
ao.length-at.length-1)){
L+=" [as "+at+"]";
}
}else{
L+=as+"."+(at||"<anonymous>");
}
}else if(aq){
L+="new "+(ao||"<anonymous>");
}else if(ao){
L+=ao;
}else{
L+=al;
ap=false;
}
if(ap){
L+=" ("+al+")";
}
return L;
}
$setUpLockedPrototype(CallSite,["receiver","fun","pos"],[
"getThis",CallSiteGetThis,
"getTypeName",CallSiteGetTypeName,
"isToplevel",CallSiteIsToplevel,
"isEval",CallSiteIsEval,
"getEvalOrigin",CallSiteGetEvalOrigin,
"getScriptNameOrSourceURL",CallSiteGetScriptNameOrSourceURL,
"getFunction",CallSiteGetFunction,
"getFunctionName",CallSiteGetFunctionName,
"getMethodName",CallSiteGetMethodName,
"getFileName",CallSiteGetFileName,
"getLineNumber",CallSiteGetLineNumber,
"getColumnNumber",CallSiteGetColumnNumber,
"isNative",CallSiteIsNative,
"getPosition",CallSiteGetPosition,
"isConstructor",CallSiteIsConstructor,
"toString",CallSiteToString
]);
function FormatEvalOrigin(F){
var au=F.nameOrSourceURL();
if(au){
return au;
}
var av="eval at ";
if(F.eval_from_function_name){
av+=F.eval_from_function_name;
}else{
av+="<anonymous>";
}
var aw=F.eval_from_script;
if(aw){
if(aw.compilation_type==1){
av+=" ("+FormatEvalOrigin(aw)+")";
}else{
if(aw.name){
av+=" ("+aw.name;
var G=aw.locationFromPosition(
F.eval_from_script_position,true);
if(G){
av+=":"+(G.line+1);
av+=":"+(G.column+1);
}
av+=")";
}else{
av+=" (unknown source)";
}
}
}
return av;
}
function FormatErrorString(ax){
try{
return %_CallFunction(ax,ErrorToString);
}catch(e){
try{
return"<error: "+e+">";
}catch(ee){
return"<error>";
}
}
}
function GetStackFrames(ay){
var az=new InternalArray();
var aA=ay[0];
for(var r=1;r<ay.length;r+=4){
var aa=ay[r];
var ab=ay[r+1];
var aB=ay[r+2];
var aC=ay[r+3];
var ac=%_IsSmi(aB)?aB:%FunctionGetPositionForOffset(aB,aC);
aA--;
az.push(new CallSite(aa,ab,ac,(aA<0)));
}
return az;
}
var aD=false;
function FormatStackTrace(u,ay){
var az=GetStackFrames(ay);
if((%_IsFunction(e.prepareStackTrace))&&
!aD){
var aE=[];
%MoveArrayContents(az,aE);
aD=true;
var aF=(void 0);
try{
aF=e.prepareStackTrace(u,aE);
}catch(e){
throw e;
}finally{
aD=false;
}
return aF;
}
var aG=new InternalArray();
aG.push(FormatErrorString(u));
for(var r=0;r<az.length;r++){
var aH=az[r];
var L;
try{
L=aH.toString();
}catch(e){
try{
L="<error: "+e+">";
}catch(ee){
L="<error>";
}
}
aG.push("    at "+L);
}
return %_CallFunction(aG,"\n",$arrayJoin);
}
function GetTypeName(ai,aI){
var v=ai.constructor;
if(!v){
return aI?null:
%_CallFunction(ai,NoSideEffectsObjectToString);
}
var w=v.name;
if(!w){
return aI?null:
%_CallFunction(ai,NoSideEffectsObjectToString);
}
return w;
}
var aJ=(%CreatePrivateOwnSymbol("formatted stack trace"));
var aK=function(){
var aL=(void 0);
var aM=this;
while(aM){
var aL=
(aM[aJ]);
if((aL===(void 0))){
var aF=(aM[$stackTraceSymbol]);
if((aF===(void 0))){
aM=%_GetPrototype(aM);
continue;
}
aL=FormatStackTrace(aM,aF);
(aM[$stackTraceSymbol]=(void 0));
(aM[aJ]=aL);
}
return aL;
}
return(void 0);
};
var aN=function(aO){
if((%HasOwnProperty(this,$stackTraceSymbol))){
(this[$stackTraceSymbol]=(void 0));
(this[aJ]=aO);
}
};
var aP=function captureStackTrace(u,aQ){
$objectDefineProperty(u,'stack',{get:aK,
set:aN,
configurable:true});
%CollectStackTrace(u,aQ?aQ:aP);
}
function DefineError(a,aR){
var aS=aR.name;
%AddNamedProperty(a,aS,aR,2);
if(aS=='Error'){
var aT=function(){};
%FunctionSetPrototype(aT,d.prototype);
%FunctionSetInstanceClassName(aT,'Error');
%FunctionSetPrototype(aR,new aT());
}else{
%FunctionSetPrototype(aR,new e());
%InternalSetPrototype(aR,e);
}
%FunctionSetInstanceClassName(aR,'Error');
%AddNamedProperty(aR.prototype,'constructor',aR,2);
%AddNamedProperty(aR.prototype,'name',aS,2);
%SetCode(aR,function(aU){
if(%_IsConstructCall()){
try{aP(this,aR);}catch(e){}
if(!(aU===(void 0))){
%AddNamedProperty(this,'message',$toString(aU),2);
}
}else{
return new aR(aU);
}
});
%SetNativeFlag(aR);
return aR;
};
e=DefineError(a,function Error(){});
l=DefineError(a,function EvalError(){});
h=DefineError(a,function RangeError(){});
k=DefineError(a,function ReferenceError(){});
j=DefineError(a,function SyntaxError(){});
g=DefineError(a,function TypeError(){});
i=DefineError(a,function URIError(){});
e.captureStackTrace=aP;
%AddNamedProperty(e.prototype,'message','',2);
var aV=new InternalArray();
var aW=new d();
function GetPropertyWithoutInvokingMonkeyGetters(ax,aS){
var aX=ax;
while(aX&&!%HasOwnProperty(aX,aS)){
aX=%_GetPrototype(aX);
}
if((aX===null))return(void 0);
if(!(%_IsObject(aX)))return ax[aS];
var aY=%GetOwnProperty(aX,aS);
if(aY&&aY[0]){
var aZ=aS==="name";
if(aX===k.prototype)
return aZ?"ReferenceError":(void 0);
if(aX===j.prototype)
return aZ?"SyntaxError":(void 0);
if(aX===g.prototype)
return aZ?"TypeError":(void 0);
}
return ax[aS];
}
function ErrorToStringDetectCycle(ax){
if(!%PushIfAbsent(aV,ax))throw aW;
try{
var aS=GetPropertyWithoutInvokingMonkeyGetters(ax,"name");
aS=(aS===(void 0))?"Error":((typeof(%IS_VAR(aS))==='string')?aS:$nonStringToString(aS));
var D=GetPropertyWithoutInvokingMonkeyGetters(ax,"message");
D=(D===(void 0))?"":((typeof(%IS_VAR(D))==='string')?D:$nonStringToString(D));
if(aS==="")return D;
if(D==="")return aS;
return aS+": "+D;
}finally{
aV.length=aV.length-1;
}
}
function ErrorToString(){
if(!(%_IsSpecObject(this))){
throw MakeTypeError(10,"Error.prototype.toString");
}
try{
return ErrorToStringDetectCycle(this);
}catch(e){
if(e===aW){
return'';
}
throw e;
}
}
$installFunctions(e.prototype,2,
['toString',ErrorToString]);
$errorToString=ErrorToString;
$formatMessage=FormatMessage;
$getStackTraceLine=GetStackTraceLine;
$messageGetPositionInLine=GetPositionInLine;
$messageGetLineNumber=GetLineNumber;
$messageGetSourceLine=GetSourceLine;
$toDetailString=ToDetailString;
$Error=e;
$EvalError=l;
$RangeError=h;
$ReferenceError=k;
$SyntaxError=j;
$TypeError=g;
$URIError=i;
MakeError=function(y,z,A,B){
return MakeGenericError(e,y,z,A,B);
}
MakeEvalError=function(y,z,A,B){
return MakeGenericError(l,y,z,A,B);
}
MakeRangeError=function(y,z,A,B){
return MakeGenericError(h,y,z,A,B);
}
MakeReferenceError=function(y,z,A,B){
return MakeGenericError(k,y,z,A,B);
}
MakeSyntaxError=function(y,z,A,B){
return MakeGenericError(j,y,z,A,B);
}
MakeTypeError=function(y,z,A,B){
return MakeGenericError(g,y,z,A,B);
}
MakeURIError=function(){
return MakeGenericError(i,112);
}
MakeSyntaxErrorEmbedded=function(y,ba){
return MakeGenericError(j,y,[ba]);
}
MakeReferenceErrorEmbedded=function(y,ba){
return MakeGenericError(k,y,[ba]);
}
MakeTypeErrorEmbedded=function(y,ba){
return MakeGenericError(g,y,[ba]);
}
$stackOverflowBoilerplate=MakeRangeError(103);
%DefineAccessorPropertyUnchecked($stackOverflowBoilerplate,'stack',
aK,aN,2);
})

jsonY;
var $jsonSerializeAdapter;
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.JSON;
function Revive(e,g,h){
var i=e[g];
if((%_IsObject(i))){
if((%_IsArray(i))){
var j=i.length;
for(var k=0;k<j;k++){
var l=Revive(i,%_NumberToString(k),h);
i[k]=l;
}
}else{
for(var m in i){
if(%_CallFunction(i,m,$objectHasOwnProperty)){
var l=Revive(i,m,h);
if((l===(void 0))){
delete i[m];
}else{
i[m]=l;
}
}
}
}
}
return %_CallFunction(e,g,i,h);
}
function JSONParse(n,h){
var o=%ParseJson(((typeof(%IS_VAR(n))==='string')?n:$nonStringToString(n)));
if((%_ClassOf(h)==='Function')){
return Revive({'':o},'',h);
}else{
return o;
}
}
function SerializeArray(p,q,r,t,u){
if(!%PushIfAbsent(r,p)){
throw MakeTypeError('circular_structure',[]);
}
var v=t;
t+=u;
var w=new InternalArray();
var x=p.length;
for(var k=0;k<x;k++){
var y=JSONSerialize(%_NumberToString(k),p,q,r,
t,u);
if((y===(void 0))){
y="null";
}
w.push(y);
}
var z;
if(u==""){
z="["+w.join(",")+"]";
}else if(w.length>0){
var A=",\n"+t;
z="[\n"+t+w.join(A)+"\n"+
v+"]";
}else{
z="[]";
}
r.pop();
return z;
}
function SerializeObject(p,q,r,t,u){
if(!%PushIfAbsent(r,p)){
throw MakeTypeError('circular_structure',[]);
}
var v=t;
t+=u;
var w=new InternalArray();
if((%_IsArray(q))){
var j=q.length;
for(var k=0;k<j;k++){
if(%_CallFunction(q,k,$objectHasOwnProperty)){
var m=q[k];
var y=JSONSerialize(m,p,q,r,t,u);
if(!(y===(void 0))){
var B=%QuoteJSONString(m)+":";
if(u!="")B+=" ";
B+=y;
w.push(B);
}
}
}
}else{
for(var m in p){
if(%_CallFunction(p,m,$objectHasOwnProperty)){
var y=JSONSerialize(m,p,q,r,t,u);
if(!(y===(void 0))){
var B=%QuoteJSONString(m)+":";
if(u!="")B+=" ";
B+=y;
w.push(B);
}
}
}
}
var z;
if(u==""){
z="{"+w.join(",")+"}";
}else if(w.length>0){
var A=",\n"+t;
z="{\n"+t+w.join(A)+"\n"+
v+"}";
}else{
z="{}";
}
r.pop();
return z;
}
function JSONSerialize(C,e,q,r,t,u){
var p=e[C];
if((%_IsSpecObject(p))){
var D=p.toJSON;
if((%_ClassOf(D)==='Function')){
p=%_CallFunction(p,C,D);
}
}
if((%_ClassOf(q)==='Function')){
p=%_CallFunction(e,C,p,q);
}
if((typeof(p)==='string')){
return %QuoteJSONString(p);
}else if((typeof(p)==='number')){
return((%_IsSmi(%IS_VAR(p))||p-p==0)?%_NumberToString(p):"null");
}else if((typeof(p)==='boolean')){
return p?"true":"false";
}else if((p===null)){
return"null";
}else if((%_IsSpecObject(p))&&!(typeof p=="function")){
if((%_IsArray(p))){
return SerializeArray(p,q,r,t,u);
}else if((%_ClassOf(p)==='Number')){
p=$toNumber(p);
return((%_IsSmi(%IS_VAR(p))||p-p==0)?%_NumberToString(p):"null");
}else if((%_ClassOf(p)==='String')){
return %QuoteJSONString($toString(p));
}else if((%_ClassOf(p)==='Boolean')){
return %_ValueOf(p)?"true":"false";
}else{
return SerializeObject(p,q,r,t,u);
}
}
return(void 0);
}
function JSONStringify(p,q,E){
if(%_ArgumentsLength()==1){
return %BasicJSONStringify(p);
}
if((%_IsObject(E))){
if((%_ClassOf(E)==='Number')){
E=$toNumber(E);
}else if((%_ClassOf(E)==='String')){
E=$toString(E);
}
}
var u;
if((typeof(E)==='number')){
E=$max(0,$min($toInteger(E),10));
u=%_SubString("          ",0,E);
}else if((typeof(E)==='string')){
if(E.length>10){
u=%_SubString(E,0,10);
}else{
u=E;
}
}else{
u="";
}
if((%_IsArray(q))){
var F=new InternalArray();
var G={__proto__:null};
var H={};
var j=q.length;
for(var k=0;k<j;k++){
var I=q[k];
if((%_ClassOf(I)==='String')){
I=$toString(I);
}else{
if((%_ClassOf(I)==='Number'))I=$toNumber(I);
if((typeof(I)==='number'))I=%_NumberToString(I);
}
if((typeof(I)==='string')&&G[I]!=H){
F.push(I);
G[I]=H;
}
}
q=F;
}
return JSONSerialize('',{'':p},q,new InternalArray(),"",u);
}
%AddNamedProperty(d,symbolToStringTag,"JSON",1|2);
$installFunctions(d,2,[
"parse",JSONParse,
"stringify",JSONStringify
]);
$jsonSerializeAdapter=function(C,J){
var e={};
e[C]=J;
return JSONSerialize(C,e,(void 0),new InternalArray(),"","");
}
})

8array-iteratorqA
var $iteratorCreateResultObject;
var $arrayValues;
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Array;
var e=a.Object;
var g=a.Uint8Array;

var h=a.Int8Array;

var i=a.Uint16Array;

var j=a.Int16Array;

var k=a.Uint32Array;

var l=a.Int32Array;

var m=a.Float32Array;

var n=a.Float64Array;

var o=a.Uint8ClampedArray;


var p=(%CreateGlobalPrivateOwnSymbol("ArrayIterator#object"));
var q=(%CreateGlobalPrivateOwnSymbol("ArrayIterator#next"));
var r=(%CreateGlobalPrivateOwnSymbol("ArrayIterator#kind"));
function ArrayIterator(){}
function CreateArrayIterator(t,u){
var v=$toObject(t);
var w=new ArrayIterator;
(w[p]=v);
(w[q]=0);
(w[r]=u);
return w;
}
function CreateIteratorResultObject(x,y){
return{value:x,done:y};
}
function ArrayIteratorIterator(){
return this;
}
function ArrayIteratorNext(){
var w=$toObject(this);
if(!(!(w[q]===(void 0)))){
throw MakeTypeError(23,
'Array Iterator.prototype.next',this);
}
var t=(w[p]);
if((t===(void 0))){
return CreateIteratorResultObject((void 0),true);
}
var z=(w[q]);
var A=(w[r]);
var B=(t.length>>>0);
if(z>=B){
(w[p]=(void 0));
return CreateIteratorResultObject((void 0),true);
}
(w[q]=z+1);
if(A==2){
return CreateIteratorResultObject(t[z],false);
}
if(A==3){
return CreateIteratorResultObject([z,t[z]],false);
}
return CreateIteratorResultObject(z,false);
}
function ArrayEntries(){
return CreateArrayIterator(this,3);
}
function ArrayValues(){
return CreateArrayIterator(this,2);
}
function ArrayKeys(){
return CreateArrayIterator(this,1);
}
%FunctionSetPrototype(ArrayIterator,new e());
%FunctionSetInstanceClassName(ArrayIterator,'Array Iterator');
$installFunctions(ArrayIterator.prototype,2,[
'next',ArrayIteratorNext
]);
$setFunctionName(ArrayIteratorIterator,symbolIterator);
%AddNamedProperty(ArrayIterator.prototype,symbolIterator,
ArrayIteratorIterator,2);
%AddNamedProperty(ArrayIterator.prototype,symbolToStringTag,
"Array Iterator",1|2);
$installFunctions(d.prototype,2,[
'entries',ArrayEntries,
'keys',ArrayKeys
]);
%AddNamedProperty(d.prototype,symbolIterator,ArrayValues,
2);
%AddNamedProperty(g.prototype,'entries',ArrayEntries,2);
%AddNamedProperty(g.prototype,'values',ArrayValues,2);
%AddNamedProperty(g.prototype,'keys',ArrayKeys,2);
%AddNamedProperty(g.prototype,symbolIterator,ArrayValues,
2);

%AddNamedProperty(h.prototype,'entries',ArrayEntries,2);
%AddNamedProperty(h.prototype,'values',ArrayValues,2);
%AddNamedProperty(h.prototype,'keys',ArrayKeys,2);
%AddNamedProperty(h.prototype,symbolIterator,ArrayValues,
2);

%AddNamedProperty(i.prototype,'entries',ArrayEntries,2);
%AddNamedProperty(i.prototype,'values',ArrayValues,2);
%AddNamedProperty(i.prototype,'keys',ArrayKeys,2);
%AddNamedProperty(i.prototype,symbolIterator,ArrayValues,
2);

%AddNamedProperty(j.prototype,'entries',ArrayEntries,2);
%AddNamedProperty(j.prototype,'values',ArrayValues,2);
%AddNamedProperty(j.prototype,'keys',ArrayKeys,2);
%AddNamedProperty(j.prototype,symbolIterator,ArrayValues,
2);

%AddNamedProperty(k.prototype,'entries',ArrayEntries,2);
%AddNamedProperty(k.prototype,'values',ArrayValues,2);
%AddNamedProperty(k.prototype,'keys',ArrayKeys,2);
%AddNamedProperty(k.prototype,symbolIterator,ArrayValues,
2);

%AddNamedProperty(l.prototype,'entries',ArrayEntries,2);
%AddNamedProperty(l.prototype,'values',ArrayValues,2);
%AddNamedProperty(l.prototype,'keys',ArrayKeys,2);
%AddNamedProperty(l.prototype,symbolIterator,ArrayValues,
2);

%AddNamedProperty(m.prototype,'entries',ArrayEntries,2);
%AddNamedProperty(m.prototype,'values',ArrayValues,2);
%AddNamedProperty(m.prototype,'keys',ArrayKeys,2);
%AddNamedProperty(m.prototype,symbolIterator,ArrayValues,
2);

%AddNamedProperty(n.prototype,'entries',ArrayEntries,2);
%AddNamedProperty(n.prototype,'values',ArrayValues,2);
%AddNamedProperty(n.prototype,'keys',ArrayKeys,2);
%AddNamedProperty(n.prototype,symbolIterator,ArrayValues,
2);

%AddNamedProperty(o.prototype,'entries',ArrayEntries,2);
%AddNamedProperty(o.prototype,'values',ArrayValues,2);
%AddNamedProperty(o.prototype,'keys',ArrayKeys,2);
%AddNamedProperty(o.prototype,symbolIterator,ArrayValues,
2);


$iteratorCreateResultObject=CreateIteratorResultObject;
$arrayValues=ArrayValues;
})

<string-iteratorE
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Object;
var e=a.String;
var g=
(%CreateGlobalPrivateOwnSymbol("StringIterator#iteratedString"));
var h=(%CreateGlobalPrivateOwnSymbol("StringIterator#next"));
function StringIterator(){}
function CreateStringIterator(i){
var j=((typeof(%IS_VAR(i))==='string')?i:$nonStringToString(i));
var k=new StringIterator;
(k[g]=j);
(k[h]=0);
return k;
}
function StringIteratorIterator(){
return this;
}
function StringIteratorNext(){
var k=$toObject(this);
if(!(!(k[h]===(void 0)))){
throw MakeTypeError(23,
'String Iterator.prototype.next');
}
var j=(k[g]);
if((j===(void 0))){
return $iteratorCreateResultObject((void 0),true);
}
var l=(k[h]);
var m=(j.length>>>0);
if(l>=m){
(k[g]=(void 0));
return $iteratorCreateResultObject((void 0),true);
}
var n=%_StringCharCodeAt(j,l);
var o=%_StringCharFromCode(n);
l++;
if(n>=0xD800&&n<=0xDBFF&&l<m){
var p=%_StringCharCodeAt(j,l);
if(p>=0xDC00&&p<=0xDFFF){
o+=%_StringCharFromCode(p);
l++;
}
}
(k[h]=l);
return $iteratorCreateResultObject(o,false);
}
function StringPrototypeIterator(){
return CreateStringIterator(this);
}
%FunctionSetPrototype(StringIterator,new d());
%FunctionSetInstanceClassName(StringIterator,'String Iterator');
$installFunctions(StringIterator.prototype,2,[
'next',StringIteratorNext
]);
$setFunctionName(StringIteratorIterator,symbolIterator);
%AddNamedProperty(StringIterator.prototype,symbolIterator,
StringIteratorIterator,2);
%AddNamedProperty(StringIterator.prototype,symbolToStringTag,
"String Iterator",1|2);
$setFunctionName(StringPrototypeIterator,symbolIterator);
%AddNamedProperty(e.prototype,symbolIterator,
StringPrototypeIterator,2);
})

$templates¡
var $getTemplateCallSite;
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=new a.Map;
var e=a.Map.prototype.get;
var g=a.Map.prototype.set;
function SameCallSiteElements(h,i){
var j=h.length;
var i=i.raw;
if(j!==i.length)return false;
for(var k=0;k<j;++k){
if(h[k]!==i[k])return false;
}
return true;
}
function GetCachedCallSite(l,m){
var n=%_CallFunction(d,m,e);
if((n===(void 0)))return;
var j=n.length;
for(var k=0;k<j;++k){
if(SameCallSiteElements(l,n[k]))return n[k];
}
}
function SetCachedCallSite(l,m){
var n=%_CallFunction(d,m,e);
var o;
if((n===(void 0))){
o=new InternalArray(1);
o[0]=l;
%_CallFunction(d,m,o,g);
}else{
n.push(l);
}
return l;
}
$getTemplateCallSite=function(l,h,m){
var p=GetCachedCallSite(h,m);
if(!(p===(void 0)))return p;
%AddNamedProperty(l,"raw",%ObjectFreeze(h),
1|2|4);
return SetCachedCallSite(%ObjectFreeze(l),m);
}
})

i18n®È
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Boolean;
var e=a.Date;
var g=a.Number;
var h=a.RegExp;
var i=a.String;
var j=a.undefined;
var k={};
%AddNamedProperty(a,"Intl",k,2);
var l=['collator',
'numberformat',
'dateformat',
'breakiterator'];
var m=['NFC',
'NFD',
'NFKC',
'NFKD'];
var n={
'collator':j,
'numberformat':j,
'dateformat':j,
'breakiterator':j
};
var o=j;
var p=j;
function GetUnicodeExtensionRE(){
if(p===j){
p=new h('-u(-[a-z0-9]{2,8})+','g');
}
return p;
}
var q=j;
function GetAnyExtensionRE(){
if(q===j){
q=new h('-[a-z0-9]{1}-.*','g');
}
return q;
}
var r=j;
function GetQuotedStringRE(){
if(r===j){
r=new h("'[^']+'",'g');
}
return r;
}
var t=j;
function GetServiceRE(){
if(t===j){
t=
new h('^(collator|numberformat|dateformat|breakiterator)$');
}
return t;
}
var u=j;
function GetLanguageTagRE(){
if(u===j){
BuildLanguageTagREs();
}
return u;
}
var v=j;
function GetLanguageVariantRE(){
if(v===j){
BuildLanguageTagREs();
}
return v;
}
var w=j;
function GetLanguageSingletonRE(){
if(w===j){
BuildLanguageTagREs();
}
return w;
}
var x=j;
function GetTimezoneNameCheckRE(){
if(x===j){
x=
new h('^([A-Za-z]+)/([A-Za-z]+)(?:_([A-Za-z]+))*$');
}
return x;
}
var y={
'gregorian':'gregory',
'japanese':'japanese',
'buddhist':'buddhist',
'roc':'roc',
'persian':'persian',
'islamic-civil':'islamicc',
'islamic':'islamic',
'hebrew':'hebrew',
'chinese':'chinese',
'indian':'indian',
'coptic':'coptic',
'ethiopic':'ethiopic',
'ethiopic-amete-alem':'ethioaa'
};
var z={
'kn':{'property':'numeric','type':'boolean'},
'kf':{'property':'caseFirst','type':'string',
'values':['false','lower','upper']}
};
var A={
'nu':{'property':j,'type':'string'}
};
var B={
'ca':{'property':j,'type':'string'},
'nu':{'property':j,'type':'string'}
};
var C=[
'big5han','dict','direct','ducet','gb2312','phonebk','phonetic',
'pinyin','reformed','searchjl','stroke','trad','unihan','zhuyin'
];
var D=
'Function object that\'s not a constructor was created with new';
function addBoundMethod(E,F,G,H){
function getter(){
if(!%IsInitializedIntlObject(this)){
throw MakeTypeError(31,F);
}
var I='__bound'+F+'__';
if(this[I]===j){
var J=this;
var K;
if(H===j||H===2){
K=function(L,M){
if(%_IsConstructCall()){
throw MakeTypeError(53);
}
return G(J,L,M);
}
}else if(H===1){
K=function(L){
if(%_IsConstructCall()){
throw MakeTypeError(53);
}
return G(J,L);
}
}else{
K=function(){
if(%_IsConstructCall()){
throw MakeTypeError(53);
}
if(%_ArgumentsLength()>0){
return G(J,%_Arguments(0));
}else{
return G(J);
}
}
}
$setFunctionName(K,I);
%FunctionRemovePrototype(K);
%SetNativeFlag(K);
this[I]=K;
}
return this[I];
}
$setFunctionName(getter,F);
%FunctionRemovePrototype(getter);
%SetNativeFlag(getter);
$objectDefineProperty(E.prototype,F,{
get:getter,
enumerable:false,
configurable:true
});
}
function supportedLocalesOf(N,O,P){
if((N.match(GetServiceRE())===null)){
throw MakeError(3,N);
}
if(P===j){
P={};
}else{
P=$toObject(P);
}
var Q=P.localeMatcher;
if(Q!==j){
Q=i(Q);
if(Q!=='lookup'&&Q!=='best fit'){
throw MakeRangeError(99,Q);
}
}else{
Q='best fit';
}
var R=initializeLocaleList(O);
if(n[N]===j){
n[N]=getAvailableLocalesOf(N);
}
if(Q==='best fit'){
return initializeLocaleList(bestFitSupportedLocalesOf(
R,n[N]));
}
return initializeLocaleList(lookupSupportedLocalesOf(
R,n[N]));
}
function lookupSupportedLocalesOf(R,S){
var T=[];
for(var U=0;U<R.length;++U){
var V=R[U].replace(GetUnicodeExtensionRE(),'');
do{
if(S[V]!==j){
T.push(R[U]);
break;
}
var W=V.lastIndexOf('-');
if(W===-1){
break;
}
V=V.substring(0,W);
}while(true);
}
return T;
}
function bestFitSupportedLocalesOf(R,S){
return lookupSupportedLocalesOf(R,S);
}
function getGetOption(P,X){
if(P===j)throw MakeError(1,X);
var Y=function getOption(Z,aa,ab,ac){
if(P[Z]!==j){
var ad=P[Z];
switch(aa){
case'boolean':
ad=d(ad);
break;
case'string':
ad=i(ad);
break;
case'number':
ad=g(ad);
break;
default:
throw MakeError(4);
}
if(ab!==j&&ab.indexOf(ad)===-1){
throw MakeRangeError(109,ad,X,Z);
}
return ad;
}
return ac;
}
return Y;
}
function resolveLocale(N,R,P){
R=initializeLocaleList(R);
var Y=getGetOption(P,N);
var Q=Y('localeMatcher','string',
['lookup','best fit'],'best fit');
var ae;
if(Q==='lookup'){
ae=lookupMatcher(N,R);
}else{
ae=bestFitMatcher(N,R);
}
return ae;
}
function lookupMatcher(N,R){
if((N.match(GetServiceRE())===null)){
throw MakeError(3,N);
}
if(n[N]===j){
n[N]=getAvailableLocalesOf(N);
}
for(var U=0;U<R.length;++U){
var V=R[U].replace(GetAnyExtensionRE(),'');
do{
if(n[N][V]!==j){
var af=R[U].match(GetUnicodeExtensionRE());
var ag=(af===null)?'':af[0];
return{'locale':V,'extension':ag,'position':U};
}
var W=V.lastIndexOf('-');
if(W===-1){
break;
}
V=V.substring(0,W);
}while(true);
}
if(o===j){
o=%GetDefaultICULocale();
}
return{'locale':o,'extension':'','position':-1};
}
function bestFitMatcher(N,R){
return lookupMatcher(N,R);
}
function parseExtension(ag){
var ah=ag.split('-');
if(ah.length<=2||
(ah[0]!==''&&ah[1]!=='u')){
return{};
}
var ai={};
var aj=j;
for(var U=2;U<ah.length;++U){
var H=ah[U].length;
var ak=ah[U];
if(H===2){
ai[ak]=j;
aj=ak;
}else if(H>=3&&H<=8&&aj!==j){
ai[aj]=ak;
aj=j;
}else{
return{};
}
}
return ai;
}
function setOptions(al,ai,am,Y,an){
var ag='';
var ao=function updateExtension(ap,ad){
return'-'+ap+'-'+i(ad);
}
var aq=function updateProperty(Z,aa,ad){
if(aa==='boolean'&&(typeof ad==='string')){
ad=(ad==='true')?true:false;
}
if(Z!==j){
defineWEProperty(an,Z,ad);
}
}
for(var ap in am){
if(am.hasOwnProperty(ap)){
var ad=j;
var ar=am[ap];
if(ar.property!==j){
ad=Y(ar.property,ar.type,ar.values);
}
if(ad!==j){
aq(ar.property,ar.type,ad);
ag+=ao(ap,ad);
continue;
}
if(ai.hasOwnProperty(ap)){
ad=ai[ap];
if(ad!==j){
aq(ar.property,ar.type,ad);
ag+=ao(ap,ad);
}else if(ar.type==='boolean'){
aq(ar.property,ar.type,true);
ag+=ao(ap,true);
}
}
}
}
return ag===''?'':'-u'+ag;
}
function freezeArray(as){
as.forEach(function(ak,at){
$objectDefineProperty(as,at,{value:ak,
configurable:false,
writable:false,
enumerable:true});
});
$objectDefineProperty(as,'length',{value:as.length,
writable:false});
return as;
}
function getOptimalLanguageTag(au,ae){
if(au===ae){
return au;
}
var O=%GetLanguageTagVariants([au,ae]);
if(O[0].maximized!==O[1].maximized){
return ae;
}
var av=new h('^'+O[1].base);
return ae.replace(av,O[0].base);
}
function getAvailableLocalesOf(N){
var aw=%AvailableLocalesOf(N);
for(var U in aw){
if(aw.hasOwnProperty(U)){
var ax=U.match(/^([a-z]{2,3})-([A-Z][a-z]{3})-([A-Z]{2})$/);
if(ax!==null){
aw[ax[1]+'-'+ax[3]]=null;
}
}
}
return aw;
}
function defineWEProperty(ay,Z,ad){
$objectDefineProperty(ay,Z,
{value:ad,writable:true,enumerable:true});
}
function addWEPropertyIfDefined(ay,Z,ad){
if(ad!==j){
defineWEProperty(ay,Z,ad);
}
}
function defineWECProperty(ay,Z,ad){
$objectDefineProperty(ay,Z,{value:ad,
writable:true,
enumerable:true,
configurable:true});
}
function addWECPropertyIfDefined(ay,Z,ad){
if(ad!==j){
defineWECProperty(ay,Z,ad);
}
}
function toTitleCaseWord(az){
return az.substr(0,1).toUpperCase()+az.substr(1).toLowerCase();
}
function canonicalizeLanguageTag(aA){
if(typeof aA!=='string'&&typeof aA!=='object'||
(aA===null)){
throw MakeTypeError(30);
}
var aB=i(aA);
if(isValidLanguageTag(aB)===false){
throw MakeRangeError(93,aB);
}
var aC=%CanonicalizeLanguageTag(aB);
if(aC==='invalid-tag'){
throw MakeRangeError(93,aB);
}
return aC;
}
function initializeLocaleList(O){
var aD=[];
if(O===j){
aD=[];
}else{
if(typeof O==='string'){
aD.push(canonicalizeLanguageTag(O));
return freezeArray(aD);
}
var aE=$toObject(O);
var aF=aE.length>>>0;
for(var aG=0;aG<aF;aG++){
if(aG in aE){
var ad=aE[aG];
var aC=canonicalizeLanguageTag(ad);
if(aD.indexOf(aC)===-1){
aD.push(aC);
}
}
}
}
return freezeArray(aD);
}
function isValidLanguageTag(V){
if(GetLanguageTagRE().test(V)===false){
return false;
}
if(V.indexOf('x-')===0){
return true;
}
V=V.split(/-x-/)[0];
var aH=[];
var aI=[];
var ax=V.split(/-/);
for(var U=1;U<ax.length;U++){
var ad=ax[U];
if(GetLanguageVariantRE().test(ad)===true&&aI.length===0){
if(aH.indexOf(ad)===-1){
aH.push(ad);
}else{
return false;
}
}
if(GetLanguageSingletonRE().test(ad)===true){
if(aI.indexOf(ad)===-1){
aI.push(ad);
}else{
return false;
}
}
}
return true;
}
function BuildLanguageTagREs(){
var aJ='[a-zA-Z]';
var aK='[0-9]';
var aL='('+aJ+'|'+aK+')';
var aM='(art-lojban|cel-gaulish|no-bok|no-nyn|zh-guoyu|zh-hakka|'+
'zh-min|zh-min-nan|zh-xiang)';
var aN='(en-GB-oed|i-ami|i-bnn|i-default|i-enochian|i-hak|'+
'i-klingon|i-lux|i-mingo|i-navajo|i-pwn|i-tao|i-tay|'+
'i-tsu|sgn-BE-FR|sgn-BE-NL|sgn-CH-DE)';
var aO='('+aN+'|'+aM+')';
var aP='(x(-'+aL+'{1,8})+)';
var aQ='('+aK+'|[A-WY-Za-wy-z])';
w=new h('^'+aQ+'$','i');
var ag='('+aQ+'(-'+aL+'{2,8})+)';
var aR='('+aL+'{5,8}|('+aK+aL+'{3}))';
v=new h('^'+aR+'$','i');
var aS='('+aJ+'{2}|'+aK+'{3})';
var aT='('+aJ+'{4})';
var aU='('+aJ+'{3}(-'+aJ+'{3}){0,2})';
var aV='('+aJ+'{2,3}(-'+aU+')?|'+aJ+'{4}|'+
aJ+'{5,8})';
var aW=aV+'(-'+aT+')?(-'+aS+')?(-'+
aR+')*(-'+ag+')*(-'+aP+')?';
var aX=
'^('+aW+'|'+aP+'|'+aO+')$';
u=new h(aX,'i');
}
function initializeCollator(aY,O,P){
if(%IsInitializedIntlObject(aY)){
throw MakeTypeError(69,"Collator");
}
if(P===j){
P={};
}
var Y=getGetOption(P,'collator');
var aZ={};
defineWEProperty(aZ,'usage',Y(
'usage','string',['sort','search'],'sort'));
var ba=Y('sensitivity','string',
['base','accent','case','variant']);
if(ba===j&&aZ.usage==='sort'){
ba='variant';
}
defineWEProperty(aZ,'sensitivity',ba);
defineWEProperty(aZ,'ignorePunctuation',Y(
'ignorePunctuation','boolean',j,false));
var V=resolveLocale('collator',O,P);
var ai=parseExtension(V.extension);
setOptions(
P,ai,z,Y,aZ);
var bb='default';
var ag='';
if(ai.hasOwnProperty('co')&&aZ.usage==='sort'){
if(C.indexOf(ai.co)!==-1){
ag='-u-co-'+ai.co;
bb=ai.co;
}
}else if(aZ.usage==='search'){
ag='-u-co-search';
}
defineWEProperty(aZ,'collation',bb);
var bc=V.locale+ag;
var ae=$objectDefineProperties({},{
caseFirst:{writable:true},
collation:{value:aZ.collation,writable:true},
ignorePunctuation:{writable:true},
locale:{writable:true},
numeric:{writable:true},
requestedLocale:{value:bc,writable:true},
sensitivity:{writable:true},
strength:{writable:true},
usage:{value:aZ.usage,writable:true}
});
var bd=%CreateCollator(bc,
aZ,
ae);
%MarkAsInitializedIntlObjectOfType(aY,'collator',bd);
$objectDefineProperty(aY,'resolved',{value:ae});
return aY;
}
%AddNamedProperty(k,'Collator',function(){
var O=%_Arguments(0);
var P=%_Arguments(1);
if(!this||this===k){
return new k.Collator(O,P);
}
return initializeCollator($toObject(this),O,P);
},
2
);
%AddNamedProperty(k.Collator.prototype,'resolvedOptions',function(){
if(%_IsConstructCall()){
throw MakeTypeError(53);
}
if(!%IsInitializedIntlObjectOfType(this,'collator')){
throw MakeTypeError(70,"Collator");
}
var be=this;
var V=getOptimalLanguageTag(be.resolved.requestedLocale,
be.resolved.locale);
return{
locale:V,
usage:be.resolved.usage,
sensitivity:be.resolved.sensitivity,
ignorePunctuation:be.resolved.ignorePunctuation,
numeric:be.resolved.numeric,
caseFirst:be.resolved.caseFirst,
collation:be.resolved.collation
};
},
2
);
$setFunctionName(k.Collator.prototype.resolvedOptions,'resolvedOptions');
%FunctionRemovePrototype(k.Collator.prototype.resolvedOptions);
%SetNativeFlag(k.Collator.prototype.resolvedOptions);
%AddNamedProperty(k.Collator,'supportedLocalesOf',function(O){
if(%_IsConstructCall()){
throw MakeTypeError(53);
}
return supportedLocalesOf('collator',O,%_Arguments(1));
},
2
);
$setFunctionName(k.Collator.supportedLocalesOf,'supportedLocalesOf');
%FunctionRemovePrototype(k.Collator.supportedLocalesOf);
%SetNativeFlag(k.Collator.supportedLocalesOf);
function compare(aY,L,M){
return %InternalCompare(%GetImplFromInitializedIntlObject(aY),
i(L),i(M));
};
addBoundMethod(k.Collator,'compare',compare,2);
function isWellFormedCurrencyCode(bf){
return typeof bf=="string"&&
bf.length==3&&
bf.match(/[^A-Za-z]/)==null;
}
function getNumberOption(P,Z,bg,bh,bi){
var ad=P[Z];
if(ad!==j){
ad=g(ad);
if($isNaN(ad)||ad<bg||ad>bh){
throw MakeRangeError(102,Z);
}
return $floor(ad);
}
return bi;
}
function initializeNumberFormat(bj,O,P){
if(%IsInitializedIntlObject(bj)){
throw MakeTypeError(69,"NumberFormat");
}
if(P===j){
P={};
}
var Y=getGetOption(P,'numberformat');
var V=resolveLocale('numberformat',O,P);
var aZ={};
defineWEProperty(aZ,'style',Y(
'style','string',['decimal','percent','currency'],'decimal'));
var bf=Y('currency','string');
if(bf!==j&&!isWellFormedCurrencyCode(bf)){
throw MakeRangeError(89,bf);
}
if(aZ.style==='currency'&&bf===j){
throw MakeTypeError(15);
}
var bk=Y(
'currencyDisplay','string',['code','symbol','name'],'symbol');
if(aZ.style==='currency'){
defineWEProperty(aZ,'currency',bf.toUpperCase());
defineWEProperty(aZ,'currencyDisplay',bk);
}
var bl=getNumberOption(P,'minimumIntegerDigits',1,21,1);
defineWEProperty(aZ,'minimumIntegerDigits',bl);
var bm=getNumberOption(P,'minimumFractionDigits',0,20,0);
defineWEProperty(aZ,'minimumFractionDigits',bm);
var bn=getNumberOption(P,'maximumFractionDigits',bm,20,3);
defineWEProperty(aZ,'maximumFractionDigits',bn);
var bo=P['minimumSignificantDigits'];
var bp=P['maximumSignificantDigits'];
if(bo!==j||bp!==j){
bo=getNumberOption(P,'minimumSignificantDigits',1,21,0);
defineWEProperty(aZ,'minimumSignificantDigits',bo);
bp=getNumberOption(P,'maximumSignificantDigits',bo,21,21);
defineWEProperty(aZ,'maximumSignificantDigits',bp);
}
defineWEProperty(aZ,'useGrouping',Y(
'useGrouping','boolean',j,true));
var ai=parseExtension(V.extension);
var ag=setOptions(P,ai,A,
Y,aZ);
var bc=V.locale+ag;
var ae=$objectDefineProperties({},{
currency:{writable:true},
currencyDisplay:{writable:true},
locale:{writable:true},
maximumFractionDigits:{writable:true},
minimumFractionDigits:{writable:true},
minimumIntegerDigits:{writable:true},
numberingSystem:{writable:true},
requestedLocale:{value:bc,writable:true},
style:{value:aZ.style,writable:true},
useGrouping:{writable:true}
});
if(aZ.hasOwnProperty('minimumSignificantDigits')){
defineWEProperty(ae,'minimumSignificantDigits',j);
}
if(aZ.hasOwnProperty('maximumSignificantDigits')){
defineWEProperty(ae,'maximumSignificantDigits',j);
}
var bq=%CreateNumberFormat(bc,
aZ,
ae);
if(aZ.style==='currency'){
$objectDefineProperty(ae,'currencyDisplay',{value:bk,
writable:true});
}
%MarkAsInitializedIntlObjectOfType(bj,'numberformat',bq);
$objectDefineProperty(bj,'resolved',{value:ae});
return bj;
}
%AddNamedProperty(k,'NumberFormat',function(){
var O=%_Arguments(0);
var P=%_Arguments(1);
if(!this||this===k){
return new k.NumberFormat(O,P);
}
return initializeNumberFormat($toObject(this),O,P);
},
2
);
%AddNamedProperty(k.NumberFormat.prototype,'resolvedOptions',function(){
if(%_IsConstructCall()){
throw MakeTypeError(53);
}
if(!%IsInitializedIntlObjectOfType(this,'numberformat')){
throw MakeTypeError(70,"NumberFormat");
}
var br=this;
var V=getOptimalLanguageTag(br.resolved.requestedLocale,
br.resolved.locale);
var bs={
locale:V,
numberingSystem:br.resolved.numberingSystem,
style:br.resolved.style,
useGrouping:br.resolved.useGrouping,
minimumIntegerDigits:br.resolved.minimumIntegerDigits,
minimumFractionDigits:br.resolved.minimumFractionDigits,
maximumFractionDigits:br.resolved.maximumFractionDigits,
};
if(bs.style==='currency'){
defineWECProperty(bs,'currency',br.resolved.currency);
defineWECProperty(bs,'currencyDisplay',
br.resolved.currencyDisplay);
}
if(br.resolved.hasOwnProperty('minimumSignificantDigits')){
defineWECProperty(bs,'minimumSignificantDigits',
br.resolved.minimumSignificantDigits);
}
if(br.resolved.hasOwnProperty('maximumSignificantDigits')){
defineWECProperty(bs,'maximumSignificantDigits',
br.resolved.maximumSignificantDigits);
}
return bs;
},
2
);
$setFunctionName(k.NumberFormat.prototype.resolvedOptions,
'resolvedOptions');
%FunctionRemovePrototype(k.NumberFormat.prototype.resolvedOptions);
%SetNativeFlag(k.NumberFormat.prototype.resolvedOptions);
%AddNamedProperty(k.NumberFormat,'supportedLocalesOf',function(O){
if(%_IsConstructCall()){
throw MakeTypeError(53);
}
return supportedLocalesOf('numberformat',O,%_Arguments(1));
},
2
);
$setFunctionName(k.NumberFormat.supportedLocalesOf,'supportedLocalesOf');
%FunctionRemovePrototype(k.NumberFormat.supportedLocalesOf);
%SetNativeFlag(k.NumberFormat.supportedLocalesOf);
function formatNumber(bq,ad){
var bt=$toNumber(ad)+0;
return %InternalNumberFormat(%GetImplFromInitializedIntlObject(bq),
bt);
}
function parseNumber(bq,ad){
return %InternalNumberParse(%GetImplFromInitializedIntlObject(bq),
i(ad));
}
addBoundMethod(k.NumberFormat,'format',formatNumber,1);
addBoundMethod(k.NumberFormat,'v8Parse',parseNumber,1);
function toLDMLString(P){
var Y=getGetOption(P,'dateformat');
var bu='';
var bv=Y('weekday','string',['narrow','short','long']);
bu+=appendToLDMLString(
bv,{narrow:'EEEEE',short:'EEE',long:'EEEE'});
bv=Y('era','string',['narrow','short','long']);
bu+=appendToLDMLString(
bv,{narrow:'GGGGG',short:'GGG',long:'GGGG'});
bv=Y('year','string',['2-digit','numeric']);
bu+=appendToLDMLString(bv,{'2-digit':'yy','numeric':'y'});
bv=Y('month','string',
['2-digit','numeric','narrow','short','long']);
bu+=appendToLDMLString(bv,{'2-digit':'MM','numeric':'M',
'narrow':'MMMMM','short':'MMM','long':'MMMM'});
bv=Y('day','string',['2-digit','numeric']);
bu+=appendToLDMLString(
bv,{'2-digit':'dd','numeric':'d'});
var bw=Y('hour12','boolean');
bv=Y('hour','string',['2-digit','numeric']);
if(bw===j){
bu+=appendToLDMLString(bv,{'2-digit':'jj','numeric':'j'});
}else if(bw===true){
bu+=appendToLDMLString(bv,{'2-digit':'hh','numeric':'h'});
}else{
bu+=appendToLDMLString(bv,{'2-digit':'HH','numeric':'H'});
}
bv=Y('minute','string',['2-digit','numeric']);
bu+=appendToLDMLString(bv,{'2-digit':'mm','numeric':'m'});
bv=Y('second','string',['2-digit','numeric']);
bu+=appendToLDMLString(bv,{'2-digit':'ss','numeric':'s'});
bv=Y('timeZoneName','string',['short','long']);
bu+=appendToLDMLString(bv,{short:'z',long:'zzzz'});
return bu;
}
function appendToLDMLString(bv,bx){
if(bv!==j){
return bx[bv];
}else{
return'';
}
}
function fromLDMLString(bu){
bu=bu.replace(GetQuotedStringRE(),'');
var P={};
var by=bu.match(/E{3,5}/g);
P=appendToDateTimeObject(
P,'weekday',by,{EEEEE:'narrow',EEE:'short',EEEE:'long'});
by=bu.match(/G{3,5}/g);
P=appendToDateTimeObject(
P,'era',by,{GGGGG:'narrow',GGG:'short',GGGG:'long'});
by=bu.match(/y{1,2}/g);
P=appendToDateTimeObject(
P,'year',by,{y:'numeric',yy:'2-digit'});
by=bu.match(/M{1,5}/g);
P=appendToDateTimeObject(P,'month',by,{MM:'2-digit',
M:'numeric',MMMMM:'narrow',MMM:'short',MMMM:'long'});
by=bu.match(/L{1,5}/g);
P=appendToDateTimeObject(P,'month',by,{LL:'2-digit',
L:'numeric',LLLLL:'narrow',LLL:'short',LLLL:'long'});
by=bu.match(/d{1,2}/g);
P=appendToDateTimeObject(
P,'day',by,{d:'numeric',dd:'2-digit'});
by=bu.match(/h{1,2}/g);
if(by!==null){
P['hour12']=true;
}
P=appendToDateTimeObject(
P,'hour',by,{h:'numeric',hh:'2-digit'});
by=bu.match(/H{1,2}/g);
if(by!==null){
P['hour12']=false;
}
P=appendToDateTimeObject(
P,'hour',by,{H:'numeric',HH:'2-digit'});
by=bu.match(/m{1,2}/g);
P=appendToDateTimeObject(
P,'minute',by,{m:'numeric',mm:'2-digit'});
by=bu.match(/s{1,2}/g);
P=appendToDateTimeObject(
P,'second',by,{s:'numeric',ss:'2-digit'});
by=bu.match(/z|zzzz/g);
P=appendToDateTimeObject(
P,'timeZoneName',by,{z:'short',zzzz:'long'});
return P;
}
function appendToDateTimeObject(P,bv,by,bx){
if((by===null)){
if(!P.hasOwnProperty(bv)){
defineWEProperty(P,bv,j);
}
return P;
}
var Z=by[0];
defineWEProperty(P,bv,bx[Z]);
return P;
}
function toDateTimeOptions(P,bz,bA){
if(P===j){
P={};
}else{
P=((%_IsSpecObject(%IS_VAR(P)))?P:$toObject(P));
}
var bB=true;
if((bz==='date'||bz==='any')&&
(P.weekday!==j||P.year!==j||
P.month!==j||P.day!==j)){
bB=false;
}
if((bz==='time'||bz==='any')&&
(P.hour!==j||P.minute!==j||
P.second!==j)){
bB=false;
}
if(bB&&(bA==='date'||bA==='all')){
$objectDefineProperty(P,'year',{value:'numeric',
writable:true,
enumerable:true,
configurable:true});
$objectDefineProperty(P,'month',{value:'numeric',
writable:true,
enumerable:true,
configurable:true});
$objectDefineProperty(P,'day',{value:'numeric',
writable:true,
enumerable:true,
configurable:true});
}
if(bB&&(bA==='time'||bA==='all')){
$objectDefineProperty(P,'hour',{value:'numeric',
writable:true,
enumerable:true,
configurable:true});
$objectDefineProperty(P,'minute',{value:'numeric',
writable:true,
enumerable:true,
configurable:true});
$objectDefineProperty(P,'second',{value:'numeric',
writable:true,
enumerable:true,
configurable:true});
}
return P;
}
function initializeDateTimeFormat(bC,O,P){
if(%IsInitializedIntlObject(bC)){
throw MakeTypeError(69,"DateTimeFormat");
}
if(P===j){
P={};
}
var V=resolveLocale('dateformat',O,P);
P=toDateTimeOptions(P,'any','date');
var Y=getGetOption(P,'dateformat');
var Q=Y('formatMatcher','string',
['basic','best fit'],'best fit');
var bu=toLDMLString(P);
var bD=canonicalizeTimeZoneID(P.timeZone);
var aZ={};
var ai=parseExtension(V.extension);
var ag=setOptions(P,ai,B,
Y,aZ);
var bc=V.locale+ag;
var ae=$objectDefineProperties({},{
calendar:{writable:true},
day:{writable:true},
era:{writable:true},
hour12:{writable:true},
hour:{writable:true},
locale:{writable:true},
minute:{writable:true},
month:{writable:true},
numberingSystem:{writable:true},
pattern:{writable:true},
requestedLocale:{value:bc,writable:true},
second:{writable:true},
timeZone:{writable:true},
timeZoneName:{writable:true},
tz:{value:bD,writable:true},
weekday:{writable:true},
year:{writable:true}
});
var bq=%CreateDateTimeFormat(
bc,{skeleton:bu,timeZone:bD},ae);
if(bD!==j&&bD!==ae.timeZone){
throw MakeRangeError(108,bD);
}
%MarkAsInitializedIntlObjectOfType(bC,'dateformat',bq);
$objectDefineProperty(bC,'resolved',{value:ae});
return bC;
}
%AddNamedProperty(k,'DateTimeFormat',function(){
var O=%_Arguments(0);
var P=%_Arguments(1);
if(!this||this===k){
return new k.DateTimeFormat(O,P);
}
return initializeDateTimeFormat($toObject(this),O,P);
},
2
);
%AddNamedProperty(k.DateTimeFormat.prototype,'resolvedOptions',function(){
if(%_IsConstructCall()){
throw MakeTypeError(53);
}
if(!%IsInitializedIntlObjectOfType(this,'dateformat')){
throw MakeTypeError(70,"DateTimeFormat");
}
var br=this;
var bE=fromLDMLString(br.resolved.pattern);
var bF=y[br.resolved.calendar];
if(bF===j){
bF=br.resolved.calendar;
}
var V=getOptimalLanguageTag(br.resolved.requestedLocale,
br.resolved.locale);
var bs={
locale:V,
numberingSystem:br.resolved.numberingSystem,
calendar:bF,
timeZone:br.resolved.timeZone
};
addWECPropertyIfDefined(bs,'timeZoneName',bE.timeZoneName);
addWECPropertyIfDefined(bs,'era',bE.era);
addWECPropertyIfDefined(bs,'year',bE.year);
addWECPropertyIfDefined(bs,'month',bE.month);
addWECPropertyIfDefined(bs,'day',bE.day);
addWECPropertyIfDefined(bs,'weekday',bE.weekday);
addWECPropertyIfDefined(bs,'hour12',bE.hour12);
addWECPropertyIfDefined(bs,'hour',bE.hour);
addWECPropertyIfDefined(bs,'minute',bE.minute);
addWECPropertyIfDefined(bs,'second',bE.second);
return bs;
},
2
);
$setFunctionName(k.DateTimeFormat.prototype.resolvedOptions,
'resolvedOptions');
%FunctionRemovePrototype(k.DateTimeFormat.prototype.resolvedOptions);
%SetNativeFlag(k.DateTimeFormat.prototype.resolvedOptions);
%AddNamedProperty(k.DateTimeFormat,'supportedLocalesOf',function(O){
if(%_IsConstructCall()){
throw MakeTypeError(53);
}
return supportedLocalesOf('dateformat',O,%_Arguments(1));
},
2
);
$setFunctionName(k.DateTimeFormat.supportedLocalesOf,'supportedLocalesOf');
%FunctionRemovePrototype(k.DateTimeFormat.supportedLocalesOf);
%SetNativeFlag(k.DateTimeFormat.supportedLocalesOf);
function formatDate(bq,bG){
var bH;
if(bG===j){
bH=e.now();
}else{
bH=$toNumber(bG);
}
if(!$isFinite(bH))throw MakeRangeError(83);
return %InternalDateFormat(%GetImplFromInitializedIntlObject(bq),
new e(bH));
}
function parseDate(bq,ad){
return %InternalDateParse(%GetImplFromInitializedIntlObject(bq),
i(ad));
}
addBoundMethod(k.DateTimeFormat,'format',formatDate,0);
addBoundMethod(k.DateTimeFormat,'v8Parse',parseDate,1);
function canonicalizeTimeZoneID(bI){
if(bI===j){
return bI;
}
var bJ=bI.toUpperCase();
if(bJ==='UTC'||bJ==='GMT'||
bJ==='ETC/UTC'||bJ==='ETC/GMT'){
return'UTC';
}
var by=GetTimezoneNameCheckRE().exec(bI);
if((by===null))throw MakeRangeError(84,bI);
var bs=toTitleCaseWord(by[1])+'/'+toTitleCaseWord(by[2]);
var U=3;
while(by[U]!==j&&U<by.length){
bs=bs+'_'+toTitleCaseWord(by[U]);
U++;
}
return bs;
}
function initializeBreakIterator(bK,O,P){
if(%IsInitializedIntlObject(bK)){
throw MakeTypeError(69,"v8BreakIterator");
}
if(P===j){
P={};
}
var Y=getGetOption(P,'breakiterator');
var aZ={};
defineWEProperty(aZ,'type',Y(
'type','string',['character','word','sentence','line'],'word'));
var V=resolveLocale('breakiterator',O,P);
var ae=$objectDefineProperties({},{
requestedLocale:{value:V.locale,writable:true},
type:{value:aZ.type,writable:true},
locale:{writable:true}
});
var bL=%CreateBreakIterator(V.locale,
aZ,
ae);
%MarkAsInitializedIntlObjectOfType(bK,'breakiterator',
bL);
$objectDefineProperty(bK,'resolved',{value:ae});
return bK;
}
%AddNamedProperty(k,'v8BreakIterator',function(){
var O=%_Arguments(0);
var P=%_Arguments(1);
if(!this||this===k){
return new k.v8BreakIterator(O,P);
}
return initializeBreakIterator($toObject(this),O,P);
},
2
);
%AddNamedProperty(k.v8BreakIterator.prototype,'resolvedOptions',
function(){
if(%_IsConstructCall()){
throw MakeTypeError(53);
}
if(!%IsInitializedIntlObjectOfType(this,'breakiterator')){
throw MakeTypeError(70,"v8BreakIterator");
}
var bM=this;
var V=getOptimalLanguageTag(bM.resolved.requestedLocale,
bM.resolved.locale);
return{
locale:V,
type:bM.resolved.type
};
},
2
);
$setFunctionName(k.v8BreakIterator.prototype.resolvedOptions,
'resolvedOptions');
%FunctionRemovePrototype(k.v8BreakIterator.prototype.resolvedOptions);
%SetNativeFlag(k.v8BreakIterator.prototype.resolvedOptions);
%AddNamedProperty(k.v8BreakIterator,'supportedLocalesOf',
function(O){
if(%_IsConstructCall()){
throw MakeTypeError(53);
}
return supportedLocalesOf('breakiterator',O,%_Arguments(1));
},
2
);
$setFunctionName(k.v8BreakIterator.supportedLocalesOf,'supportedLocalesOf');
%FunctionRemovePrototype(k.v8BreakIterator.supportedLocalesOf);
%SetNativeFlag(k.v8BreakIterator.supportedLocalesOf);
function adoptText(bK,bN){
%BreakIteratorAdoptText(%GetImplFromInitializedIntlObject(bK),
i(bN));
}
function first(bK){
return %BreakIteratorFirst(%GetImplFromInitializedIntlObject(bK));
}
function next(bK){
return %BreakIteratorNext(%GetImplFromInitializedIntlObject(bK));
}
function current(bK){
return %BreakIteratorCurrent(%GetImplFromInitializedIntlObject(bK));
}
function breakType(bK){
return %BreakIteratorBreakType(%GetImplFromInitializedIntlObject(bK));
}
addBoundMethod(k.v8BreakIterator,'adoptText',adoptText,1);
addBoundMethod(k.v8BreakIterator,'first',first,0);
addBoundMethod(k.v8BreakIterator,'next',next,0);
addBoundMethod(k.v8BreakIterator,'current',current,0);
addBoundMethod(k.v8BreakIterator,'breakType',breakType,0);
var bO={
'collator':k.Collator,
'numberformat':k.NumberFormat,
'dateformatall':k.DateTimeFormat,
'dateformatdate':k.DateTimeFormat,
'dateformattime':k.DateTimeFormat
};
var bP={
'collator':j,
'numberformat':j,
'dateformatall':j,
'dateformatdate':j,
'dateformattime':j,
};
function cachedOrNewService(N,O,P,bA){
var bQ=(bA===j)?P:bA;
if(O===j&&P===j){
if(bP[N]===j){
bP[N]=new bO[N](O,bQ);
}
return bP[N];
}
return new bO[N](O,bQ);
}
$overrideFunction(i.prototype,'localeCompare',function(J){
if(%_IsConstructCall()){
throw MakeTypeError(53);
}
if((this==null)){
throw MakeTypeError(32);
}
var O=%_Arguments(1);
var P=%_Arguments(2);
var aY=cachedOrNewService('collator',O,P);
return compare(aY,this,J);
}
);
$overrideFunction(i.prototype,'normalize',function(J){
if(%_IsConstructCall()){
throw MakeTypeError(53);
}
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"String.prototype.normalize");
var bR=i(%_Arguments(0)||'NFC');
var bS=m.indexOf(bR);
if(bS===-1){
throw MakeRangeError(100,m.join(', '));
}
return %StringNormalize(this,bS);
}
);
$overrideFunction(g.prototype,'toLocaleString',function(){
if(%_IsConstructCall()){
throw MakeTypeError(53);
}
if(!(this instanceof g)&&typeof(this)!=='number'){
throw MakeTypeError(33,"Number");
}
var O=%_Arguments(0);
var P=%_Arguments(1);
var bj=cachedOrNewService('numberformat',O,P);
return formatNumber(bj,this);
}
);
function toLocaleDateTime(bT,O,P,bz,bA,N){
if(!(bT instanceof e)){
throw MakeTypeError(33,"Date");
}
if($isNaN(bT)){
return'Invalid Date';
}
var aZ=toDateTimeOptions(P,bz,bA);
var bC=
cachedOrNewService(N,O,P,aZ);
return formatDate(bC,bT);
}
$overrideFunction(e.prototype,'toLocaleString',function(){
if(%_IsConstructCall()){
throw MakeTypeError(53);
}
var O=%_Arguments(0);
var P=%_Arguments(1);
return toLocaleDateTime(
this,O,P,'any','all','dateformatall');
}
);
$overrideFunction(e.prototype,'toLocaleDateString',function(){
if(%_IsConstructCall()){
throw MakeTypeError(53);
}
var O=%_Arguments(0);
var P=%_Arguments(1);
return toLocaleDateTime(
this,O,P,'date','date','dateformatdate');
}
);
$overrideFunction(e.prototype,'toLocaleTimeString',function(){
if(%_IsConstructCall()){
throw MakeTypeError(53);
}
var O=%_Arguments(0);
var P=%_Arguments(1);
return toLocaleDateTime(
this,O,P,'time','time','dateformattime');
}
);
})

 (proxy6
var $proxyDelegateCallAndConstruct;
var $proxyDerivedGetTrap;
var $proxyDerivedHasTrap;
var $proxyDerivedHasOwnTrap;
var $proxyDerivedKeysTrap;
var $proxyDerivedSetTrap;
var $proxyEnumerate;
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Function;
var e=a.Object;
function ProxyCreate(f,g){
if(!(%_IsSpecObject(f)))
throw MakeTypeError(58,"create")
if((g===(void 0)))
g=null
else if(!((%_IsSpecObject(g))||(g===null)))
throw MakeTypeError(63)
return %CreateJSProxy(f,g)
}
function ProxyCreateFunction(f,h,i){
if(!(%_IsSpecObject(f)))
throw MakeTypeError(58,"createFunction")
if(!(%_ClassOf(h)==='Function'))
throw MakeTypeError(66,"call")
if((i===(void 0))){
i=DerivedConstructTrap(h)
}else if((%_ClassOf(i)==='Function')){
var j=i
i=function(){
return %Apply(j,(void 0),arguments,0,%_ArgumentsLength());
}
}else{
throw MakeTypeError(66,"construct")
}
return %CreateJSFunctionProxy(
f,h,i,d.prototype)
}
function DerivedConstructTrap(h){
return function(){
var g=this.prototype
if(!(%_IsSpecObject(g)))g=e.prototype
var k={__proto__:g};
var l=%Apply(h,k,arguments,0,%_ArgumentsLength());
return(%_IsSpecObject(l))?l:k
}
}
function DelegateCallAndConstruct(h,i){
return function(){
return %Apply(%_IsConstructCall()?i:h,
this,arguments,0,%_ArgumentsLength())
}
}
function DerivedGetTrap(m,n){
var o=this.getPropertyDescriptor(n)
if((o===(void 0))){return o}
if('value'in o){
return o.value
}else{
if((o.get===(void 0))){return o.get}
return %_CallFunction(m,o.get)
}
}
function DerivedSetTrap(m,n,p){
var o=this.getOwnPropertyDescriptor(n)
if(o){
if('writable'in o){
if(o.writable){
o.value=p
this.defineProperty(n,o)
return true
}else{
return false
}
}else{
if(o.set){
%_CallFunction(m,p,o.set)
return true
}else{
return false
}
}
}
o=this.getPropertyDescriptor(n)
if(o){
if('writable'in o){
if(o.writable){
}else{
return false
}
}else{
if(o.set){
%_CallFunction(m,p,o.set)
return true
}else{
return false
}
}
}
this.defineProperty(n,{
value:p,
writable:true,
enumerable:true,
configurable:true});
return true;
}
function DerivedHasTrap(n){
return!!this.getPropertyDescriptor(n)
}
function DerivedHasOwnTrap(n){
return!!this.getOwnPropertyDescriptor(n)
}
function DerivedKeysTrap(){
var q=this.getOwnPropertyNames()
var r=[]
for(var s=0,count=0;s<q.length;++s){
var n=q[s]
if((typeof(n)==='symbol'))continue
var o=this.getOwnPropertyDescriptor(((typeof(%IS_VAR(n))==='string')?n:$nonStringToString(n)))
if(!(o===(void 0))&&o.enumerable){
r[count++]=q[s]
}
}
return r
}
function DerivedEnumerateTrap(){
var q=this.getPropertyNames()
var r=[]
for(var s=0,count=0;s<q.length;++s){
var n=q[s]
if((typeof(n)==='symbol'))continue
var o=this.getPropertyDescriptor(((typeof(%IS_VAR(n))==='string')?n:$nonStringToString(n)))
if(!(o===(void 0))){
if(!o.configurable){
throw MakeTypeError(64,
this,n,"getPropertyDescriptor")
}
if(o.enumerable)r[count++]=q[s]
}
}
return r
}
function ProxyEnumerate(t){
var f=%GetHandler(t)
if((f.enumerate===(void 0))){
return %Apply(DerivedEnumerateTrap,f,[],0,0)
}else{
return $toNameArray(f.enumerate(),"enumerate",false)
}
}
var u=new e();
%AddNamedProperty(a,"Proxy",u,2);
$installFunctions(u,2,[
"create",ProxyCreate,
"createFunction",ProxyCreateFunction
])
$proxyDelegateCallAndConstruct=DelegateCallAndConstruct;
$proxyDerivedGetTrap=DerivedGetTrap;
$proxyDerivedHasTrap=DerivedHasTrap;
$proxyDerivedHasOwnTrap=DerivedHasOwnTrap;
$proxyDerivedKeysTrap=DerivedKeysTrap;
$proxyDerivedSetTrap=DerivedSetTrap;
$proxyEnumerate=ProxyEnumerate;
})

$generator
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Function;
function GeneratorObjectNext(e){
if(!(%_ClassOf(this)==='Generator')){
throw MakeTypeError(23,
'[Generator].prototype.next',this);
}
var f=%GeneratorGetContinuation(this);
if(f>0){
if((%_DebugIsActive()!=0))%DebugPrepareStepInIfStepping(this);
try{
return %_GeneratorNext(this,e);
}catch(e){
%GeneratorClose(this);
throw e;
}
}else if(f==0){
return{value:void 0,done:true};
}else{
throw MakeTypeError(22);
}
}
function GeneratorObjectThrow(g){
if(!(%_ClassOf(this)==='Generator')){
throw MakeTypeError(23,
'[Generator].prototype.throw',this);
}
var f=%GeneratorGetContinuation(this);
if(f>0){
try{
return %_GeneratorThrow(this,g);
}catch(e){
%GeneratorClose(this);
throw e;
}
}else if(f==0){
throw g;
}else{
throw MakeTypeError(22);
}
}
function GeneratorObjectIterator(){
return this;
}
function GeneratorFunctionConstructor(h){
var i=$newFunctionString(arguments,'function*');
var j=%GlobalProxy(GeneratorFunctionConstructor);
var k=%_CallFunction(j,%CompileString(i,true));
%FunctionMarkNameShouldPrintAsAnonymous(k);
return k;
}
%NeverOptimizeFunction(GeneratorObjectNext);
%NeverOptimizeFunction(GeneratorObjectThrow);
var l=GeneratorFunctionPrototype.prototype;
$installFunctions(l,
2,
["next",GeneratorObjectNext,
"throw",GeneratorObjectThrow]);
$setFunctionName(GeneratorObjectIterator,symbolIterator);
%AddNamedProperty(l,symbolIterator,
GeneratorObjectIterator,2|4|1);
%AddNamedProperty(l,"constructor",
GeneratorFunctionPrototype,2|1);
%AddNamedProperty(l,
symbolToStringTag,"Generator",2|1);
%InternalSetPrototype(GeneratorFunctionPrototype,d.prototype);
%AddNamedProperty(GeneratorFunctionPrototype,
symbolToStringTag,"GeneratorFunction",2|1);
%AddNamedProperty(GeneratorFunctionPrototype,"constructor",
GeneratorFunction,2|1);
%InternalSetPrototype(GeneratorFunction,d);
%SetCode(GeneratorFunction,GeneratorFunctionConstructor);
})

4harmony-array•=
(function(a,b,c){
'use strict';
%CheckIsBootstrapping();
var d=a.Array;
var e=a.Symbol;
function ArrayCopyWithin(f,g,h){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.copyWithin");
var i=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var j=$toLength(i.length);
f=(%_IsSmi(%IS_VAR(f))?f:%NumberToInteger($toNumber(f)));
var k;
if(f<0){
k=$max(j+f,0);
}else{
k=$min(f,j);
}
g=(%_IsSmi(%IS_VAR(g))?g:%NumberToInteger($toNumber(g)));
var l;
if(g<0){
l=$max(j+g,0);
}else{
l=$min(g,j);
}
h=(h===(void 0))?j:(%_IsSmi(%IS_VAR(h))?h:%NumberToInteger($toNumber(h)));
var m;
if(h<0){
m=$max(j+h,0);
}else{
m=$min(h,j);
}
var n=$min(m-l,j-k);
var o=1;
if(l<k&&k<(l+n)){
o=-1;
l=l+n-1;
k=k+n-1;
}
while(n>0){
if(l in i){
i[k]=i[l];
}else{
delete i[k];
}
l=l+o;
k=k+o;
n--;
}
return i;
}
function ArrayFind(p){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.find");
var i=$toObject(this);
var j=$toInteger(i.length);
if(!(%_ClassOf(p)==='Function')){
throw MakeTypeError(9,p);
}
var q;
if(%_ArgumentsLength()>1){
q=%_Arguments(1);
}
var r=false;
if((q===null)){
if(%IsSloppyModeFunction(p))q=(void 0);
}else if(!(q===(void 0))){
r=(!(%_IsSpecObject(q))&&%IsSloppyModeFunction(p));
}
for(var s=0;s<j;s++){
if(s in i){
var t=i[s];
var u=r?$toObject(q):q;
if(%_CallFunction(u,t,s,i,p)){
return t;
}
}
}
return;
}
function ArrayFindIndex(p){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.findIndex");
var i=$toObject(this);
var j=$toInteger(i.length);
if(!(%_ClassOf(p)==='Function')){
throw MakeTypeError(9,p);
}
var q;
if(%_ArgumentsLength()>1){
q=%_Arguments(1);
}
var r=false;
if((q===null)){
if(%IsSloppyModeFunction(p))q=(void 0);
}else if(!(q===(void 0))){
r=(!(%_IsSpecObject(q))&&%IsSloppyModeFunction(p));
}
for(var s=0;s<j;s++){
if(s in i){
var t=i[s];
var u=r?$toObject(q):q;
if(%_CallFunction(u,t,s,i,p)){
return s;
}
}
}
return-1;
}
function ArrayFill(v){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(11,"Array.prototype.fill");
var i=$toObject(this);
var j=(i.length>>>0);
var s=0;
var h=j;
if(%_ArgumentsLength()>1){
s=%_Arguments(1);
s=(s===(void 0))?0:(%_IsSmi(%IS_VAR(s))?s:%NumberToInteger($toNumber(s)));
if(%_ArgumentsLength()>2){
h=%_Arguments(2);
h=(h===(void 0))?j:(%_IsSmi(%IS_VAR(h))?h:%NumberToInteger($toNumber(h)));
}
}
if(s<0){
s+=j;
if(s<0)s=0;
}else{
if(s>j)s=j;
}
if(h<0){
h+=j;
if(h<0)h=0;
}else{
if(h>j)h=j;
}
if((h-s)>0&&$objectIsFrozen(i)){
throw MakeTypeError(6);
}
for(;s<h;s++)
i[s]=v;
return i;
}
function ArrayFrom(w,x,y){
var z=$toObject(w);
var A=!(x===(void 0));
if(A){
if(!(%_ClassOf(x)==='Function')){
throw MakeTypeError(9,x);
}else if(%IsSloppyModeFunction(x)){
if((y===null)){
y=(void 0);
}else if(!(y===(void 0))){
y=((%_IsSpecObject(%IS_VAR(y)))?y:$toObject(y));
}
}
}
var B=$getMethod(z,symbolIterator);
var C;
var D;
var E;
var F;
if(!(B===(void 0))){
D=%IsConstructor(this)?new this():[];
var G=$getIterator(z,B);
C=0;
while(true){
var H=G.next();
if(!(%_IsObject(H))){
throw MakeTypeError(28,H);
}
if(H.done){
D.length=C;
return D;
}
F=H.value;
if(A){
E=%_CallFunction(y,F,C,x);
}else{
E=F;
}
%AddElement(D,C++,E,0);
}
}else{
var I=$toLength(z.length);
D=%IsConstructor(this)?new this(I):new d(I);
for(C=0;C<I;++C){
F=z[C];
if(A){
E=%_CallFunction(y,F,C,x);
}else{
E=F;
}
%AddElement(D,C,E,0);
}
D.length=C;
return D;
}
}
function ArrayOf(){
var j=%_ArgumentsLength();
var J=this;
var i=%IsConstructor(J)?new J(j):[];
for(var s=0;s<j;s++){
%AddElement(i,s,%_Arguments(s),0);
}
i.length=j;
return i;
}
$installConstants(e,[
"isConcatSpreadable",symbolIsConcatSpreadable
]);
%FunctionSetLength(ArrayCopyWithin,2);
%FunctionSetLength(ArrayFrom,1);
$installFunctions(d,2,[
"from",ArrayFrom,
"of",ArrayOf
]);
$installFunctions(d.prototype,2,[
"copyWithin",ArrayCopyWithin,
"find",ArrayFind,
"findIndex",ArrayFindIndex,
"fill",ArrayFill
]);
})

Xharmony-array-includesõ
(function(a,b,c){
'use strict';
%CheckIsBootstrapping();
var d=a.Array;
function ArrayIncludes(e,f){
var g=$toObject(this);
var h=$toLength(g.length);
if(h===0){
return false;
}
var i=$toInteger(f);
var j;
if(i>=0){
j=i;
}else{
j=h+i;
if(j<0){
j=0;
}
}
while(j<h){
var k=g[j];
if($sameValueZero(e,k)){
return true;
}
++j;
}
return false;
}
%FunctionSetLength(ArrayIncludes,1);
$installFunctions(d.prototype,2,[
"includes",ArrayIncludes
]);
})

@harmony-tostring!
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Symbol;
$installConstants(d,[
"toStringTag",symbolToStringTag
]);
})

Hharmony-typedarrayu.
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Uint8Array;

var e=a.Int8Array;

var f=a.Uint16Array;

var g=a.Int16Array;

var h=a.Uint32Array;

var i=a.Int32Array;

var j=a.Float32Array;

var k=a.Float64Array;

var l=a.Uint8ClampedArray;


function TypedArrayEvery(m){
if(!%IsTypedArray(this)){
throw MakeTypeError('not_typed_array',[]);
}
if(!(%_ClassOf(m)==='Function'))throw MakeTypeError(9,m);
var n=%_TypedArrayGetLength(this);
var o;
if(%_ArgumentsLength()>1){
o=%_Arguments(1);
}
var p=false;
if((o===null)){
if(%IsSloppyModeFunction(mapfn))o=(void 0);
}else if(!(o===(void 0))){
p=(!(%_IsSpecObject(o))&&%IsSloppyModeFunction(m));
}
var q=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(m);
for(var r=0;r<n;r++){
var s=this[r];
if(q)%DebugPrepareStepInIfStepping(m);
var t=p?$toObject(o):o;
if(!%_CallFunction(t,((%_IsSpecObject(%IS_VAR(s)))?s:$toObject(s)),r,this,m)){
return false;
}
}
return true;
}
function TypedArrayForEach(m){
if(!%IsTypedArray(this))throw MakeTypeError(39);
if(!(%_ClassOf(m)==='Function'))throw MakeTypeError(9,m);
var n=%_TypedArrayGetLength(this);
var o;
if(%_ArgumentsLength()>1){
o=%_Arguments(1);
}
var p=false;
if((o===null)){
if(%IsSloppyModeFunction(mapfn))o=(void 0);
}else if(!(o===(void 0))){
p=(!(%_IsSpecObject(o))&&%IsSloppyModeFunction(m));
}
var q=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(m);
for(var r=0;r<n;r++){
var s=this[r];
if(q)%DebugPrepareStepInIfStepping(m);
var t=p?$toObject(o):o;
%_CallFunction(t,((%_IsSpecObject(%IS_VAR(s)))?s:$toObject(s)),r,this,m);
}
}
function TypedArrayOf(){
var n=%_ArgumentsLength();
var u=new this(n);
for(var r=0;r<n;r++){
u[r]=%_Arguments(r);
}
return u;
}
$installFunctions(d,2|4|1,[
"of",TypedArrayOf
]);
$installFunctions(d.prototype,2,[
"every",TypedArrayEvery,
"forEach",TypedArrayForEach
]);

$installFunctions(e,2|4|1,[
"of",TypedArrayOf
]);
$installFunctions(e.prototype,2,[
"every",TypedArrayEvery,
"forEach",TypedArrayForEach
]);

$installFunctions(f,2|4|1,[
"of",TypedArrayOf
]);
$installFunctions(f.prototype,2,[
"every",TypedArrayEvery,
"forEach",TypedArrayForEach
]);

$installFunctions(g,2|4|1,[
"of",TypedArrayOf
]);
$installFunctions(g.prototype,2,[
"every",TypedArrayEvery,
"forEach",TypedArrayForEach
]);

$installFunctions(h,2|4|1,[
"of",TypedArrayOf
]);
$installFunctions(h.prototype,2,[
"every",TypedArrayEvery,
"forEach",TypedArrayForEach
]);

$installFunctions(i,2|4|1,[
"of",TypedArrayOf
]);
$installFunctions(i.prototype,2,[
"every",TypedArrayEvery,
"forEach",TypedArrayForEach
]);

$installFunctions(j,2|4|1,[
"of",TypedArrayOf
]);
$installFunctions(j.prototype,2,[
"every",TypedArrayEvery,
"forEach",TypedArrayForEach
]);

$installFunctions(k,2|4|1,[
"of",TypedArrayOf
]);
$installFunctions(k.prototype,2,[
"every",TypedArrayEvery,
"forEach",TypedArrayForEach
]);

$installFunctions(l,2|4|1,[
"of",TypedArrayOf
]);
$installFunctions(l.prototype,2,[
"every",TypedArrayEvery,
"forEach",TypedArrayForEach
]);


})

8harmony-regexpÁ
(function(a,b,c){
'use strict';
%CheckIsBootstrapping();
var d=a.RegExp;
function RegExpGetFlags(){
if(!(%_IsSpecObject(this))){
throw MakeTypeError(20,$toString(this));
}
var e='';
if(this.global)e+='g';
if(this.ignoreCase)e+='i';
if(this.multiline)e+='m';
if(this.unicode)e+='u';
if(this.sticky)e+='y';
return e;
}
%DefineAccessorPropertyUnchecked(d.prototype,'flags',
RegExpGetFlags,null,2);
%SetNativeFlag(RegExpGetFlags);
})

<harmony-reflect
(function(a,b,c){
'use strict';
%CheckIsBootstrapping();
var d=a.Reflect;
$installFunctions(d,2,[
"apply",$reflectApply,
"construct",$reflectConstruct
]);
})

8harmony-spread…
var $spreadArguments;
var $spreadIterable;
(function(a,b,c){
'use strict';
function SpreadArguments(){
var d=%_ArgumentsLength();
var e=new InternalArray();
for(var f=0;f<d;++f){
var g=%_Arguments(f);
var h=g.length;
for(var i=0;i<h;++i){
e.push(g[i]);
}
}
return e;
}
function SpreadIterable(j){
if((j==null)){
throw MakeTypeError(38,j);
}
var e=new InternalArray();
for(var k of j){
e.push(k);
}
return e;
}
$spreadArguments=SpreadArguments;
$spreadIterable=SpreadIterable;
})

8harmony-object1
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=a.Object;
function ObjectAssign(e,f){
var g=((%_IsSpecObject(%IS_VAR(e)))?e:$toObject(e));
var h=%_ArgumentsLength();
if(h<2)return g;
for(var i=1;i<h;++i){
var j=%_Arguments(i);
if((j==null)){
continue;
}
var k=((%_IsSpecObject(%IS_VAR(j)))?j:$toObject(j));
var l=$ownPropertyKeys(k);
var m=l.length;
for(var n=0;n<m;++n){
var o=l[n];
if(%IsPropertyEnumerable(k,o)){
var p=k[o];
g[o]=p;
}
}
}
return g;
}
$installFunctions(d,2,[
"assign",ObjectAssign
]);
})

 dummy<(function(){})
